[
  {
    "path": "posts/2021-04-03-sunburst/",
    "title": "sunburst",
    "description": "description",
    "author": [
      {
        "name": "Shannon Pileggi",
        "url": {}
      }
    ],
    "date": "2021-04-03",
    "categories": [],
    "contents": "\r\n\r\nContents\r\nTL; DR\r\nBackground\r\nThe data\r\nLibraries\r\nData processing\r\nSunbursts\r\nFor fun\r\n\r\nTL; DR\r\nI manually defined geom_rect to create custom sunbursts with ggplot. Pair this with ggiraph package to create an awesome interactive graphic!\r\nBackground\r\nSunbursts in R first caught my eye from the sunburstR package with its awesome interactivity through d3. However, I had trouble customizing it and sought a ggplot alternative. You can create a version using geom_col, as shown in this RStudio Community Post; I chose to go the more complex geom_rect route for more customization options. It was pretty exciting when I got it to work!\r\n\r\n\r\npretty pumped I got this custom “sunburst”-esque figure to work!! #ggplot #rstats pic.twitter.com/L88IQWoVCs\r\n\r\n— Shannon Pileggi (@PipingHotData) January 10, 2020\r\n\r\nThe data\r\nTo illustrate the concept on a publicly available data set, I am using the May 2021 #TidyTuesday salary data. Here, I’ll be looking at the top 5 industries and job titles.\r\nThe data attributes that work well for this set up include:\r\n4-6 categories, with associated weight or frequency of occurrence\r\nour categories are the top 5 industries\r\n\r\n4-6 sub-items within each category, with associated weight or frequency of occurrence\r\nour sub-items are the top 5 job titles within industry\r\noptional: a metric for the sub-items\r\nour metric is the median salary for the titles\r\nLibraries\r\n\r\n\r\nlibrary(tidyverse) # general use\r\nlibrary(ggiraph)   # interactive ggplots\r\nlibrary(glue)      # pasting strings\r\nlibrary(pals)      # color palette\r\n\r\n\r\n\r\nData processing\r\nImport\r\nFirst, import the data from GitHub.\r\n\r\n\r\n# import data\r\nsurvey_raw <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-05-18/survey.csv')\r\n\r\n\r\n\r\nSummarize\r\nNext, summarize the data in terms of the top 5 industries and top 5 job titles. For the job title, we’ll get (1) the percent of respondents with that title, and (2) the median salary for that title.\r\n\r\n\r\nsurvey_summary <- survey_raw %>% \r\n  # identify top industries\r\n  group_by(industry) %>% \r\n  mutate(\r\n    # number of respondents per industry\r\n    n_industry = n()\r\n  ) %>%\r\n  ungroup() %>% \r\n  arrange(desc(n_industry), industry) %>%\r\n  mutate(\r\n    # rank of industry in terms of number of survey respondents\r\n    # know a better way to do this bit? pls let me know!\r\n    n_industry_rank = as.numeric(factor(-n_industry)),\r\n    # very light cleaning of job title\r\n    job_title = tolower(job_title) %>% \r\n      str_remove_all(\"[:digit:]+\") %>% \r\n      str_trim() %>% \r\n      ifelse(. == \"rn\", \"registered nurse\", .)\r\n  ) %>% \r\n  # reduce to top 5 industries present\r\n  filter(n_industry_rank %in% 1:5) %>% \r\n  # identify top 5 job titles in each industry \r\n  group_by(n_industry_rank, n_industry, industry, job_title) %>%\r\n  summarize(\r\n    # number of titles within industry\r\n    n_title = n(),\r\n    # median salary per title\r\n    median_salary = median(annual_salary)\r\n  ) %>% \r\n  ungroup() %>% \r\n  arrange(n_industry_rank, industry, desc(n_title)) %>% \r\n  group_by(industry) %>% \r\n  # keep top 6 job titles within industry\r\n  slice(1:5) %>%\r\n  # recompute number of respondents per industry based on titles selected\r\n  mutate(n_industry = sum(n_title)) %>% \r\n  ungroup() %>% \r\n  mutate(\r\n    # relative scale of salary for plotting\r\n    median_salary_scaled = median_salary / max(median_salary) * 100,\r\n    # base n respondents\r\n    n_total = sum(n_title),\r\n    # percent of respondents per title\r\n    pct_title = n_title / n_total * 100,\r\n    pct_industry = n_industry / n_total * 100,\r\n    # unique job title, as some repeat across industry\r\n    title_unique = glue::glue(\"{str_sub(industry, 1, 3)}: {job_title}\")\r\n  ) %>% \r\n  arrange(desc(pct_industry, pct_title))\r\n\r\n\r\n\r\nHere is a preview of our data, which is the basis needed for the sunburst’s custom rectangles.\r\n\r\n\r\n# view input data\r\nDT::datatable(survey_summary)\r\n\r\n\r\n\r\n{\"x\":{\"filter\":\"none\",\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\"],[1,1,1,1,1,2,2,2,2,2,3,3,3,3,3,5,5,5,5,5,4,4,4,4,4],[809,809,809,809,809,317,317,317,317,317,216,216,216,216,216,177,177,177,177,177,122,122,122,122,122],[\"Computing or Tech\",\"Computing or Tech\",\"Computing or Tech\",\"Computing or Tech\",\"Computing or Tech\",\"Education (Higher Education)\",\"Education (Higher Education)\",\"Education (Higher Education)\",\"Education (Higher Education)\",\"Education (Higher Education)\",\"Nonprofits\",\"Nonprofits\",\"Nonprofits\",\"Nonprofits\",\"Nonprofits\",\"Health care\",\"Health care\",\"Health care\",\"Health care\",\"Health care\",\"Government and Public Administration\",\"Government and Public Administration\",\"Government and Public Administration\",\"Government and Public Administration\",\"Government and Public Administration\"],[\"software engineer\",\"senior software engineer\",\"software developer\",\"product manager\",\"engineering manager\",\"assistant professor\",\"librarian\",\"associate professor\",\"professor\",\"academic advisor\",\"executive director\",\"program manager\",\"director\",\"program coordinator\",\"program director\",\"registered nurse\",\"nurse practitioner\",\"executive assistant\",\"pharmacist\",\"project manager\",\"librarian\",\"analyst\",\"policy analyst\",\"director\",\"manager\"],[334,210,99,97,69,104,82,55,41,35,62,58,39,30,27,92,28,19,19,19,39,28,20,18,17],[125000,151500,95000,120000,173500,77250,64800,82000,95000,50000,82000,60000,100000,46425,71350,72900,106785,65000,106840,88000,59000,85650,89074,127500,120000],[72.0461095100865,87.3198847262248,54.7550432276657,69.164265129683,100,44.5244956772334,37.3487031700288,47.2622478386167,54.7550432276657,28.8184438040346,47.2622478386167,34.5821325648415,57.6368876080692,26.7579250720461,41.1239193083574,42.0172910662824,61.5475504322767,37.463976945245,61.5792507204611,50.7204610951009,34.0057636887608,49.3659942363112,51.3394812680115,73.4870317002882,69.164265129683],[1641,1641,1641,1641,1641,1641,1641,1641,1641,1641,1641,1641,1641,1641,1641,1641,1641,1641,1641,1641,1641,1641,1641,1641,1641],[20.3534430225472,12.7970749542962,6.03290676416819,5.91102985984156,4.20475319926874,6.33759902498477,4.99695307739183,3.35161486898233,2.49847653869592,2.13284582571603,3.77818403412553,3.53443022547227,2.37659963436929,1.82815356489945,1.64533820840951,5.60633759902498,1.70627666057282,1.15783059110299,1.15783059110299,1.15783059110299,2.37659963436929,1.70627666057282,1.2187690432663,1.09689213893967,1.03595368677636],[49.2992078001219,49.2992078001219,49.2992078001219,49.2992078001219,49.2992078001219,19.3174893357709,19.3174893357709,19.3174893357709,19.3174893357709,19.3174893357709,13.1627056672761,13.1627056672761,13.1627056672761,13.1627056672761,13.1627056672761,10.7861060329068,10.7861060329068,10.7861060329068,10.7861060329068,10.7861060329068,7.43449116392444,7.43449116392444,7.43449116392444,7.43449116392444,7.43449116392444],[\"Com: software engineer\",\"Com: senior software engineer\",\"Com: software developer\",\"Com: product manager\",\"Com: engineering manager\",\"Edu: assistant professor\",\"Edu: librarian\",\"Edu: associate professor\",\"Edu: professor\",\"Edu: academic advisor\",\"Non: executive director\",\"Non: program manager\",\"Non: director\",\"Non: program coordinator\",\"Non: program director\",\"Hea: registered nurse\",\"Hea: nurse practitioner\",\"Hea: executive assistant\",\"Hea: pharmacist\",\"Hea: project manager\",\"Gov: librarian\",\"Gov: analyst\",\"Gov: policy analyst\",\"Gov: director\",\"Gov: manager\"]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>n_industry_rank<\\/th>\\n      <th>n_industry<\\/th>\\n      <th>industry<\\/th>\\n      <th>job_title<\\/th>\\n      <th>n_title<\\/th>\\n      <th>median_salary<\\/th>\\n      <th>median_salary_scaled<\\/th>\\n      <th>n_total<\\/th>\\n      <th>pct_title<\\/th>\\n      <th>pct_industry<\\/th>\\n      <th>title_unique<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[1,2,5,6,7,8,9,10]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}\r\nAssign colors\r\nPick a color palette for industry, and name the color vector.\r\n\r\n\r\ncolors_industry <- pals::cubicyf(n = 5) %>% \r\n  set_names(unique(survey_summary[[\"industry\"]]))\r\n\r\n\r\n\r\n\r\n\r\ncolors_industry\r\n\r\n\r\n                   Computing or Tech \r\n                           \"#830CAB\" \r\n        Education (Higher Education) \r\n                           \"#6574FA\" \r\n                          Nonprofits \r\n                           \"#3BBCAC\" \r\n                         Health care \r\n                           \"#62E44A\" \r\nGovernment and Public Administration \r\n                           \"#CCEC5A\" \r\n\r\nCompute rectangles\r\nNext, I manually define the rectangles. I figured out the bits to create custom rectangles from various blog posts that I did not save. It could have been this post on variable width column charts. I got tips on how to angle text for labels from the R Graph Gallery’s circular barplots.\r\nThe idea of the rectangles’ color assignment is that darker shades represent more frequent items within a category. To create the colors, I concocted a solution to implement a degree of transparency off of the original industry colors based on the total number of sub-categories. Jake Riley shared with me an alternative solution for sub-category color assignment that he contributed on Stack Overflow.\r\n\r\n\r\nsurvey_burst <- survey_summary %>% \r\n  # join colors to data frame ----\r\n    left_join(enframe(colors_industry, name = \"industry\", value = \"color_industry\"), \r\n            by = \"industry\") %>%\r\n  # arrange descending industry but ascending title\r\n  # to compute title colors\r\n  arrange(desc(n_industry), industry, n_title, title_unique) %>% \r\n  group_by(industry) %>% \r\n  mutate(\r\n    # enumerate title in industry\r\n    id_title = row_number(),\r\n    # number of titles per industry\r\n    # this can vary - it does not have to be same number per category\r\n    num_title = max(id_title)\r\n  ) %>% \r\n  ungroup() %>% \r\n  mutate(\r\n    # degree of transparency based on number of attributes ----\r\n    color_trans = id_title / num_title ,\r\n    color_title = map2_chr(color_industry, color_trans, ~ adjustcolor(.x, .y))\r\n  ) %>% \r\n  # this arrange specifies the ordering of the figure\r\n  # clockwise ---\r\n  arrange(-pct_industry, industry, -pct_title, title_unique) %>%\r\n  # counter clockwise ---\r\n  # arrange(pct_industry, industry, pct_title, title_unique) %>% \r\n  mutate(\r\n    industry = fct_inorder(industry),\r\n    title_unique = fct_inorder(title_unique)\r\n  ) %>% \r\n  group_by(industry) %>% \r\n  mutate(cum_title_pct = cumsum(pct_title)) %>% \r\n  ungroup() %>% \r\n  mutate(\r\n    cum_industry_pct = cumsum(cum_title_pct),\r\n    cum_all = cumsum(pct_title)\r\n  ) %>% \r\n  mutate(\r\n    # compute coordinates of the rectangles ----\r\n    # the 0.3 is an adjustment on the 0 to 100 scale to add a small\r\n    # amount of white space between rectangles\r\n    rect_x_max = cumsum(pct_title) - 0.3,      # xmax ----\r\n    rect_x_min = rect_x_max - pct_title + 0.3, # xmin ----\r\n    rect_x_mid = (rect_x_min + rect_x_max)/2,  # xmid ----\r\n    # angles in case adding text to plot, omitting here ----\r\n    angle = 90 - 360 * rect_x_mid / 100,\r\n    hjust = ifelse(angle < -90, 1, 0),\r\n    angle = ifelse(angle < -90, angle + 180, angle),\r\n    # label\r\n    label_title = glue::glue('{scales::percent(pct_industry/100, accuracy = 1)} {industry}\\n {scales::percent(pct_title/100, accuracy = 1)} {job_title} \\n {scales::dollar(median_salary)} median salary'))\r\n\r\n\r\n\r\n\r\n\r\n# view sunburst data\r\nDT::datatable(survey_burst)\r\n\r\n\r\n\r\n{\"x\":{\"filter\":\"none\",\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\"],[1,1,1,1,1,2,2,2,2,2,3,3,3,3,3,5,5,5,5,5,4,4,4,4,4],[809,809,809,809,809,317,317,317,317,317,216,216,216,216,216,177,177,177,177,177,122,122,122,122,122],[\"Computing or Tech\",\"Computing or Tech\",\"Computing or Tech\",\"Computing or Tech\",\"Computing or Tech\",\"Education (Higher Education)\",\"Education (Higher Education)\",\"Education (Higher Education)\",\"Education (Higher Education)\",\"Education (Higher Education)\",\"Nonprofits\",\"Nonprofits\",\"Nonprofits\",\"Nonprofits\",\"Nonprofits\",\"Health care\",\"Health care\",\"Health care\",\"Health care\",\"Health care\",\"Government and Public Administration\",\"Government and Public Administration\",\"Government and Public Administration\",\"Government and Public Administration\",\"Government and Public Administration\"],[\"software engineer\",\"senior software engineer\",\"software developer\",\"product manager\",\"engineering manager\",\"assistant professor\",\"librarian\",\"associate professor\",\"professor\",\"academic advisor\",\"executive director\",\"program manager\",\"director\",\"program coordinator\",\"program director\",\"registered nurse\",\"nurse practitioner\",\"executive assistant\",\"pharmacist\",\"project manager\",\"librarian\",\"analyst\",\"policy analyst\",\"director\",\"manager\"],[334,210,99,97,69,104,82,55,41,35,62,58,39,30,27,92,28,19,19,19,39,28,20,18,17],[125000,151500,95000,120000,173500,77250,64800,82000,95000,50000,82000,60000,100000,46425,71350,72900,106785,65000,106840,88000,59000,85650,89074,127500,120000],[72.0461095100865,87.3198847262248,54.7550432276657,69.164265129683,100,44.5244956772334,37.3487031700288,47.2622478386167,54.7550432276657,28.8184438040346,47.2622478386167,34.5821325648415,57.6368876080692,26.7579250720461,41.1239193083574,42.0172910662824,61.5475504322767,37.463976945245,61.5792507204611,50.7204610951009,34.0057636887608,49.3659942363112,51.3394812680115,73.4870317002882,69.164265129683],[1641,1641,1641,1641,1641,1641,1641,1641,1641,1641,1641,1641,1641,1641,1641,1641,1641,1641,1641,1641,1641,1641,1641,1641,1641],[20.3534430225472,12.7970749542962,6.03290676416819,5.91102985984156,4.20475319926874,6.33759902498477,4.99695307739183,3.35161486898233,2.49847653869592,2.13284582571603,3.77818403412553,3.53443022547227,2.37659963436929,1.82815356489945,1.64533820840951,5.60633759902498,1.70627666057282,1.15783059110299,1.15783059110299,1.15783059110299,2.37659963436929,1.70627666057282,1.2187690432663,1.09689213893967,1.03595368677636],[49.2992078001219,49.2992078001219,49.2992078001219,49.2992078001219,49.2992078001219,19.3174893357709,19.3174893357709,19.3174893357709,19.3174893357709,19.3174893357709,13.1627056672761,13.1627056672761,13.1627056672761,13.1627056672761,13.1627056672761,10.7861060329068,10.7861060329068,10.7861060329068,10.7861060329068,10.7861060329068,7.43449116392444,7.43449116392444,7.43449116392444,7.43449116392444,7.43449116392444],[\"Com: software engineer\",\"Com: senior software engineer\",\"Com: software developer\",\"Com: product manager\",\"Com: engineering manager\",\"Edu: assistant professor\",\"Edu: librarian\",\"Edu: associate professor\",\"Edu: professor\",\"Edu: academic advisor\",\"Non: executive director\",\"Non: program manager\",\"Non: director\",\"Non: program coordinator\",\"Non: program director\",\"Hea: registered nurse\",\"Hea: nurse practitioner\",\"Hea: executive assistant\",\"Hea: pharmacist\",\"Hea: project manager\",\"Gov: librarian\",\"Gov: analyst\",\"Gov: policy analyst\",\"Gov: director\",\"Gov: manager\"],[\"#830CAB\",\"#830CAB\",\"#830CAB\",\"#830CAB\",\"#830CAB\",\"#6574FA\",\"#6574FA\",\"#6574FA\",\"#6574FA\",\"#6574FA\",\"#3BBCAC\",\"#3BBCAC\",\"#3BBCAC\",\"#3BBCAC\",\"#3BBCAC\",\"#62E44A\",\"#62E44A\",\"#62E44A\",\"#62E44A\",\"#62E44A\",\"#CCEC5A\",\"#CCEC5A\",\"#CCEC5A\",\"#CCEC5A\",\"#CCEC5A\"],[5,4,3,2,1,5,4,3,2,1,5,4,3,2,1,5,4,1,2,3,5,4,3,2,1],[5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],[1,0.8,0.6,0.4,0.2,1,0.8,0.6,0.4,0.2,1,0.8,0.6,0.4,0.2,1,0.8,0.2,0.4,0.6,1,0.8,0.6,0.4,0.2],[\"#830CABFF\",\"#830CABCC\",\"#830CAB99\",\"#830CAB66\",\"#830CAB33\",\"#6574FAFF\",\"#6574FACC\",\"#6574FA99\",\"#6574FA66\",\"#6574FA33\",\"#3BBCACFF\",\"#3BBCACCC\",\"#3BBCAC99\",\"#3BBCAC66\",\"#3BBCAC33\",\"#62E44AFF\",\"#62E44ACC\",\"#62E44A33\",\"#62E44A66\",\"#62E44A99\",\"#CCEC5AFF\",\"#CCEC5ACC\",\"#CCEC5A99\",\"#CCEC5A66\",\"#CCEC5A33\"],[20.3534430225472,33.1505179768434,39.1834247410116,45.0944546008531,49.2992078001219,6.33759902498477,11.3345521023766,14.6861669713589,17.1846435100548,19.3174893357709,3.77818403412553,7.31261425959781,9.68921389396709,11.5173674588665,13.1627056672761,5.60633759902498,7.31261425959781,8.47044485070079,9.62827544180378,10.7861060329068,2.37659963436929,4.08287629494211,5.30164533820841,6.39853747714808,7.43449116392444],[20.3534430225472,53.5039609993906,92.6873857404022,137.781840341255,187.081048141377,193.418647166362,204.753199268739,219.439366240098,236.624009750152,255.941499085923,259.719683120049,267.032297379647,276.721511273614,288.23887873248,301.401584399756,307.007921998781,314.320536258379,322.79098110908,332.419256550884,343.20536258379,345.58196221816,349.664838513102,354.96648385131,361.365021328458,368.799512492383],[20.3534430225472,33.1505179768434,39.1834247410116,45.0944546008531,49.2992078001219,55.6368068251066,60.6337599024985,63.9853747714808,66.4838513101767,68.6166971358927,72.3948811700183,75.9293113954906,78.3059110298598,80.1340645947593,81.7794028031688,87.3857404021938,89.0920170627666,90.2498476538696,91.4076782449726,92.5655088360756,94.9421084704449,96.6483851310177,97.867154174284,98.9640463132236,100],[20.0534430225472,32.8505179768434,38.8834247410116,44.7944546008531,48.9992078001219,55.3368068251066,60.3337599024985,63.6853747714808,66.1838513101767,68.3166971358928,72.0948811700183,75.6293113954906,78.0059110298598,79.8340645947593,81.4794028031688,87.0857404021938,88.7920170627666,89.9498476538696,91.1076782449726,92.2655088360756,94.6421084704449,96.3483851310177,97.567154174284,98.6640463132237,99.7],[-7.21644966006352e-16,20.3534430225472,33.1505179768434,39.1834247410116,45.0944546008531,49.2992078001219,55.6368068251066,60.6337599024985,63.9853747714808,66.4838513101767,68.6166971358927,72.3948811700183,75.9293113954906,78.3059110298598,80.1340645947593,81.7794028031688,87.3857404021938,89.0920170627666,90.2498476538696,91.4076782449726,92.5655088360756,94.9421084704449,96.6483851310177,97.867154174284,98.9640463132236],[10.0267215112736,26.6019804996953,36.0169713589275,41.9889396709324,47.0468312004875,52.3180073126143,57.9852833638026,62.1595673369896,65.0846130408288,67.4002742230347,70.3557891529555,74.0120962827544,76.9676112126752,79.0699878123096,80.8067336989641,84.4325716026813,88.0888787324802,89.5209323583181,90.6787629494211,91.8365935405241,93.6038086532602,95.6452468007313,97.1077696526508,98.2656002437538,99.3320231566118],[53.903802559415,-5.76712979890311,-39.6610968921389,-61.1601828153565,-79.368592321755,81.6551736745887,61.2529798903108,46.2255575868373,35.6953930530165,27.359012797075,16.7191590493602,3.5564533820841,-7.08340036563072,-14.6519561243144,-20.9042413162706,-33.9572577696526,-47.1199634369287,-52.2753564899452,-56.4435466179158,-60.6117367458866,-66.9737111517368,-74.3228884826325,-79.5879707495429,-83.7561608775138,-87.5952833638026],[0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[\"49% Computing or Tech\\n20% software engineer \\n$125,000 median salary\",\"49% Computing or Tech\\n13% senior software engineer \\n$151,500 median salary\",\"49% Computing or Tech\\n6% software developer \\n$95,000 median salary\",\"49% Computing or Tech\\n6% product manager \\n$120,000 median salary\",\"49% Computing or Tech\\n4% engineering manager \\n$173,500 median salary\",\"19% Education (Higher Education)\\n6% assistant professor \\n$77,250 median salary\",\"19% Education (Higher Education)\\n5% librarian \\n$64,800 median salary\",\"19% Education (Higher Education)\\n3% associate professor \\n$82,000 median salary\",\"19% Education (Higher Education)\\n2% professor \\n$95,000 median salary\",\"19% Education (Higher Education)\\n2% academic advisor \\n$50,000 median salary\",\"13% Nonprofits\\n4% executive director \\n$82,000 median salary\",\"13% Nonprofits\\n4% program manager \\n$60,000 median salary\",\"13% Nonprofits\\n2% director \\n$100,000 median salary\",\"13% Nonprofits\\n2% program coordinator \\n$46,425 median salary\",\"13% Nonprofits\\n2% program director \\n$71,350 median salary\",\"11% Health care\\n6% registered nurse \\n$72,900 median salary\",\"11% Health care\\n2% nurse practitioner \\n$106,785 median salary\",\"11% Health care\\n1% executive assistant \\n$65,000 median salary\",\"11% Health care\\n1% pharmacist \\n$106,840 median salary\",\"11% Health care\\n1% project manager \\n$88,000 median salary\",\"7% Government and Public Administration\\n2% librarian \\n$59,000 median salary\",\"7% Government and Public Administration\\n2% analyst \\n$85,650 median salary\",\"7% Government and Public Administration\\n1% policy analyst \\n$89,074 median salary\",\"7% Government and Public Administration\\n1% director \\n$127,500 median salary\",\"7% Government and Public Administration\\n1% manager \\n$120,000 median salary\"]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>n_industry_rank<\\/th>\\n      <th>n_industry<\\/th>\\n      <th>industry<\\/th>\\n      <th>job_title<\\/th>\\n      <th>n_title<\\/th>\\n      <th>median_salary<\\/th>\\n      <th>median_salary_scaled<\\/th>\\n      <th>n_total<\\/th>\\n      <th>pct_title<\\/th>\\n      <th>pct_industry<\\/th>\\n      <th>title_unique<\\/th>\\n      <th>color_industry<\\/th>\\n      <th>id_title<\\/th>\\n      <th>num_title<\\/th>\\n      <th>color_trans<\\/th>\\n      <th>color_title<\\/th>\\n      <th>cum_title_pct<\\/th>\\n      <th>cum_industry_pct<\\/th>\\n      <th>cum_all<\\/th>\\n      <th>rect_x_max<\\/th>\\n      <th>rect_x_min<\\/th>\\n      <th>rect_x_mid<\\/th>\\n      <th>angle<\\/th>\\n      <th>hjust<\\/th>\\n      <th>label_title<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[1,2,5,6,7,8,9,10,13,14,15,17,18,19,20,21,22,23,24]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}\r\nCombine colors\r\nCombine all industry and title colors in a single vector.\r\n\r\n\r\ncolors_title <- survey_burst[[\"color_title\"]] %>% \r\n  set_names(survey_burst[[\"title_unique\"]])\r\n\r\nall_colors <- c(colors_industry, colors_title)\r\n\r\n\r\n\r\nInner ring\r\nLastly in data prep, we create a smaller data set of rectangle coordinates just for the industries.\r\n\r\n\r\n# create an inner ring for industry ----\r\nlayer_industry <- survey_burst %>% \r\n  dplyr::select(industry, pct_industry, rect_x_max, rect_x_min) %>% \r\n  # first, get stopping point for each rectangle ----\r\n  arrange(industry, desc(rect_x_max)) %>% \r\n  group_by(industry) %>%\r\n  # keep one entry per industry ----\r\n  slice(1) %>% \r\n  ungroup() %>% \r\n  dplyr::select(industry, pct_industry, stop = rect_x_max) %>% \r\n  # second, get starting point for each rectangle ----\r\n  left_join(\r\n    survey_burst %>% \r\n      dplyr::select(industry, pct_industry, rect_x_max, rect_x_min) %>% \r\n      arrange(industry, rect_x_max) %>% \r\n      group_by(industry) %>% \r\n      slice(1) %>% \r\n      ungroup() %>% \r\n      dplyr::select(industry, pct_industry, start = rect_x_min),\r\n    by = c(\"industry\", \"pct_industry\")\r\n  ) %>% \r\n  # insert blank row for extra white space where circle starts/stops ---\r\n  bind_rows(\r\n    tibble(\r\n      attr_category = NA, \r\n      start = 99.7, \r\n      stop = 100.1)\r\n  ) %>% \r\n  mutate(\r\n    # compute midpoint for labeling if needed ----\r\n    mid = (stop - start)/2 + start,\r\n    # a label for industry pct ----\r\n    industry_label = ifelse(is.na(industry), NA, glue::glue('{industry}\\n{scales::percent(pct_industry/100, accuracy = 1)}'))\r\n  )\r\n\r\n\r\n\r\n\r\n\r\n# view industry rectangles\r\nDT::datatable(layer_industry)\r\n\r\n\r\n\r\n{\"x\":{\"filter\":\"none\",\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\"],[\"Computing or Tech\",\"Education (Higher Education)\",\"Nonprofits\",\"Health care\",\"Government and Public Administration\",null],[49.2992078001219,19.3174893357709,13.1627056672761,10.7861060329068,7.43449116392444,null],[48.9992078001219,68.3166971358928,81.4794028031688,92.2655088360756,99.7,100.1],[-7.21644966006352e-16,49.2992078001219,68.6166971358927,81.7794028031688,92.5655088360756,99.7],[null,null,null,null,null,null],[24.4996039000609,58.8079524680073,75.0480499695308,87.0224558196222,96.1327544180378,99.9],[\"Computing or Tech\\n49%\",\"Education (Higher Education)\\n19%\",\"Nonprofits\\n13%\",\"Health care\\n11%\",\"Government and Public Administration\\n7%\",null]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>industry<\\/th>\\n      <th>pct_industry<\\/th>\\n      <th>stop<\\/th>\\n      <th>start<\\/th>\\n      <th>attr_category<\\/th>\\n      <th>mid<\\/th>\\n      <th>industry_label<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[2,3,4,6]},{\"orderable\":false,\"targets\":0}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}\r\nSunbursts\r\nVariable length sunburst\r\nFinally, we can plot! This first figure has variable length bars, which are represented by the scaled median salary.\r\n\r\n\r\nsurvey_burst %>% \r\n  # title ring ----\r\nggplot(aes(\r\n  ymin = 1,\r\n  # variable length bars\r\n  ymax = median_salary_scaled, \r\n  xmin = rect_x_min, \r\n  xmax = rect_x_max,\r\n  fill = title_unique\r\n )) +\r\n  geom_rect(show.legend = FALSE) +\r\n  coord_polar() +\r\n  theme_minimal() +\r\n  theme(\r\n    axis.text.x = element_blank(), \r\n    axis.text.y = element_blank(),\r\n    panel.grid = element_blank(),\r\n    legend.position = \"none\",\r\n  ) +\r\n  # fiddle with what you like here for white space\r\n  ylim(-40, 100) +\r\n  scale_fill_manual(values = all_colors) +\r\n  # inner industry ring ----\r\n  geom_rect(\r\n    data = layer_industry,\r\n    aes(\r\n      ymin = -20,\r\n      ymax = 0, \r\n      xmin = start, \r\n      xmax = stop,\r\n      fill = industry\r\n    )\r\n  ) \r\n\r\n\r\n\r\n  # could add reference line of some sort\r\n  # geom_hline(yintercept = 50, color = \"gray\", lty = 2)\r\n\r\n\r\n\r\nWell, it is an example! Not quite as aesthetically appealing as my original example shown in the tweet, but it will do to put code to the page.\r\nAlthough I think this figure can be eye-catching, it is challenging to make it informative with labeling and still maintain appeal.\r\nFixed length sunburst\r\nFor a simpler alternative, drop the job title metric of median salary and only show the frequency of industry and title in survey respondents by fixing the rectangle height. This figure can effectively communicate parts of a whole.\r\n\r\n\r\nsurvey_burst %>% \r\n  # title ring ----\r\nggplot(aes(\r\n  ymin = 1,\r\n  # fix rectangle height here\r\n  ymax = 20, \r\n  xmin = rect_x_min, \r\n  xmax = rect_x_max,\r\n  fill = title_unique\r\n )) +\r\n  geom_rect(show.legend = FALSE) +\r\n  coord_polar() +\r\n  theme_minimal() +\r\n  theme(\r\n    axis.text.x = element_blank(), \r\n    axis.text.y = element_blank(),\r\n    panel.grid = element_blank(),\r\n    legend.position = \"none\",\r\n  ) +\r\n  ylim(-40, 40) +\r\n  scale_fill_manual(values = all_colors) +\r\n  # industry ring ----\r\n  geom_rect(\r\n    data = layer_industry,\r\n    aes(\r\n      ymin = -20,\r\n      ymax = 0, \r\n      xmin = start, \r\n      xmax = stop,\r\n      fill = industry\r\n    )\r\n  ) \r\n\r\n\r\n\r\n\r\nInteractive sunburst\r\n\r\n\r\ngg_interactive <- survey_burst %>% \r\n  # title ring ----\r\nggplot(aes(\r\n  ymin = 1,\r\n  # fix rectangle height here\r\n  ymax = 20, \r\n  xmin = rect_x_min, \r\n  xmax = rect_x_max,\r\n  fill = title_unique\r\n )) +\r\n  ggiraph::geom_rect_interactive(aes( # add id for tooltip ---\r\n  tooltip = label_title), show.legend = FALSE) +\r\n  coord_polar() +\r\n  theme_minimal() +\r\n  theme(\r\n    axis.text.x = element_blank(), \r\n    axis.text.y = element_blank(),\r\n    panel.grid = element_blank(),\r\n    legend.position = \"none\",\r\n  ) +\r\n  ylim(-40, 40) +\r\n  scale_fill_manual(values = all_colors) +\r\n  # industry ring ----\r\n  geom_rect(\r\n    data = layer_industry,\r\n    aes(\r\n      ymin = -20,\r\n      ymax = 0, \r\n      xmin = start, \r\n      xmax = stop,\r\n      fill = industry\r\n    )\r\n  ) \r\n\r\n\r\n\r\n\r\n\r\ngirafe(ggobj = gg_interactive,\r\n       options = list(opts_tooltip(use_fill = TRUE)))\r\n\r\n\r\n\r\n{\"x\":{\"html\":\"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>\\n<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' id='svg_0166029c-8f0f-4187-92e1-8b6708a95546' viewBox='0 0 432.00 360.00'>\\n  <g>\\n    <defs>\\n      <clipPath id='svg_0166029c-8f0f-4187-92e1-8b6708a95546_cl_1'>\\n        <rect x='0.00' y='0.00' width='432.00' height='360.00'/>\\n      <\\/clipPath>\\n    <\\/defs>\\n    <rect x='0.00' y='0.00' width='432.00' height='360.00' id='svg_0166029c-8f0f-4187-92e1-8b6708a95546_el_1' clip-path='url(#svg_0166029c-8f0f-4187-92e1-8b6708a95546_cl_1)' fill='#FFFFFF' fill-opacity='1' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.75' stroke-linejoin='round' stroke-linecap='round'/>\\n    <defs>\\n      <clipPath id='svg_0166029c-8f0f-4187-92e1-8b6708a95546_cl_2'>\\n        <rect x='0.00' y='0.00' width='432.00' height='360.00'/>\\n      <\\/clipPath>\\n    <\\/defs>\\n    <defs>\\n      <clipPath id='svg_0166029c-8f0f-4187-92e1-8b6708a95546_cl_3'>\\n        <rect x='36.00' y='0.00' width='360.00' height='360.00'/>\\n      <\\/clipPath>\\n    <\\/defs>\\n    <defs>\\n      <clipPath id='svg_0166029c-8f0f-4187-92e1-8b6708a95546_cl_4'>\\n        <rect x='0.00' y='0.00' width='432.00' height='360.00'/>\\n      <\\/clipPath>\\n    <\\/defs>\\n    <defs>\\n      <clipPath id='svg_0166029c-8f0f-4187-92e1-8b6708a95546_cl_5'>\\n        <rect x='44.22' y='5.48' width='346.30' height='346.30'/>\\n      <\\/clipPath>\\n    <\\/defs>\\n    <polygon points='217.37,74.74 222.21,74.85 227.04,75.19 231.85,75.75 236.63,76.54 241.37,77.55 246.05,78.78 250.67,80.22 255.22,81.88 259.69,83.75 264.07,85.83 268.34,88.10 272.51,90.58 276.55,93.24 280.46,96.09 284.24,99.12 287.87,102.33 291.35,105.69 294.67,109.22 297.82,112.90 300.80,116.72 303.59,120.68 306.20,124.76 308.61,128.96 310.83,133.26 312.84,137.67 314.65,142.16 316.24,146.73 311.77,148.18 307.30,149.62 302.82,151.06 298.35,152.51 293.88,153.95 289.41,155.39 284.93,156.83 283.34,152.41 281.46,148.10 279.30,143.92 276.87,139.90 274.17,136.05 271.23,132.38 268.05,128.92 264.65,125.67 261.04,122.66 257.23,119.89 253.26,117.38 249.12,115.14 244.85,113.17 240.46,111.50 235.96,110.12 231.39,109.04 226.75,108.26 222.07,107.79 217.37,107.64 217.37,102.94 217.37,98.24 217.37,93.54 217.37,88.84 217.37,84.14 217.37,79.44 217.37,74.74' id='svg_0166029c-8f0f-4187-92e1-8b6708a95546_el_2' clip-path='url(#svg_0166029c-8f0f-4187-92e1-8b6708a95546_cl_5)' fill='#830CAB' fill-opacity='1' stroke='none' title='49% Computing or Tech&amp;lt;br&amp;gt;20% software engineer &amp;lt;br&amp;gt;$125,000 median salary'/>\\n    <polygon points='316.83,148.60 318.11,153.22 319.17,157.89 320.02,162.61 320.65,167.36 321.06,172.14 321.25,176.93 321.21,181.72 320.96,186.51 320.49,191.28 319.79,196.02 318.88,200.73 317.76,205.39 316.41,209.99 314.86,214.52 313.10,218.98 311.14,223.36 308.98,227.63 304.83,225.42 300.69,223.20 296.54,220.98 292.40,218.77 288.26,216.55 284.11,214.33 279.97,212.12 282.19,207.57 284.09,202.88 285.65,198.06 286.86,193.15 287.72,188.16 288.22,183.12 288.36,178.06 288.14,173.01 287.56,167.98 286.62,163.00 285.33,158.11 289.83,156.75 294.33,155.39 298.83,154.03 303.33,152.68 307.83,151.32 312.33,149.96 316.83,148.60' id='svg_0166029c-8f0f-4187-92e1-8b6708a95546_el_3' clip-path='url(#svg_0166029c-8f0f-4187-92e1-8b6708a95546_cl_5)' fill='#830CAB' fill-opacity='0.8' stroke='none' title='49% Computing or Tech&amp;lt;br&amp;gt;13% senior software engineer &amp;lt;br&amp;gt;$151,500 median salary'/>\\n    <polygon points='308.04,229.35 305.31,233.94 302.35,238.39 299.17,242.68 295.77,246.79 292.17,250.73 288.36,254.48 284.37,258.03 281.34,254.44 278.31,250.84 275.28,247.25 272.25,243.66 269.22,240.07 266.18,236.48 263.15,232.89 266.94,229.45 270.46,225.76 273.71,221.82 276.67,217.65 279.33,213.29 283.43,215.58 287.53,217.88 291.63,220.17 295.73,222.47 299.83,224.76 303.94,227.06 308.04,229.35' id='svg_0166029c-8f0f-4187-92e1-8b6708a95546_el_4' clip-path='url(#svg_0166029c-8f0f-4187-92e1-8b6708a95546_cl_5)' fill='#830CAB' fill-opacity='0.6' stroke='none' title='49% Computing or Tech&amp;lt;br&amp;gt;6% software developer &amp;lt;br&amp;gt;$95,000 median salary'/>\\n    <polygon points='282.86,259.28 278.72,262.47 274.43,265.45 269.99,268.21 265.42,270.74 260.73,273.04 255.92,275.10 251.02,276.92 249.50,272.47 247.98,268.03 246.46,263.58 244.93,259.13 243.41,254.69 241.89,250.24 240.37,245.79 245.04,244.01 249.57,241.90 253.94,239.48 258.13,236.75 262.12,233.74 265.09,237.39 268.05,241.03 271.01,244.68 273.98,248.33 276.94,251.98 279.90,255.63 282.86,259.28' id='svg_0166029c-8f0f-4187-92e1-8b6708a95546_el_5' clip-path='url(#svg_0166029c-8f0f-4187-92e1-8b6708a95546_cl_5)' fill='#830CAB' fill-opacity='0.4' stroke='none' title='49% Computing or Tech&amp;lt;br&amp;gt;6% product manager &amp;lt;br&amp;gt;$120,000 median salary'/>\\n    <polygon points='249.17,277.53 244.28,278.97 239.33,280.17 234.33,281.13 229.29,281.83 224.22,282.29 223.91,277.61 223.60,272.92 223.29,268.23 222.98,263.54 222.67,258.85 222.36,254.16 222.05,249.47 227.81,248.85 233.51,247.76 239.10,246.22 240.54,250.69 241.97,255.16 243.41,259.64 244.85,264.11 246.29,268.59 247.73,273.06 249.17,277.53' id='svg_0166029c-8f0f-4187-92e1-8b6708a95546_el_6' clip-path='url(#svg_0166029c-8f0f-4187-92e1-8b6708a95546_cl_5)' fill='#830CAB' fill-opacity='0.2' stroke='none' title='49% Computing or Tech&amp;lt;br&amp;gt;4% engineering manager &amp;lt;br&amp;gt;$173,500 median salary'/>\\n    <polygon points='222.26,282.41 217.34,282.52 212.42,282.40 207.52,282.05 202.63,281.47 197.78,280.66 192.97,279.61 188.21,278.35 183.52,276.85 185.05,272.41 186.59,267.97 188.12,263.52 189.65,259.08 191.18,254.64 192.71,250.19 194.24,245.75 199.39,247.31 204.64,248.47 209.97,249.23 215.33,249.59 220.71,249.54 220.94,254.24 221.16,258.93 221.38,263.63 221.60,268.32 221.82,273.02 222.04,277.71 222.26,282.41' id='svg_0166029c-8f0f-4187-92e1-8b6708a95546_el_7' clip-path='url(#svg_0166029c-8f0f-4187-92e1-8b6708a95546_cl_5)' fill='#6574FA' fill-opacity='1' stroke='none' title='19% Education (Higher Education)&amp;lt;br&amp;gt;6% assistant professor &amp;lt;br&amp;gt;$77,250 median salary'/>\\n    <polygon points='181.68,276.20 176.93,274.33 172.28,272.23 167.74,269.90 163.31,267.35 159.02,264.59 154.87,261.62 157.70,257.86 160.52,254.11 163.35,250.35 166.18,246.60 169.01,242.85 171.83,239.09 174.66,235.34 178.95,238.33 183.45,241.00 188.14,243.32 192.98,245.30 191.37,249.72 189.75,254.13 188.14,258.54 186.52,262.96 184.91,267.37 183.29,271.78 181.68,276.20' id='svg_0166029c-8f0f-4187-92e1-8b6708a95546_el_8' clip-path='url(#svg_0166029c-8f0f-4187-92e1-8b6708a95546_cl_5)' fill='#6574FA' fill-opacity='0.8' stroke='none' title='19% Education (Higher Education)&amp;lt;br&amp;gt;5% librarian &amp;lt;br&amp;gt;$64,800 median salary'/>\\n    <polygon points='153.32,260.43 149.48,257.27 145.79,253.93 142.27,250.41 138.92,246.74 142.47,243.65 146.02,240.57 149.56,237.49 153.11,234.41 156.66,231.33 160.21,228.25 163.76,225.17 168.46,230.08 173.60,234.52 170.70,238.22 167.81,241.92 164.91,245.62 162.01,249.33 159.11,253.03 156.22,256.73 153.32,260.43' id='svg_0166029c-8f0f-4187-92e1-8b6708a95546_el_9' clip-path='url(#svg_0166029c-8f0f-4187-92e1-8b6708a95546_cl_5)' fill='#6574FA' fill-opacity='0.6' stroke='none' title='19% Education (Higher Education)&amp;lt;br&amp;gt;3% associate professor &amp;lt;br&amp;gt;$82,000 median salary'/>\\n    <polygon points='137.65,245.25 134.67,241.51 131.87,237.64 129.24,233.65 133.23,231.16 137.22,228.67 141.20,226.18 145.19,223.69 149.18,221.20 153.16,218.71 157.15,216.22 159.88,220.29 162.89,224.15 159.29,227.17 155.68,230.18 152.07,233.19 148.47,236.21 144.86,239.22 141.26,242.23 137.65,245.25' id='svg_0166029c-8f0f-4187-92e1-8b6708a95546_el_10' clip-path='url(#svg_0166029c-8f0f-4187-92e1-8b6708a95546_cl_5)' fill='#6574FA' fill-opacity='0.4' stroke='none' title='19% Education (Higher Education)&amp;lt;br&amp;gt;2% professor &amp;lt;br&amp;gt;$95,000 median salary'/>\\n    <polygon points='128.22,231.98 125.30,226.76 122.69,221.39 126.97,219.46 131.25,217.52 135.54,215.59 139.82,213.65 144.10,211.72 148.39,209.79 152.67,207.85 156.45,215.08 152.42,217.50 148.39,219.91 144.35,222.32 140.32,224.74 136.29,227.15 132.26,229.56 128.22,231.98' id='svg_0166029c-8f0f-4187-92e1-8b6708a95546_el_11' clip-path='url(#svg_0166029c-8f0f-4187-92e1-8b6708a95546_cl_5)' fill='#6574FA' fill-opacity='0.2' stroke='none' title='19% Education (Higher Education)&amp;lt;br&amp;gt;2% academic advisor &amp;lt;br&amp;gt;$50,000 median salary'/>\\n    <polygon points='121.90,219.60 119.81,214.33 118.00,208.96 116.50,203.49 115.29,197.95 119.91,197.08 124.53,196.20 129.15,195.33 133.76,194.45 138.38,193.58 143.00,192.71 147.62,191.83 148.76,196.87 150.27,201.81 152.13,206.63 147.81,208.48 143.49,210.33 139.18,212.19 134.86,214.04 130.54,215.89 126.22,217.75 121.90,219.60' id='svg_0166029c-8f0f-4187-92e1-8b6708a95546_el_12' clip-path='url(#svg_0166029c-8f0f-4187-92e1-8b6708a95546_cl_5)' fill='#3BBCAC' fill-opacity='1' stroke='none' title='13% Nonprofits&amp;lt;br&amp;gt;4% executive director &amp;lt;br&amp;gt;$82,000 median salary'/>\\n    <polygon points='114.95,196.03 114.20,190.81 113.71,185.56 113.49,180.29 113.54,175.02 118.24,175.18 122.94,175.34 127.63,175.51 132.33,175.67 137.03,175.83 141.72,176.00 146.42,176.16 146.42,180.96 146.74,185.76 147.38,190.52 142.75,191.30 138.11,192.09 133.48,192.88 128.85,193.66 124.21,194.45 119.58,195.24 114.95,196.03' id='svg_0166029c-8f0f-4187-92e1-8b6708a95546_el_13' clip-path='url(#svg_0166029c-8f0f-4187-92e1-8b6708a95546_cl_5)' fill='#3BBCAC' fill-opacity='0.8' stroke='none' title='13% Nonprofits&amp;lt;br&amp;gt;4% program manager &amp;lt;br&amp;gt;$60,000 median salary'/>\\n    <polygon points='113.63,173.06 114.21,166.32 115.23,159.62 119.85,160.48 124.47,161.34 129.09,162.20 133.71,163.06 138.34,163.92 142.96,164.78 147.58,165.64 146.48,174.83 141.79,174.57 137.09,174.32 132.40,174.07 127.71,173.82 123.01,173.57 118.32,173.31 113.63,173.06' id='svg_0166029c-8f0f-4187-92e1-8b6708a95546_el_14' clip-path='url(#svg_0166029c-8f0f-4187-92e1-8b6708a95546_cl_5)' fill='#3BBCAC' fill-opacity='0.6' stroke='none' title='13% Nonprofits&amp;lt;br&amp;gt;2% director &amp;lt;br&amp;gt;$100,000 median salary'/>\\n    <polygon points='115.61,157.71 116.73,152.85 118.08,148.06 122.57,149.44 127.06,150.82 131.56,152.20 136.05,153.59 140.54,154.97 145.03,156.35 149.52,157.74 147.83,164.33 143.23,163.38 138.63,162.44 134.02,161.49 129.42,160.54 124.82,159.60 120.21,158.65 115.61,157.71' id='svg_0166029c-8f0f-4187-92e1-8b6708a95546_el_15' clip-path='url(#svg_0166029c-8f0f-4187-92e1-8b6708a95546_cl_5)' fill='#3BBCAC' fill-opacity='0.4' stroke='none' title='13% Nonprofits&amp;lt;br&amp;gt;2% program coordinator &amp;lt;br&amp;gt;$46,425 median salary'/>\\n    <polygon points='118.67,146.19 121.76,137.98 126.09,139.82 130.41,141.66 134.74,143.50 139.06,145.34 143.39,147.18 147.71,149.02 152.04,150.85 149.93,156.46 145.46,155.00 141.00,153.53 136.53,152.06 132.07,150.59 127.60,149.13 123.14,147.66 118.67,146.19' id='svg_0166029c-8f0f-4187-92e1-8b6708a95546_el_16' clip-path='url(#svg_0166029c-8f0f-4187-92e1-8b6708a95546_cl_5)' fill='#3BBCAC' fill-opacity='0.2' stroke='none' title='13% Nonprofits&amp;lt;br&amp;gt;2% program director &amp;lt;br&amp;gt;$71,350 median salary'/>\\n    <polygon points='122.54,136.19 124.67,131.73 127.01,127.37 129.55,123.13 132.29,119.02 135.22,115.04 138.33,111.20 141.63,107.52 145.06,110.74 148.48,113.95 151.91,117.17 155.34,120.39 158.76,123.60 162.19,126.82 165.62,130.04 162.50,133.59 159.62,137.34 157.00,141.28 154.65,145.38 152.57,149.63 148.28,147.71 143.99,145.79 139.70,143.87 135.41,141.95 131.12,140.03 126.83,138.11 122.54,136.19' id='svg_0166029c-8f0f-4187-92e1-8b6708a95546_el_17' clip-path='url(#svg_0166029c-8f0f-4187-92e1-8b6708a95546_cl_5)' fill='#62E44A' fill-opacity='1' stroke='none' title='11% Health care&amp;lt;br&amp;gt;6% registered nurse &amp;lt;br&amp;gt;$72,900 median salary'/>\\n    <polygon points='142.98,106.10 149.67,99.83 152.73,103.39 155.79,106.96 158.86,110.52 161.92,114.09 164.98,117.65 168.04,121.22 171.11,124.78 166.54,129.07 163.17,125.79 159.81,122.51 156.44,119.23 153.08,115.95 149.71,112.67 146.35,109.39 142.98,106.10' id='svg_0166029c-8f0f-4187-92e1-8b6708a95546_el_18' clip-path='url(#svg_0166029c-8f0f-4187-92e1-8b6708a95546_cl_5)' fill='#62E44A' fill-opacity='0.8' stroke='none' title='11% Health care&amp;lt;br&amp;gt;2% nurse practitioner &amp;lt;br&amp;gt;$106,785 median salary'/>\\n    <polygon points='151.16,98.57 155.57,95.12 158.36,98.90 161.16,102.68 163.96,106.45 166.75,110.23 169.55,114.01 172.34,117.79 175.14,121.57 172.13,123.92 169.13,120.30 166.14,116.68 163.14,113.06 160.15,109.43 157.15,105.81 154.16,102.19 151.16,98.57' id='svg_0166029c-8f0f-4187-92e1-8b6708a95546_el_19' clip-path='url(#svg_0166029c-8f0f-4187-92e1-8b6708a95546_cl_5)' fill='#62E44A' fill-opacity='0.2' stroke='none' title='11% Health care&amp;lt;br&amp;gt;1% executive assistant &amp;lt;br&amp;gt;$65,000 median salary'/>\\n    <polygon points='157.15,93.97 161.79,90.85 164.31,94.83 166.82,98.80 169.34,102.77 171.85,106.74 174.37,110.71 176.88,114.68 179.39,118.65 176.22,120.78 173.50,116.95 170.77,113.12 168.05,109.29 165.32,105.46 162.60,101.63 159.88,97.80 157.15,93.97' id='svg_0166029c-8f0f-4187-92e1-8b6708a95546_el_20' clip-path='url(#svg_0166029c-8f0f-4187-92e1-8b6708a95546_cl_5)' fill='#62E44A' fill-opacity='0.4' stroke='none' title='11% Health care&amp;lt;br&amp;gt;1% pharmacist &amp;lt;br&amp;gt;$106,840 median salary'/>\\n    <polygon points='163.46,89.82 168.31,87.05 170.53,91.19 172.75,95.34 174.97,99.48 177.19,103.62 179.41,107.77 181.63,111.91 183.85,116.05 180.53,117.95 178.09,113.93 175.65,109.91 173.21,105.89 170.77,101.88 168.33,97.86 165.90,93.84 163.46,89.82' id='svg_0166029c-8f0f-4187-92e1-8b6708a95546_el_21' clip-path='url(#svg_0166029c-8f0f-4187-92e1-8b6708a95546_cl_5)' fill='#62E44A' fill-opacity='0.6' stroke='none' title='11% Health care&amp;lt;br&amp;gt;1% project manager &amp;lt;br&amp;gt;$88,000 median salary'/>\\n    <polygon points='170.05,86.14 176.17,83.26 182.47,80.78 184.05,85.20 185.63,89.63 187.21,94.06 188.79,98.48 190.36,102.91 191.94,107.34 193.52,111.76 185.03,115.43 182.89,111.25 180.75,107.06 178.61,102.88 176.47,98.69 174.33,94.51 172.19,90.33 170.05,86.14' id='svg_0166029c-8f0f-4187-92e1-8b6708a95546_el_22' clip-path='url(#svg_0166029c-8f0f-4187-92e1-8b6708a95546_cl_5)' fill='#CCEC5A' fill-opacity='1' stroke='none' title='7% Government and Public Administration&amp;lt;br&amp;gt;2% librarian &amp;lt;br&amp;gt;$59,000 median salary'/>\\n    <polygon points='184.32,80.14 193.13,77.61 194.23,82.18 195.32,86.75 196.42,91.32 197.52,95.89 198.61,100.46 199.71,105.03 200.81,109.60 194.79,111.33 193.29,106.87 191.79,102.42 190.30,97.96 188.80,93.50 187.31,89.05 185.81,84.59 184.32,80.14' id='svg_0166029c-8f0f-4187-92e1-8b6708a95546_el_23' clip-path='url(#svg_0166029c-8f0f-4187-92e1-8b6708a95546_cl_5)' fill='#CCEC5A' fill-opacity='0.8' stroke='none' title='7% Government and Public Administration&amp;lt;br&amp;gt;2% analyst &amp;lt;br&amp;gt;$85,650 median salary'/>\\n    <polygon points='195.04,77.17 200.92,76.05 201.67,80.69 202.41,85.33 203.15,89.97 203.90,94.61 204.64,99.25 205.39,103.89 206.13,108.53 202.11,109.30 201.10,104.71 200.09,100.12 199.08,95.53 198.07,90.94 197.06,86.35 196.05,81.76 195.04,77.17' id='svg_0166029c-8f0f-4187-92e1-8b6708a95546_el_24' clip-path='url(#svg_0166029c-8f0f-4187-92e1-8b6708a95546_cl_5)' fill='#CCEC5A' fill-opacity='0.6' stroke='none' title='7% Government and Public Administration&amp;lt;br&amp;gt;1% policy analyst &amp;lt;br&amp;gt;$89,074 median salary'/>\\n    <polygon points='202.86,75.76 208.02,75.16 208.44,79.84 208.86,84.52 209.29,89.20 209.71,93.88 210.13,98.57 210.56,103.25 210.98,107.93 207.45,108.33 206.80,103.68 206.14,99.03 205.48,94.37 204.83,89.72 204.17,85.07 203.51,80.41 202.86,75.76' id='svg_0166029c-8f0f-4187-92e1-8b6708a95546_el_25' clip-path='url(#svg_0166029c-8f0f-4187-92e1-8b6708a95546_cl_5)' fill='#CCEC5A' fill-opacity='0.4' stroke='none' title='7% Government and Public Administration&amp;lt;br&amp;gt;1% director &amp;lt;br&amp;gt;$127,500 median salary'/>\\n    <polygon points='209.97,75.00 214.76,74.77 214.88,79.47 215.00,84.17 215.12,88.87 215.23,93.57 215.35,98.26 215.47,102.96 215.59,107.66 212.31,107.82 211.98,103.13 211.64,98.44 211.31,93.76 210.97,89.07 210.64,84.38 210.30,79.69 209.97,75.00' id='svg_0166029c-8f0f-4187-92e1-8b6708a95546_el_26' clip-path='url(#svg_0166029c-8f0f-4187-92e1-8b6708a95546_cl_5)' fill='#CCEC5A' fill-opacity='0.2' stroke='none' title='7% Government and Public Administration&amp;lt;br&amp;gt;1% manager &amp;lt;br&amp;gt;$120,000 median salary'/>\\n    <polygon points='217.37,109.37 222.10,109.53 226.81,110.02 231.47,110.82 236.07,111.94 240.58,113.37 244.98,115.11 249.26,117.15 253.38,119.47 257.34,122.07 261.11,124.93 264.67,128.04 268.02,131.39 271.13,134.96 273.98,138.73 276.58,142.69 278.89,146.82 280.92,151.09 282.65,155.50 284.08,160.01 285.20,164.61 286.00,169.27 286.47,173.98 286.63,178.71 286.46,183.44 285.97,188.15 285.16,192.81 284.04,197.41 282.60,201.92 280.85,206.32 278.82,210.59 276.49,214.71 273.89,218.67 271.02,222.43 267.90,225.99 264.55,229.33 260.98,232.44 257.20,235.29 253.24,237.88 249.11,240.19 244.83,242.21 240.42,243.94 235.91,245.36 231.31,246.47 226.64,247.27 221.93,247.74 221.61,242.80 221.28,237.87 220.96,232.93 220.63,227.99 220.30,223.06 219.98,218.12 219.65,213.18 224.45,212.53 229.10,211.21 233.53,209.26 237.64,206.71 241.35,203.61 244.60,200.03 247.31,196.02 249.45,191.68 250.95,187.08 251.80,182.32 251.98,177.49 251.48,172.68 250.32,167.98 248.52,163.49 246.10,159.30 243.13,155.49 239.65,152.12 235.74,149.27 231.47,147.00 226.93,145.34 222.20,144.34 217.37,144.00 217.37,139.05 217.37,134.11 217.37,129.16 217.37,124.21 217.37,119.26 217.37,114.32 217.37,109.37' id='svg_0166029c-8f0f-4187-92e1-8b6708a95546_el_27' clip-path='url(#svg_0166029c-8f0f-4187-92e1-8b6708a95546_cl_5)' fill='#830CAB' fill-opacity='1' stroke='none'/>\\n    <polygon points='220.63,247.81 215.77,247.87 210.92,247.59 206.09,246.97 201.33,246.01 196.64,244.72 192.05,243.10 187.59,241.16 183.28,238.92 179.13,236.38 175.18,233.55 171.43,230.46 167.90,227.11 164.62,223.52 161.60,219.71 158.86,215.69 156.40,211.50 154.25,207.14 158.76,205.10 163.27,203.07 167.77,201.03 172.28,198.99 176.79,196.96 181.30,194.92 185.81,192.88 188.28,197.42 191.40,201.53 195.09,205.14 199.28,208.16 203.87,210.52 208.76,212.17 213.84,213.08 219.00,213.22 219.23,218.16 219.47,223.11 219.70,228.05 219.93,232.99 220.17,237.93 220.40,242.87 220.63,247.81' id='svg_0166029c-8f0f-4187-92e1-8b6708a95546_el_28' clip-path='url(#svg_0166029c-8f0f-4187-92e1-8b6708a95546_cl_5)' fill='#6574FA' fill-opacity='1' stroke='none'/>\\n    <polygon points='153.72,205.94 151.89,201.20 150.41,196.34 149.29,191.38 148.54,186.36 148.16,181.29 148.15,176.21 148.52,171.14 149.25,166.11 150.35,161.15 151.82,156.28 153.63,151.53 158.18,153.47 162.74,155.40 167.29,157.34 171.84,159.27 176.39,161.21 180.95,163.15 185.50,165.08 183.74,170.38 182.85,175.90 182.86,181.48 183.76,186.99 185.55,192.29 181.00,194.24 176.45,196.19 171.91,198.14 167.36,200.09 162.82,202.04 158.27,203.99 153.72,205.94' id='svg_0166029c-8f0f-4187-92e1-8b6708a95546_el_29' clip-path='url(#svg_0166029c-8f0f-4187-92e1-8b6708a95546_cl_5)' fill='#3BBCAC' fill-opacity='1' stroke='none'/>\\n    <polygon points='154.15,150.34 156.39,145.79 158.95,141.42 161.83,137.26 165.00,133.31 168.45,129.60 172.16,126.16 176.12,123.00 180.29,120.13 184.67,117.58 187.00,121.94 189.34,126.30 191.67,130.66 194.01,135.02 196.35,139.38 198.68,143.74 201.02,148.10 196.24,151.19 192.03,155.03 188.51,159.50 185.76,164.48 181.25,162.46 176.73,160.44 172.21,158.42 167.70,156.40 163.18,154.38 158.67,152.36 154.15,150.34' id='svg_0166029c-8f0f-4187-92e1-8b6708a95546_el_30' clip-path='url(#svg_0166029c-8f0f-4187-92e1-8b6708a95546_cl_5)' fill='#62E44A' fill-opacity='1' stroke='none'/>\\n    <polygon points='185.82,116.97 190.51,114.79 195.34,112.97 200.30,111.51 205.35,110.42 210.47,109.71 215.63,109.39 215.76,114.34 215.88,119.28 216.00,124.23 216.13,129.17 216.25,134.12 216.38,139.07 216.50,144.01 211.36,144.53 206.36,145.80 201.60,147.80 199.34,143.40 197.09,138.99 194.84,134.59 192.58,130.18 190.33,125.78 188.08,121.38 185.82,116.97' id='svg_0166029c-8f0f-4187-92e1-8b6708a95546_el_31' clip-path='url(#svg_0166029c-8f0f-4187-92e1-8b6708a95546_cl_5)' fill='#CCEC5A' fill-opacity='1' stroke='none'/>\\n    <polyline points='215.63,109.39 217.37,109.37 217.37,114.32 217.37,119.26 217.37,124.21 217.37,129.16 217.37,134.11 217.37,139.05 217.37,144.00 216.50,144.01 216.38,139.07 216.25,134.12 216.13,129.17 216.00,124.23 215.88,119.28 215.76,114.34 215.63,109.39 215.63,109.39' id='svg_0166029c-8f0f-4187-92e1-8b6708a95546_el_32' clip-path='url(#svg_0166029c-8f0f-4187-92e1-8b6708a95546_cl_5)' fill='none' stroke='none'/>\\n    <defs>\\n      <clipPath id='svg_0166029c-8f0f-4187-92e1-8b6708a95546_cl_6'>\\n        <rect x='0.00' y='0.00' width='432.00' height='360.00'/>\\n      <\\/clipPath>\\n    <\\/defs>\\n  <\\/g>\\n<\\/svg>\",\"js\":null,\"uid\":\"svg_0166029c-8f0f-4187-92e1-8b6708a95546\",\"ratio\":1.2,\"settings\":{\"tooltip\":{\"css\":\".tooltip_SVGID_ { padding:5px;background:black;color:white;border-radius:2px 2px 2px 2px ; position:absolute;pointer-events:none;z-index:999;}\\n\",\"offx\":10,\"offy\":0,\"use_cursor_pos\":true,\"opacity\":0.9,\"usefill\":true,\"usestroke\":false,\"delay\":{\"over\":200,\"out\":500}},\"hover\":{\"css\":\".hover_SVGID_ { fill:orange;stroke:gray; }\\n\",\"reactive\":false},\"hoverkey\":{\"css\":\".hover_key_SVGID_ { stroke:red; }\\n\",\"reactive\":false},\"hovertheme\":{\"css\":\".hover_theme_SVGID_ { fill:green; }\\n\",\"reactive\":false},\"hoverinv\":{\"css\":\"\"},\"zoom\":{\"min\":1,\"max\":1},\"capture\":{\"css\":\".selected_SVGID_ { fill:red;stroke:gray; }\\n\",\"type\":\"multiple\",\"only_shiny\":true,\"selected\":[]},\"capturekey\":{\"css\":\".selected_key_SVGID_ { stroke:gray; }\\n\",\"type\":\"single\",\"only_shiny\":true,\"selected\":[]},\"capturetheme\":{\"css\":\".selected_theme_SVGID_ { stroke:gray; }\\n\",\"type\":\"single\",\"only_shiny\":true,\"selected\":[]},\"toolbar\":{\"position\":\"topright\",\"saveaspng\":true,\"pngname\":\"diagram\"},\"sizing\":{\"rescale\":true,\"width\":1}}},\"evals\":[],\"jsHooks\":[]}\r\nFor fun\r\nI did experiment with some variations on this figure that did not make the cut!\r\n\r\n\r\nMonday's work 🤔🥰 #rstats #ggplot pic.twitter.com/GbZWLhLeDA\r\n\r\n— Shannon Pileggi (@PipingHotData) February 4, 2020\r\n\r\n\r\n\r\n\r\n",
    "preview": "posts/2021-04-03-sunburst/sunburst_files/figure-html5/unnamed-chunk-12-1.png",
    "last_modified": "2021-05-31T01:35:14-04:00",
    "input_file": "sunburst.utf8.md",
    "preview_width": 1248,
    "preview_height": 768
  },
  {
    "path": "posts/2021-04-01-deploy-previews-with-netlifly/",
    "title": "Deploy previews with Netlifly",
    "description": "Collaborative {distill} website workflows",
    "author": [
      {
        "name": "Shannon Pileggi",
        "url": {}
      }
    ],
    "date": "2021-04-01",
    "categories": [],
    "contents": "\r\n\r\nContents\r\nTL; DR\r\nBackground\r\nNetlifly settings\r\nBack in website development\r\nAcknowledgements\r\n\r\nTL; DR\r\nIf you are deploying your {distill} website through Netlifly, you can enable deploy previews to create temporary urls to preview a branch.\r\nBackground\r\nMy usual website workflow so far has been to draft posts in my master branch with draft: true in the yaml, and then when I am ready to publish switch to draft: false and commit to my main/master branch. Recently, I’ve been inspired to try alternative workflows:\r\n\r\n\r\nI’m also a huge convert to the church of making PRs to yourself. Start with an R Markdown project like a simple slide deck or a bookdown book, then get into the habit of every change is a branch + PR. Low cost, but teaches you a lot! pic.twitter.com/Ee3tuoS4Ef\r\n\r\n— Alison Presmanes Hill (@apreshill) February 20, 2021\r\n\r\nI also collaborated with someone on a blog post for the first time, and I learned that you can send links to preview branches! 🎉 For both solo and collaborative posts, this is my new workflow.\r\nI did a quick search for existing guides, and I found that Garrick Aden‑Buie has a comprehensive 2019 blog post titled A Blogdown New Post Workflow with Github and Netlify. Some of the steps are specific to {blogdown}, so here is my {distill} take on it.\r\nNetlifly settings\r\nFirst, make sure you have deploy previews enabled on Netlifly. Login to Netlifly, go to your site, and then:\r\n➡️ Site settings\r\n➡️ Build & deploy\r\n➡️ Deploy contexts\r\n➡️ Deploy previews\r\n➡️ Select Any pull request against your production branch / branch deploy branches Netlify will generate a deploy preview with a unique URL for each built pull request.\r\n\r\n\r\n\r\nFigure 1: Screenshot of Netlifly settings with Deploy previews set to “Any pull request…”.\r\n\r\n\r\n\r\nBack in website development\r\nCreate a branch for your website repository. I am naming my branch netlifly-deploy-branch, and in the R console submit:\r\n\r\n\r\nusethis::pr_init(\"netlifly-deploy-branch\")\r\n\r\n\r\n\r\nCreate a post. In R console submit:\r\n\r\n\r\ndistill::create_post(\"Deploy previews with Netlifly\")\r\n\r\n\r\n\r\nDraft post; set draft: false in the yaml.\r\nKnit post.\r\nCommit everything. In terminal submit:\r\n\r\ngit add .\r\ngit commit -m \"draft netlifly post\"\r\n\r\nPush to GitHub. In R console submit:\r\n\r\n\r\nusethis::pr_push()\r\n\r\n\r\n\r\nIn GitHub, click “Create pull request”.\r\nSome automatic checks will run. Click on “Details” where it says “Deploy preview ready!”\r\n\r\n\r\n\r\nFigure 2: Screenshot of checks run on GitHub pull request. Click on “Details” where it says “Deploy preview ready!”\r\n\r\n\r\n\r\nThis opens up a window in my browser with the url https://deploy-preview-3--flamboyant-mccarthy-854a9b.netlify.app/. Send this link to a friend for review!\r\nEdit draft, repeat steps 4-8.\r\nWhen ready to publish, back in GitHub click on “Merge pull request”\r\nI’m new to this workflow and this post was written quickly - edits and suggestions are welcome!\r\nAcknowledgements\r\nThanks, Alison Hill!🤗\r\n\r\n\r\n\r\n",
    "preview": "posts/2021-04-01-deploy-previews-with-netlifly/img/netlifly-checks.png",
    "last_modified": "2021-04-01T23:48:44-04:00",
    "input_file": "deploy-previews-with-netlifly.utf8.md",
    "preview_width": 1358,
    "preview_height": 704
  },
  {
    "path": "posts/2021-03-08-r-ladies-styled-code-gifs-with-xaringan-and-flipbookr/",
    "title": "R-Ladies styled code gifs with xaringan and flipbookr",
    "description": "The code behind my @WeAreRLadies curating week",
    "author": [
      {
        "name": "Shannon Pileggi",
        "url": {}
      }
    ],
    "date": "2021-03-08",
    "categories": [],
    "contents": "\r\n\r\nContents\r\nTL; DR\r\nGetting started\r\nCreating slides\r\nStyling slides\r\nRecording the gif\r\nCode gifs shared\r\nOther options\r\nAccessibility\r\nAcknowledgements\r\nOuttakes\r\n\r\nTL; DR\r\nI curated the @WeAreRLadies twitter account from Feb 15 - 20, 2021. During my curation, I shared brief R code gifs created with xaringan, flipbookr, a bit of custom CSS, and the ScreenToGif recorder. Full code is available in the rladies-flipbookr repo; here is an example gif:\r\n\r\n\r\n\r\nFigure 1: Walrus operator gif. You can read more about this topic at https://www.tidyverse.org/blog/2020/02/glue-strings-and-tidy-eval/.\r\n\r\n\r\n\r\nGetting started\r\nThis material was developed using:\r\nSoftware / package\r\nVersion\r\nR\r\n4.0.3\r\nRStudio\r\n1.4.1103\r\ntidyverse\r\n1.3.0\r\nxaringan\r\n0.19\r\nflipbookr\r\n0.1.0\r\nCreating slides\r\nThe flipbookr template makes it easy to quickly create content! I used the classic flipbook, with defaults to walk through the code pipeline (slides 3-4 in the template).\r\nTo create a flipbook slide that advances code line by line, create a named R code chunk with the include = FALSE option, and then present the code chunk with flipbookr::chunk_reveal. The order of defining the chunk versus revealing the chunk does not matter in your RMarkdown document. Longer content was broken into multiple code chunks.\r\n`r chunk_reveal(\"walrus\", title = \"## Walrus operator\")`\r\n```{r walrus, include = FALSE}\r\nlibrary(tidyverse)\r\nlibrary(rlang)\r\nlibrary(glue)\r\n\r\nsuffix <- \"A\" \r\n\r\ndat <- tibble(x = 1:5) %>%\r\n  mutate(\r\n    \"x_{suffix}\" := x\r\n  ) \r\n\r\ndat %>% \r\n  dplyr::select(\r\n    glue::glue(\"x_{suffix}\")\r\n    ) \r\n```\r\nStyling slides\r\nI first styled the content used Alison Hill’s R-Ladies xaringan theme by declaring R-Ladies CSS options in the yaml parameters:\r\ncss: [\"default\", \"rladies\", \"rladies-fonts\"]\r\nresulting in\r\n\r\n\r\n\r\nFigure 2: Flipbookr walrus operator content styled with R-Ladies xaringan theme.\r\n\r\n\r\n\r\nHowever, the highlighting shade was a tad too dark for me, and I was concerned that the font size would be too small to be legible in a gif on twitter. I updated the CSS with bits lifted from xaringan templates and some modifications on font size and color kindly developed by Silvia Canelón.\r\n\r\n\r\n\r\nFigure 3: Flipbookr walrus operator content styled with R-Ladies xaringan theme adjusted with lighter highlight shade and larger font size.\r\n\r\n\r\n\r\nThe changes are subtle, but I hope they improve readability! The increased font size did create a challenge for code formatting and for the amount of code that could be shown on a single slide.\r\nSilvia showed me how to modify the CSS through (1) inclusion of a CSS code chunk, and (2) calling a separate CSS sheet. For option (2), change the yaml to point to your custom CSS:\r\ncss: [\"default\", \"default-fonts\", \"css/rladies-adjusted.css\"]\r\nYou can see the full code for the default xaringan theme and the two ways of adjusting the CSS for all the gifs I created in the shannonpileggi/rladies-flipbookr github repository.\r\nIf you have configured a GitHub personal access token, you can fork and clone this repo with:\r\n\r\n\r\nusethis::create_from_github(\"shannonpileggi/rladies-flipbookr\")\r\n\r\n\r\n\r\nRecording the gif\r\nI recorded the gifs by manually advancing the slides with the screen recorder ScreenToGif (for Windows OS). Bryan Shalloway has some code to automatically create gifs from xaringan slides, but I didn’t go that route this time - maybe next!\r\nCode gifs shared\r\nHere are the R code gifs that I shared on twitter during my @WeAreRLadies curating week:\r\nwalrus operator\r\nmutate_at + vars + matches\r\nmutate + across + matches\r\nhaven + gtsummary\r\nnamed color vectors + scale_color_manual\r\nOther options\r\nDuring my curating week, I learned about the carbonate package! This also seems like a fantastic option for aesthetically appealing code sharing.\r\nAccessibility\r\nVisual code sharing through gifs and images can be a great way to share content! However, please remember to share the content with everyone. Gifs and images on their own are not accessible to members of our community that use assistive technology to read digital content. In order to make gifs and images accessible to screen readers, you can include descriptions or share code in otherwise accessible formats like GitHub gists. If I miss making any of my content accessible, please let me know!\r\nAcknowledgements\r\nI have to give Silvia Canelón (@spcanelon) a huge shout out here. My curating week started on a Monday, and on Monday night I was still trying to figure out how I wanted to style my code. We chatted on R-Ladies slack, and she quickly helped me make CSS adjustments to the default xaringan R-Ladies theme. After the curating week, Silvia helped me fine tune the bits to share that are now in the rladies-flipbookr repo. Additionally, she advises me on inclusivity and accessibility best practices, which I am still striving to meet. Thank you, Silvia! 💜 🙏\r\nLastly, thanks to the friendly RStudio Community forum for helping me figure out both the in line verbatim I used in this post and the dplyr::select() portion of the walrus operator gif.\r\nOuttakes\r\nI experimented with, and actually recorded, some alternative formats before I landed on flipbookr. Here are two gifs that didn’t make the cut! 🙈\r\n\r\n\r\n\r\nFigure 4: Walrus operator gif recorded as a scrolling RMarkdown document.\r\n\r\n\r\n\r\n\r\n\r\n\r\nFigure 5: Walrus operator gif recorded as code submitted to console.\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
    "preview": "posts/2021-03-08-r-ladies-styled-code-gifs-with-xaringan-and-flipbookr/walrus-adjusted.png",
    "last_modified": "2021-03-09T05:42:50-05:00",
    "input_file": {},
    "preview_width": 1536,
    "preview_height": 861
  },
  {
    "path": "posts/2021-02-15-gganimating-a-geographic-introduction/",
    "title": "GGanimating a geographic introduction",
    "description": "A gif for social media",
    "author": [
      {
        "name": "Shannon Pileggi",
        "url": {}
      }
    ],
    "date": "2021-02-15",
    "categories": [],
    "contents": "\r\n\r\nContents\r\nTL;DR\r\nGetting started\r\nFonts\r\nThe data\r\nBase map\r\nAnimated map\r\nDiscussion\r\n\r\nTL;DR\r\nTo kick off my week curating the @WeAreRLadies twitter account I created a gif to introduce myself using gganimate and ggtext.\r\nGetting started\r\nThis material was developed using:\r\nSoftware / package\r\nVersion\r\nR\r\n4.0.3\r\nRStudio\r\n1.4.1103\r\ntidyverse\r\n1.3.0\r\ngganimate\r\n1.0.7\r\nextrafont\r\n0.17\r\nggtext\r\n0.1.1\r\nglue\r\n1.4.1\r\n\r\n\r\nlibrary(tidyverse) # general use ----\r\nlibrary(gganimate) # to create animated gif ----\r\nlibrary(extrafont) # access and enable fonts ----\r\nlibrary(ggtext)    # style text in ggplot ----\r\nlibrary(glue)      # paste strings ----  \r\n\r\n\r\n\r\nFonts\r\nFonts were challenging for me to get started with in R, and I got some great tips on twitter. I ended up manually installing new fonts on my Windows 10 OS and then using the extrafont package to access the fonts in R.\r\n\r\n\r\n# import fonts; only needed one time or after new font installation ----\r\n# fonts may install to multiple directories; figure out where yours are installed ----\r\n# and adjust path accordingly if needed ----\r\n# this can take a while ----\r\nextrafont::font_import()\r\n\r\n# do this each R session in which you want to use fonts ----\r\nextrafont::loadfonts(device = \"win\")\r\n\r\n# examine font family names available for use (output not shown) ----\r\nextrafont::fonts()\r\n\r\n\r\n\r\nThe data\r\nThe data needed to create a map of the US is already contained within ggplot2.\r\n\r\n\r\nus_states <- ggplot2::map_data(\"state\")\r\n\r\n\r\n\r\nTo show locations where I have lived, I manually compiled a data frame with city, state, latitude, longitude, and a description.\r\n\r\n\r\n# use <br> to render line breaks with ggtext ----\r\nresidence <- tribble(\r\n  ~city,           ~state,  ~lat,   ~long, ~years, ~description,\r\n  \"Raleigh\",         \"NC\", 35.82,  -78.66,  17,    \"Childhood\",\r\n  \"Greenville\",      \"NC\", 35.60,  -77.37,   4,    \"Undergrad at ECU\",\r\n  \"Atlanta\",         \"GA\", 33.76,  -84.42,  10,    \"Grad school at Emory<br>Statistician at CDC<br>Lecturer at Emory\",\r\n  \"San Luis Obispo\", \"CA\", 35.28, -120.66,   3,    \"Asst. Professor at Cal Poly SLO\",\r\n  \"Williamsburg\",    \"VA\", 37.27,  -76.71, 0.5,    \"Time with family\",\r\n  \"Doylestown\",      \"PA\", 40.31,  -75.13,   2,    \"Statistician at Adelphi Research\"\r\n) \r\n\r\n\r\n\r\nThen I needed to create a transition state for gganimate (city_order) as well as indicate connections between residences for the arrows.\r\n\r\n\r\nresidence_connections_prelim <- residence %>% \r\n  mutate(\r\n    # need this to create transition state ----\r\n    city_order = row_number() + 1,\r\n    # where I moved to next, for curved arrows ----\r\n    lat_next = lead(lat),\r\n    long_next = lead(long),\r\n    # label to show in plot, styled using ggtext ---\r\n    label = glue::glue(\"**{city}, {state}** ({years} yrs)<br>*{description}*\"),\r\n    # label of next location ----\r\n    label_next = lead(label)\r\n  ) \r\n\r\n\r\n\r\nLastly, I modified this data a bit so that the first residence shows the label at the residence with no arrow and all remaining residences show an arrow with the label positioned at the next residence.\r\n\r\n\r\nresidence_connections <- residence_connections_prelim %>%\r\n  # get first row of residence ----\r\n  slice(1) %>% \r\n  # manually modify for plotting ----\r\n  mutate(\r\n    city_order = 1,\r\n    label_next = label,\r\n    lat_next = lat,\r\n    long_next = long,\r\n    ) %>% \r\n  # combine with all other residences ----\r\n  bind_rows(residence_connections_prelim) %>% \r\n  # last (7th) row irrelevant ----\r\n  slice(1:6) %>% \r\n  # keep what we neeed ----\r\n  dplyr::select(city_order, lat, long, lat_next, long_next, label_next)\r\n\r\n\r\n\r\n\r\n\r\nresidence_connections\r\n\r\n\r\n# A tibble: 6 x 6\r\n  city_order   lat   long lat_next long_next label_next               \r\n       <dbl> <dbl>  <dbl>    <dbl>     <dbl> <glue>                   \r\n1          1  35.8  -78.7     35.8     -78.7 **Raleigh, NC** (17 yrs)~\r\n2          2  35.8  -78.7     35.6     -77.4 **Greenville, NC** (4 yr~\r\n3          3  35.6  -77.4     33.8     -84.4 **Atlanta, GA** (10 yrs)~\r\n4          4  33.8  -84.4     35.3    -121.  **San Luis Obispo, CA** ~\r\n5          5  35.3 -121.      37.3     -76.7 **Williamsburg, VA** (0.~\r\n6          6  37.3  -76.7     40.3     -75.1 **Doylestown, PA** (2 yr~\r\n\r\nBase map\r\nFor the map itself, I created a base map showing pins of the locations I have lived. Hex codes for R-Ladies colors were obtained from this blog post by Alison Hill. I briefly experimented with coord_map for projection, but then the subsequent curved arrows presented incorrectly.\r\n\r\n\r\nbase_map <- ggplot() +\r\n  # plot states ----\r\n  geom_polygon(\r\n    data = us_states,\r\n    aes(\r\n      x     = long, \r\n      y     = lat, \r\n      group = group\r\n      ),\r\n    fill  = \"#F2F2F2\",\r\n    color = \"white\"\r\n  ) +\r\n  # lines for pins ----\r\n  geom_segment(\r\n    data = residence,\r\n    aes(\r\n      x    = long,\r\n      xend = long,\r\n      y    = lat,\r\n      yend = lat + 0.5\r\n      ),\r\n    color = \"#181818\",\r\n    size = 0.3\r\n    ) +\r\n    # pin heads, a bit above actual location, color with R ladies lighter purple ----\r\n  geom_point(\r\n    data = residence,\r\n    aes(\r\n      x = long, \r\n      y = lat + 0.5\r\n      ),\r\n    size = 0.5,\r\n    color = \"#88398A\"\r\n  ) +\r\n  theme_void()\r\n\r\n\r\n\r\nThe sizing of the pins in the base_map appears different than in the gif below as increasing the resolution of the output gif alters plotting ratios.\r\n\r\n\r\nbase_map\r\n\r\n\r\n\r\n\r\nAnimated map\r\n\r\n\r\nanim <- base_map +\r\n  # show arrows connecting residences ----\r\n  geom_curve(\r\n    # do not include 1st residence in arrows as no arrow is intended ----\r\n    # and inclusion messes up transition ---\r\n    data = residence_connections %>% slice(-1),\r\n    # add slight adjustment to arrow positioning ----\r\n    aes(\r\n      y     = lat - 0.1,\r\n      x     = long,\r\n      yend  = lat_next - 0.2,\r\n      xend  = long_next,\r\n      # group is used to create the transition ----\r\n      group = seq_along(city_order)\r\n    ),\r\n    color = \"#181818\",\r\n    curvature = -0.5,\r\n    arrow = arrow(length = unit(0.02, \"npc\")),\r\n    size  = 0.2\r\n  ) +\r\n  # add in labels for pins, with inward positioning ----\r\n  # show labels either top left or top right of pin ----\r\n  geom_richtext(\r\n    data = residence_connections,\r\n    aes(\r\n      x     = ifelse(long_next < -100, long_next + 1, long_next - 1),\r\n      y     = lat_next + 5,\r\n      label = label_next,\r\n      vjust = \"top\",\r\n      hjust = ifelse(long_next < -100, 0, 1),\r\n      # group is used to create the transition ----\r\n      group = seq_along(city_order)\r\n    ),\r\n    size = 2,\r\n    label.colour = \"white\",\r\n    # R ladies purple ----\r\n    color = \"#562457\",\r\n    # R ladies font used in xaringan theme ----\r\n    family = \"Lato\"\r\n  ) +\r\n  # title determined by group value in transition ----\r\n  ggtitle(\"Home {closest_state} of 6\") +\r\n  # create animation ----\r\n  transition_states(\r\n    city_order,\r\n    transition_length = 2,\r\n    state_length = 5\r\n    ) +\r\n  # style title ----\r\n  theme(\r\n    plot.title = element_text(\r\n      color = \"#562457\",\r\n      family = \"Permanent Marker\",\r\n      size = 12\r\n      )\r\n    )\r\n\r\n\r\n\r\n\r\n\r\n# render and save transition ----\r\n# the default nframes 100 frames, 150 makes the gif a bit longer for readability ----\r\n# changing dimensions for output w/ height & width ----\r\n# increasing resolution with res ----\r\nanimate(anim, nframes = 150, height = 2, width = 3, units = \"in\", res = 150)\r\nanim_save(\"homes_animation.gif\")\r\n\r\n\r\n\r\n\r\nDiscussion\r\nI hope this gif helped you learn a little bit about me! I’m a southern girl who was never quite cool enough for California still learning how to navigate personalities in the northeast. 😂\r\nI do have two additional short-term residences not shown here. Although I was born in Raleigh, NC, I lived in Accra, Ghana until I was 1 year old (my father served in the US military and worked at the American Embassy in Accra). I also lived in Seville, Spain for a semester abroad during college.\r\nIn this gif I did not include transitions between countries (because, you know, I’m a parent working in a pandemic and I have to draw the line on my free time somewhere). In addition, aligning sizing with resolution of the output device took some experimentation.\r\nI would love to get to know you through your gif - if you happen to replicate this for yourself please share with me on Twitter, LinkedIn, or email! I also invite you to improve this gif with cooler transitions, international locations, awesome styles, or anything else. 😀 💜\r\n\r\n\r\n\r\n",
    "preview": "posts/2021-02-15-gganimating-a-geographic-introduction/homes_preview.png",
    "last_modified": "2021-02-15T05:33:13-05:00",
    "input_file": {},
    "preview_width": 919,
    "preview_height": 461
  },
  {
    "path": "posts/2021-01-11-from-gmailr-to-the-google-books-api/",
    "title": "From gmailr to the Google Books API",
    "description": "A parenting project to catalog my childrens' 2020 library history",
    "author": [
      {
        "name": "Shannon Pileggi",
        "url": {}
      }
    ],
    "date": "2021-01-11",
    "categories": [],
    "contents": "\r\nTable of Contents\r\nTL; DR\r\nBackground\r\nGetting started\r\n1 {gmailr} retrieve library notifications from gmail\r\n2 {stringr} extract title and author from email\r\n3 {httr} query google books api\r\n4 {purrrr} extract content from search results\r\n5 {DT} present books in an interactive table\r\nTechnical reflection\r\nPersonal note\r\nAcknowledgements\r\n\r\n\r\n\r\nTL; DR\r\nIn the last six months of 2020, I read 214 children’s books from the library with my daughters. The gmailr and httr packages, and the Google Books API, allowed me to create a catalog of the books we read with preview images. You can skip straight to the books, or read on for code that follows these main steps with their primary packages.\r\n\r\nBackground\r\nI live in Doylestown, PA (Bucks County), with my husband and two daughters (2 and 5 years old). On March 14, 2020, the Bucks County library system closed due to COVID-19; on June 22, 2020, the library opened with curbside pick-up service. Every one to two weeks, I began to place children’s books on hold (up to 15 at a time), and when a hold arrives, I receive an email notice like this:\r\n\r\nEmail notifications are sent around midnight, collating any books that arrived that day. As the email notifications trickled in and patterns emerged, I conceptualized a project to programmatically create a catalog of the library books we had placed on hold by extracting the books from my gmail and then augmenting their information from an API.\r\nGetting started\r\nThis material was developed using:\r\nSoftware / package\r\nVersion\r\nR\r\n4.0.3\r\nRStudio\r\n1.3.1073\r\ntidyverse\r\n1.3.0\r\ngmailr\r\n1.0.0\r\nhttr\r\n1.4.2\r\nlubridate\r\n1.7.8\r\ngt\r\n0.2.2\r\nglue\r\n1.4.1\r\nDT\r\n0.15\r\n\r\n\r\nlibrary(tidyverse) # general use ----\r\nlibrary(gmailr)    # retrieve emails  ----\r\nlibrary(httr)      # access api ----\r\nlibrary(lubridate) # repair dates ----\r\nlibrary(gt)        # for web_image helper function ----\r\nlibrary(glue)      # paste strings ----  \r\nlibrary(DT)        # interactive table ----  \r\n\r\n1 {gmailr} retrieve library notifications from gmail\r\nI followed the gmailr set up instructions to authenticate myself and enable R’s gmailr package to interact with the Gmail API for my personal Gmail account, which was fairly straightforward. This required some point and click in other interfaces, followed by two lines of R code.\r\n\r\n\r\ngm_auth_configure(path = \"path/credentials.json\")\r\ngm_auth()\r\n\r\nOnce authenticated, I retrieved the email notifications from my gmail account. It was not immediately clear to me how to do this, but this stack overflow thread helped.\r\n\r\n\r\n# 1 - retrieve messages corresponding to this search ----\r\nmessages <- gmailr::gm_messages(\"Bucks County Library System - Available Hold Pickup Notice\")\r\n\r\n# 2 - extract ids from messages corresponding to search ----\r\nmessage_ids <- gmailr::gm_id(messages)\r\n\r\n# 3 - extract contents from messages with these ids -----\r\nmessage_full <- purrr::map(message_ids, gmailr::gm_message)\r\n\r\n# 4 - extract message body from contents -----\r\nmessage_body <- purrr::map(message_full, gmailr::gm_body)\r\n\r\nThis resulted in 67 email notifications from June 22, 2020 to December 30, 3020, containing from 1 to 11 books per email. Here is an example character string returned to me, corresponding to the email notification shown above.\r\n\r\n\r\nmessage_body[[66]]\r\n\r\n[1] \"Wednesday, June 24, 2020\\r\\n\\r\\nBCFL Doylestown Branch\\r\\n150 South Pine Street\\r\\nDoylestown, PA\\r\\n18901-4932\\r\\n215-348-9081\\r\\n\\r\\n          Shannon M Pileggi\\r\\n          \\r\\n          Doylestown, PA\\r\\n          18901\\r\\n          \\r\\n\\r\\nDear Shannon Pileggi,\\r\\n                     \\\"AVAILABLE HOLD PICKUP NOTICE\\\"\\r\\n\\r\\nGood news! The material you requested is available for pickup from the library \\r\\nfor 2 weeks from the date of this email.\\r\\n\\r\\nPlease call your library to learn about curbside pickup or visit buckslib.org/cu\\r\\nrbside to see instructions for curbside pickup at your library.\\r\\n\\r\\nWe are accepting returns at our bookdrops.\\r\\n\\r\\nIf you no longer need this material, please cancel your hold by calling your \\r\\nlibrary or updating the information in the Review My Account section of My \\r\\nAccount: buckslib.org/MyAccount \\r\\n\\r\\nThank you.\\r\\n\\r\\n*********\\r\\nPlease do not respond to this email; it has been sent automatically from an \\r\\nunmonitored mailbox. For questions, contact the library listed above.\\r\\n\\r\\n  1   My trip to the science museum / by Mercer Mayer.\\r\\n      Mayer, Mercer, 1943-\\r\\n      call number:E FICTION MAYER                             copy:1    \\r\\n        Pickup by:7/8/2020  \\r\\n      hold pickup library:BCFL Doylestown Branch                                \\r\\n      \\r\\n \\r\\n\\r\\n  2   American girl. Bitty Baby has a tea party / by Kirby Larson & Sue\\r\\n      Cornelison.\\r\\n      Larson, Kirby\\r\\n      call number:E FICTION AMERICAN                          copy:3    \\r\\n        Pickup by:7/8/2020  \\r\\n      hold pickup library:BCFL Doylestown Branch                                \\r\\n      \\r\\n \\r\\n\\r\\n  3   The day the crayons quit / by Drew Daywalt ; pictures by Oliver Jeffers.\\r\\n      Daywalt, Drew.\\r\\n      call number:E FICTION DAYWALT                           copy:1    \\r\\n        Pickup by:7/8/2020  \\r\\n      hold pickup library:BCFL Doylestown Branch                                \\r\\n      \\r\\n \\r\\n\\r\\n\"\r\n\r\n\r\n2 {stringr} extract title and author from email\r\nI then did my best to convert the date of the email notification, the book title, and book author to a tibble. This was a three step iterative process.\r\nFirst, I created a list with the dates of the 67 emails.\r\n\r\n\r\n# 1 - extract date of email notification ----\r\nmessage_date <- purrr::map(\r\n  message_body, \r\n    # start string at first character, end where 2020 ends ----\r\n    ~ stringr::str_sub(.x , start = 1, end = str_locate(.x, \"2020\") %>% .[2]) %>% \r\n    # convert text string to date ----\r\n    lubridate::mdy(.)\r\n    )\r\n\r\n\r\n\r\n# view date corresponding to email notice ----\r\nmessage_date[[66]]\r\n\r\n[1] \"2020-06-24\"\r\n\r\nSecond, I did some initial cleaning to remove the introductory text, and then split the strings by numbers.\r\n\r\n\r\nmessage_books <- purrr::map(\r\n  message_body,  \r\n    # remove formatting text, affect other stringr code ----\r\n    ~ str_remove_all(.x, \"[\\\\r|\\\\n]\") %>% \r\n    # remove all introductory text ----\r\n    str_remove(\".* listed above.  \") %>%\r\n    # split string when any number is identified ----\r\n    str_split(\"[[:digit:]]   \")\r\n)\r\n\r\n\r\n\r\n# view entries corresponding to email notice ----\r\nmessage_books[[66]]\r\n\r\n[[1]]\r\n [1] \"\"                                                                                                                                                                        \r\n [2] \"My trip to the science museum / by Mercer Mayer.      Mayer, Mercer, 1943-      call number:E FICTION MAYER                             copy:\"                           \r\n [3] \"         Pickup by:7/8/202\"                                                                                                                                              \r\n [4] \"     hold pickup library:BCFL Doylestown Branch                                         \"                                                                                \r\n [5] \"American girl. Bitty Baby has a tea party / by Kirby Larson & Sue      Cornelison.      Larson, Kirby      call number:E FICTION AMERICAN                          copy:\"\r\n [6] \"         Pickup by:7/8/202\"                                                                                                                                              \r\n [7] \"     hold pickup library:BCFL Doylestown Branch                                         \"                                                                                \r\n [8] \"The day the crayons quit / by Drew Daywalt ; pictures by Oliver Jeffers.      Daywalt, Drew.      call number:E FICTION DAYWALT                           copy:\"         \r\n [9] \"         Pickup by:7/8/202\"                                                                                                                                              \r\n[10] \"     hold pickup library:BCFL Doylestown Branch                                       \"                                                                                  \r\n\r\nThird, I converted this to a tibble, removed all non-book rows, and iterated with stringr functions to get the title and author as best as I could. This was challenging as not all entries had consistent formatting, and some adjustments I could make here improved the Google Books API search later. Some of the stringr functions could probably be collapsed, but the code mimics the steps I took and also allowed me to easily backtrack on failed attempts.\r\n\r\n\r\n# split author and books into separate variables ----\r\nbooks <- message_books %>% \r\n  # coerce list to tibble ----\r\n  tibble() %>% \r\n  # rename first column ----\r\n  rename(\"text\" = 1) %>% \r\n  # unnest list text field ----\r\n  unnest(cols = \"text\") %>%\r\n  # merge in notice date ----\r\n  mutate(notice_date = message_date %>% unlist() %>% as_date()) %>% \r\n  # unnest one more time ----\r\n  unnest(cols = \"text\") %>% \r\n  # remove strings starting with spaces, these are not books ----\r\n  filter(!str_sub(text, 1, 1) %in% c(\" \", \"\")) %>% \r\n  # a lot of iteration here to extract author/title ----\r\n  # sort by notice date before assigning id ----\r\n  arrange(notice_date) %>% \r\n  mutate(\r\n    # create id ----\r\n    id = row_number(),\r\n    # clean title until looks ok ----\r\n    title = str_remove(text, \" /.*\") %>% \r\n      str_remove(\"Wells.*\") %>%\r\n      str_remove(\" \\\\[.*\") %>% \r\n      str_remove(\": from.*\") %>% \r\n      str_remove(\"\\\\*\") %>%\r\n      str_remove(\"Nino\") %>% # affected api search ----\r\n      str_remove(\"American [Gg]irl.\") %>% # affected api search ----\r\n      str_trim(),\r\n    # clean author until looks ok ----\r\n    author = str_remove(text, \".* /\") %>% \r\n      str_remove(\"Sendak, Maurice\") %>% \r\n      str_remove(\" ; .*\") %>% \r\n      str_remove(\"\\\\[\") %>% \r\n      str_remove(\"\\\\]\") %>% \r\n      str_remove(\".* by \") %>%\r\n      str_remove(\".*! \") %>% \r\n      str_remove(\"and .*\") %>%\r\n      # remove everything after a period, but affected authors with first or middle initial ----\r\n      str_remove(\"\\\\..*\") %>% \r\n      str_remove(\"\\\\*\") %>% \r\n      str_remove_all(\"& Sue .*| an |book\") %>% \r\n      str_squish()\r\n  ) %>% \r\n  # remove non pre-k books (I mostly read on kindle) ----\r\n  dplyr::filter(!(title %in% c(\"Pax\", \"Luster\", \"Last night in Montreal : a novel\"))) %>% \r\n  # count number of books per emails ----\r\n  group_by(notice_date) %>% \r\n  add_count() %>% \r\n  ungroup()\r\n\r\n\r\n\r\n# view entries corresponding to email notice ----\r\nbooks %>% \r\n  filter(notice_date == \"2020-06-24\") %>% \r\n  dplyr::select(text, title, author) %>% \r\n  knitr::kable()\r\ntext\r\ntitle\r\nauthor\r\nMy trip to the science museum / by Mercer Mayer. Mayer, Mercer, 1943- call number:E FICTION MAYER copy:\r\nMy trip to the science museum\r\nMercer Mayer\r\nAmerican girl. Bitty Baby has a tea party / by Kirby Larson & Sue Cornelison. Larson, Kirby call number:E FICTION AMERICAN copy:\r\nBitty Baby has a tea party\r\nKirby Larson\r\nThe day the crayons quit / by Drew Daywalt ; pictures by Oliver Jeffers. Daywalt, Drew. call number:E FICTION DAYWALT copy:\r\nThe day the crayons quit\r\nDrew Daywalt\r\n\r\n3 {httr} query google books api\r\nI then got started with the Google Books API. Some key steps in this process included:\r\nExploring Google Books and doing some manual searches to get a feel for how it behaves and what it returns.\r\nIdentifying the format to get started with the API: https://www.googleapis.com/books/v1/{collectionName}/resourceID?parameters.\r\nUnderstanding the search terms permissible in the query (like inauthor and intitle): https://www.googleapis.com/books/v1/volumes?q=search+terms.\r\nObtaining an API key (google console developer -> enable google books api -> create credentials -> calling API from other non UI -> get API key). However, this ended up being unnecessary for the search I executed.\r\nThen I used the httr package to actually perform the query. First, I defined the url.\r\n\r\n\r\n# url base format ----\r\nurl <- \"https://www.googleapis.com/books/v1/volumes\"\r\n\r\nNext I created a wrapper function around httr::GET to allow for a search by title and author, or title alone.\r\n\r\n\r\nget_book <- function(this_title, this_author = NA){\r\n  httr::GET(\r\n    url = url,\r\n    query = list(\r\n      key = token, \r\n      q = ifelse(\r\n        is.na(this_author),\r\n        glue::glue('intitle:{this_title}'),\r\n        glue::glue('intitle:{this_title}+inauthor:{this_author}')\r\n        )))\r\n}\r\n\r\nI then performed an initial search with title and author. I learned that the API would error out with too many queries in quick succession, and I included Sys.sleep to slow down the search.\r\n\r\n\r\n# first search with title and author ----\r\n# create progress bar for mapping ----\r\np <- dplyr::progress_estimated(nrow(books))\r\nbooks_1 <- books %>%\r\n  mutate(book_info = purrr::map2(title, author,\r\n                                 function(x, y) {\r\n                                   # print progress bar ----\r\n                                   p$tick()$print()\r\n                                   # add in delay for api ----\r\n                                   Sys.sleep(1)\r\n                                   get_book(x, y)\r\n                                 }))\r\n\r\nFrom there, I checked the status code, extracted book content, and checked to see if any items were empty (which meant that no result was returned). In addition, more than one search result could have been returned; only the first was extracted.\r\n\r\n\r\nbooks_1_content <- books_1 %>%\r\n  mutate(\r\n    # extract status code: 200 = success ----\r\n    status_code = purrr::map_int(book_info, \"status_code\"),\r\n    # extract relevant content from author title search ----\r\n    book_items = purrr::map(book_info, ~ httr::content(.x)[[\"items\"]][[1]][[\"volumeInfo\"]]),\r\n    # check to see if items are empty ----\r\n    empty_items = purrr::map_lgl(book_items, rlang::is_empty)\r\n  )\r\n\r\nThe initial title and author search were all technically successful, though 10 searches results in empty items.\r\n\r\n\r\nbooks_1_content %>% count(status_code, empty_items)\r\n\r\n# A tibble: 2 x 3\r\n  status_code empty_items     n\r\n        <int> <lgl>       <int>\r\n1         200 FALSE         204\r\n2         200 TRUE           10\r\n\r\nFor these 10 items, I manually checked some with various searches on Google Books, and I noticed that some actually did have an entry, but did not have an author in that entry, so I repeated the search but with title only.\r\n\r\n\r\n# 10 books did not have a result with author title search ----\r\np <- dplyr::progress_estimated(nrow(books))\r\n# perform title search only ----\r\nbooks_2 <- books_1_content %>%\r\n  # keep only empty items for another search ----\r\n  filter(empty_items == TRUE) %>%\r\n  # keep original first six columns ----\r\n  select(1:6) %>%\r\n  mutate(book_info = purrr::map(title, \r\n                                function(x) {\r\n                                  p$tick()$print()\r\n                                  Sys.sleep(1)\r\n                                  get_book(x)\r\n                                }))\r\n\r\n\r\n\r\nbooks_2_content <- books_2 %>% \r\n  mutate(\r\n    # extract status code: 200 = success ----\r\n    status_code = purrr::map_int(book_info, \"status_code\"),\r\n    # extract relevant content from author only search ----  \r\n    book_items = purrr::map(book_info, ~ httr::content(.x)[[\"items\"]][[1]][[\"volumeInfo\"]]\r\n  ),\r\n  # check to see if items are empty ----  \r\n  empty_items = purrr::map_lgl(book_items, rlang::is_empty)\r\n)\r\n\r\nThese 10 items were all technically successful and contained result contents.\r\n\r\n\r\nbooks_2_content %>% count(status_code, empty_items)\r\n\r\n# A tibble: 1 x 3\r\n  status_code empty_items     n\r\n        <int> <lgl>       <int>\r\n1         200 FALSE          10\r\n\r\nIn these two searches, I created a nested tibble with two nested lists:\r\nbook_info is a very long list which contains the full result from the original query.\r\n\r\n\r\n# showing entry for a book in initial email notification ----\r\nbooks_1_content[[\"book_info\"]][[2]]\r\n\r\nResponse [https://www.googleapis.com/books/v1/volumes?key=AIzaSyCUqoG382nRpWFTT-3BKX-m_cB7UyfVTMw&q=intitle%3AMy%20trip%20to%20the%20science%20museum%2Binauthor%3AMercer%20Mayer]\r\n  Date: 2021-01-03 16:42\r\n  Status: 200\r\n  Content-Type: application/json; charset=UTF-8\r\n  Size: 6.14 kB\r\n{\r\n  \"kind\": \"books#volumes\",\r\n  \"totalItems\": 2,\r\n  \"items\": [\r\n    {\r\n      \"kind\": \"books#volume\",\r\n      \"id\": \"htdVvgAACAAJ\",\r\n      \"etag\": \"zxSYXCOb+ho\",\r\n      \"selfLink\": \"https://www.googleapis.com/books/v1/volumes/htdV...\r\n      \"volumeInfo\": {\r\n...\r\n\r\nbook_items contains into the specific bits of information I considered for extraction to augment book information.\r\n\r\n\r\n# showing entry for a book in initial email notification ----\r\nstr(books_1_content[[\"book_items\"]][[2]])\r\n\r\nList of 19\r\n $ title              : chr \"My Trip to the Science Museum\"\r\n $ authors            :List of 1\r\n  ..$ : chr \"Mercer Mayer\"\r\n $ publisher          : chr \"Little Critter\"\r\n $ publishedDate      : chr \"2017-03-07\"\r\n $ description        : chr \"For use in schools and libraries only. It's Science Day and Little Critter and his classmates are heading to th\"| __truncated__\r\n $ industryIdentifiers:List of 2\r\n  ..$ :List of 2\r\n  .. ..$ type      : chr \"ISBN_10\"\r\n  .. ..$ identifier: chr \"060639625X\"\r\n  ..$ :List of 2\r\n  .. ..$ type      : chr \"ISBN_13\"\r\n  .. ..$ identifier: chr \"9780606396257\"\r\n $ readingModes       :List of 2\r\n  ..$ text : logi FALSE\r\n  ..$ image: logi FALSE\r\n $ pageCount          : int 24\r\n $ printType          : chr \"BOOK\"\r\n $ categories         :List of 1\r\n  ..$ : chr \"Juvenile Fiction\"\r\n $ maturityRating     : chr \"NOT_MATURE\"\r\n $ allowAnonLogging   : logi FALSE\r\n $ contentVersion     : chr \"preview-1.0.0\"\r\n $ panelizationSummary:List of 2\r\n  ..$ containsEpubBubbles : logi FALSE\r\n  ..$ containsImageBubbles: logi FALSE\r\n $ imageLinks         :List of 2\r\n  ..$ smallThumbnail: chr \"http://books.google.com/books/content?id=htdVvgAACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\"\r\n  ..$ thumbnail     : chr \"http://books.google.com/books/content?id=htdVvgAACAAJ&printsec=frontcover&img=1&zoom=1&source=gbs_api\"\r\n $ language           : chr \"en\"\r\n $ previewLink        : chr \"http://books.google.com/books?id=htdVvgAACAAJ&dq=intitle:My+trip+to+the+science+museum%2Binauthor:Mercer+Mayer&\"| __truncated__\r\n $ infoLink           : chr \"http://books.google.com/books?id=htdVvgAACAAJ&dq=intitle:My+trip+to+the+science+museum%2Binauthor:Mercer+Mayer&\"| __truncated__\r\n $ canonicalVolumeLink: chr \"https://books.google.com/books/about/My_Trip_to_the_Science_Museum.html?hl=&id=htdVvgAACAAJ\"\r\n\r\n4 {purrrr} extract content from search results\r\nTo assemble the final data, I combined the results of the two searches and proceeded to extract information from book_info. A tricky part here was that not all API results returned the same information, and if the named item did not exist the entire mapping would fail. My solution was to check if the named element existed for extraction, and otherwise return NA. I also checked to see if there was a fuzzy match between the author I originally extracted from the emails versus the author that the Google Books API returned.\r\n\r\n\r\nbooks_all <- books_1_content %>%\r\n  # keep non-empty items from title author search ----\r\n  filter(empty_items == FALSE) %>%\r\n  # append results from title only search ---\r\n  bind_rows(books_2_content) %>%\r\n  # remove original api results ----\r\n  dplyr::select(-book_info) %>%\r\n  mutate(\r\n    # extract fields from api results ----\r\n    book_title = purrr::map_chr(book_items, ~ ifelse(\r\n      rlang::has_name(.x, \"title\"), .x[[\"title\"]], NA\r\n    )),\r\n    book_author = purrr::map_chr(book_items, ~ ifelse(\r\n      rlang::has_name(.x, \"authors\"), str_c(unlist(.x[[\"authors\"]]), collapse = \", \"),\r\n      NA\r\n    )),\r\n    book_publish_date = purrr::map_chr(book_items, ~ ifelse(\r\n      rlang::has_name(.x, \"publishedDate\"), .x[[\"publishedDate\"]], NA\r\n    )),\r\n    book_volume_link = purrr::map_chr(book_items, ~ ifelse(\r\n      rlang::has_name(.x, \"canonicalVolumeLink\"), .x[[\"canonicalVolumeLink\"]], NA\r\n    )),\r\n    book_image_link = purrr::map_chr(book_items, ~ ifelse(\r\n      rlang::has_name(.x, \"imageLinks\"), .x[[\"imageLinks\"]][[\"smallThumbnail\"]], NA\r\n    )),\r\n    # clean book publish date to year only ----\r\n    book_publish_year = str_sub(book_publish_date, start = 1, end = 4) %>% as.numeric(),\r\n    # check for fuzzy matching of author from email vs api result ----\r\n    author_fuzzy = purrr::map2(author, book_author, agrep),\r\n    # if result is 1, there is a fuzzy match; otherwise, not ----\r\n    author_match = purrr::map_lgl(author_fuzzy, ~ length(.x) > 0)\r\n  )\r\n\r\nIf the authors matched, I assumed a matching result was returned. For the 13 authors that did not match, I manually inspected entries for further cleaning.\r\n\r\n\r\nbooks_all %>% \r\n  filter(author_match == FALSE) %>% \r\n  # title, author from email; book_title, book_author from api ---\r\n  select(id, title, author, book_title, book_author) %>% \r\n  knitr::kable()\r\nid\r\ntitle\r\nauthor\r\nbook_title\r\nbook_author\r\n58\r\nSnow sisters!\r\nKerri Kokias, Teagan White\r\nSnow Sisters!\r\nKerri Kokias\r\n75\r\nSquare\r\nMac Barnett & Jon Klassen\r\nSquare\r\nMac Barnett\r\n109\r\nSpend it! : a moneybunny book\r\nCinders McLeod\r\nSpend It!\r\nNA\r\n179\r\nBack to school with the Berenstain Bears\r\nStan & Jan Berenstain\r\nBack to School with the Berenstain Bears\r\nStan Berenstain, Jan Berenstain\r\n15\r\nSplat the Cat and the quick chicks\r\nLaura Driscoll\r\nSplat the Cat and the Quick Chicks\r\nRob Scotton\r\n28\r\nRaindrop, plop!\r\nWendy Cheyette Lewison\r\nPlop the Raindrop\r\nKevin Alan Richards\r\n54\r\nDrawn together\r\nMinh Le\r\nDrawn Together\r\nLeah Pearlman\r\n89\r\nAll the world\r\nMarla Frazee\r\nAll the World Loves a Quarrel\r\nDaniel Wright Kittredge\r\n139\r\nChee-Kee : a panda in Bearland\r\nSujean Rim\r\nChee-Kee: A Panda in Bearland\r\nNA\r\n140\r\nBirdie’s happiest Halloween\r\nSujean Rim\r\nBirdie’s Happiest Halloween\r\nNA\r\n159\r\nCostume fun!\r\nWells, Rosemary\r\nCreative Homemade Halloween Costume Ideas - Fun, Unusual and Inexpensive\r\nM Osterhoudt\r\n203\r\nCorduroy’s Christmas surprise\r\nLisa McCue\r\nCorduroy’s Christmas Surprise\r\nDon Freeman\r\n211\r\nRudolph the Red-Nosed Reindeer\r\nAlan Benjamin\r\nRudolph the Red-Nosed Reindeer\r\nRobert L. May\r\n\r\nOf these 13 books, I determined that there were:\r\n3 instances where Google Books had missing author but the search result was a correct match\r\n5 instances where the authors did not fuzzy match, but the search result was a correct match\r\n5 instances with an incorrect match\r\nI finished cleaning the books data with this in mind, and also formatted fields to show the thumbnail images and convert titles to links.\r\n\r\n\r\nbooks_clean <- books_all %>%\r\n  #filter(author_match == TRUE) %>% \r\n  mutate(\r\n    # replace author as extracted from email ----\r\n    book_author = ifelse(is.na(book_author), author, book_author),\r\n    # replace author as extracted from email ----\r\n    book_author = case_when(\r\n       # correct result not available from api search ----\r\n       title %in% c(\"Raindrop, plop!\", \"Drawn together\", \"All the world\", \"Costume fun!\", \"Rudolph the Red-Nosed Reindeer\") ~ author,\r\n       TRUE ~ book_author\r\n     ),\r\n    # replace title as extracted from email ----\r\n     book_title = case_when(\r\n       # correct result not available on google books ----\r\n       title %in% c(\"Raindrop, plop!\", \"Drawn together\", \"All the world\", \"Costume fun!\", \"Rudolph the Red-Nosed Reindeer\") ~ title,\r\n       TRUE ~ book_title\r\n     ),\r\n    # make volume link missing ----\r\n     book_volume_link = case_when(\r\n       # correct result not available on google books ----\r\n        title %in% c(\"Raindrop, plop!\", \"Drawn together\", \"All the world\", \"Costume fun!\", \"Rudolph the Red-Nosed Reindeer\") ~ NA_character_,\r\n       TRUE ~ book_volume_link\r\n     ),\r\n     # make image link missing ----\r\n     book_image_link = case_when(\r\n       # correct result not available on google books ----\r\n      title %in% c(\"Raindrop, plop!\", \"Drawn together\", \"All the world\", \"Costume fun!\", \"Rudolph the Red-Nosed Reindeer\") ~ NA_character_,\r\n       TRUE ~ book_image_link\r\n     ),\r\n     # make year missing ----\r\n     book_publish_year = case_when(\r\n       title %in% c(\"Raindrop, plop!\", \"Drawn together\", \"All the world\", \"Costume fun!\", \"Rudolph the Red-Nosed Reindeer\") ~ NA_real_,\r\n       TRUE ~ book_publish_year\r\n     ),\r\n     # create html text strings for display in table ----\r\n     image_link_html = gt::web_image(url = book_image_link, height = 80),\r\n     title_link_html = ifelse(\r\n       is.na(book_volume_link),\r\n       # if link unavailable, print title with no link ----\r\n       book_title,\r\n       str_c(\"<a href='\", book_volume_link, \"' target='_blank'>\", book_title, \"<\/a>\")\r\n     )\r\n  ) %>% \r\n  arrange(id) %>% \r\n  # rename for table ---\r\n  dplyr::select(\r\n    ID = id,\r\n    Preview = image_link_html, \r\n    Title = title_link_html, \r\n    `Author(s)` = book_author, \r\n    `Published` = book_publish_year, \r\n    `Notification` = notice_date\r\n  ) \r\n\r\n5 {DT} present books in an interactive table\r\nFinally! Over the last 6 months, we read 214 amazing books. If you aren’t familiar with this type of table (I’m looking at you, Mom), note that this table is interactive. You can search for any word like “Carle” or “bear” in the search bar, change the number of entries shown, and sort by published date (for example) by using the light gray triangles in the header of the table.\r\n\r\n\r\nbooks_clean %>%\r\n  DT::datatable(\r\n    escape = FALSE,\r\n    rownames = FALSE,\r\n    options = list(\r\n      columnDefs = list(\r\n        list(className = 'dt-center', targets = c(1, 4, 5)),\r\n        list(className = 'dt-left', targets = c(2:3))\r\n      ),\r\n      pageLength = 15,\r\n      lengthMenu = seq(15, 225, by = 15)\r\n    )\r\n  )\r\n\r\n{\"x\":{\"filter\":\"none\",\"data\":[[1,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217],[\"<img src=\\\"http://books.google.com/books/content?id=0FZ8wAEACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=htdVvgAACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=NKOungEACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=fqbPqynM4UUC&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=fgtWtQAACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=sG2mDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=1FYeoAEACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=I9sGEAAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=OMJnGwAACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=5yUEAwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=GAqlDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"NA\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=12BDDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=Du_yCAAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=IC6zoAEACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=ARjDR5yFbRUC&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=W9ug8ld7XFcC&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=bJNzmQEACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=OXtczVGIKpwC&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=4r4MnwEACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=3XJ2mQEACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=NSliBAAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=Y57xAgAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=vSbbAAAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=-jM9DwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=sePbDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"NA\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=jIgkDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=2Y2oDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=A1FsDAAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=Q4qbCgAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=oOBwBgAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=tuovDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=6k6zDQAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=FiKNBwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=Oj_xCwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=EfXvywmVTEgC&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=Ur7pAgAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=SygaDQEACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=hX6zJAyQMzgC&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=wobB2AMKr0UC&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=rZFKDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=6SbhAAAAMAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=Fig3rgEACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=S6r9DwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=zs1vDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=BkM3DwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=34R5DwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=KfFvDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=F9ZhCAAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=00gTAgAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=VzFrvQEACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"NA\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=Z_f1DwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"NA\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=ijGXzQEACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=F5MoDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=8I6RDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=f42dDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=BOSgRVqWPCsC&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=5q2MrZimZo0C&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=F7ebAgAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=jMaGCgAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=n8yW9cVSP0sC&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=ZM_ADwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=v8fyDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=0mFzSxirgNEC&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=jgBiBQAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=_wNIpKOwT9UC&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=5aYE9xrdjqMC&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=iCDfCgAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=NbRnDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=WANAuAEACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=cEiGDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=F886BAAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=ucaGswEACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=ESbVVOQVbNAC&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=ekV6QwAACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=MLOEAAAACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=A0eb46P6N1UC&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=b0_eugEACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=vvbaDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=vhnbMgEACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=0w9GDQAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=pZUTkhlpP_4C&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=0F6fBQAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=834kNcgvxk4C&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"NA\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=QVUTAgAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"NA\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=dn7RDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=Qblk6xogACsC&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=AbLxAwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=H9KMDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=19chPwAACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=cgITvgAACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=YH7RDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=WdNGDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=XFmACZ1u7AwC&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=QWBuAAAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=lwTaDAAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=sa6HDQAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=P6HXBAAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=Xkt9CAAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=qHfLDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=jjGgDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=ohiyzQEACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=EX-MuAEACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=kCNyDAAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=tyuDDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=dks0swEACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=TLsrDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=HWcpBgAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=TPHB39OqtjYC&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=K8n3uAEACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=TcNWDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=NOAsDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=uUV-DwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=rMK9DwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=BDxOAwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=vxVHDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=IndwDQAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=Kp09XkgsyY4C&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=uJ18BgAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=cKPEZz7QWBAC&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=F38aNgAACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=NvOiDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=AhXPswEACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=QcG1oQEACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=diTZCwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=XZ2kBQAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=JIvYswEACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=0R1rAQAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=knKjSgAACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=wSvcDgAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=PcrZCwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=ESDXuwEACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=W3dODAAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=HFXkCgAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=FN1rvgAACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=6nxetgEACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=TbZvDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=bM_GDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=IPOiDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"NA\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=ij1qDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=9cjRDgAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=GmvYzQEACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=dks0swEACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=ixZmDAAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=QZmsyQEACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=70EdDgAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=eW1zBgAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=JmjIDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=_bThngEACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=WrKNHAAACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"NA\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=Tv05nwEACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=YGApDAAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=5qb84HnZSI8C&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=5QDnL98uYsIC&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=BSYaxAEACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=O972jgEACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=v9pgNwAACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=z09-tAEACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=oyianl-amxYC&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=hmyeDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=Tff1DwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=IXiny_lbpt4C&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=FFfBQjKnukQC&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=b8JrDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=uGVnjnoqWUEC&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=Rt1VQwAACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=Pz3PDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=9JdszQEACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=7PqVDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=hkF5DwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=4eYcDgAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=wHdQDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"NA\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=K1EWBAAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=jKDo5Q7hWfYC&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=efxZAAAAYAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=o1lGAwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=bA1GDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=hwdIDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=Wq6NDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=8kdUAwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=OC2BlwEACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=VqptDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=iNW5swEACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=HC1pDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=C6s7DAAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=cbQhAgAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=X1OVVunv_KoC&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=vD9wDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=6yQHkAEACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=EBjsmgEACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=Y6ysDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=MruoPgAACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=m0wNtAEACAAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=ceU2DwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=1dhzAwAAQBAJ&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=NPVLDAAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=Wl4zAWo31wMC&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=oH4tDwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=gG6KJJSz1B4C&printsec=frontcover&img=1&zoom=5&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"NA\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=FTA7DwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=dbw5jKCsvGcC&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=HHvMXVSrNu8C&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=pN1-DwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"NA\\\" style=\\\"height:80px;\\\">\",\"<img src=\\\"http://books.google.com/books/content?id=7VP6DwAAQBAJ&printsec=frontcover&img=1&zoom=5&edge=curl&source=gbs_api\\\" style=\\\"height:80px;\\\">\"],[\"<a href='https://books.google.com/books/about/How_to_Train_the_Perfect_Parents.html?hl=&id=0FZ8wAEACAAJ' target='_blank'>How to Train the Perfect Parents<\\/a>\",\"<a href='https://books.google.com/books/about/My_Trip_to_the_Science_Museum.html?hl=&id=htdVvgAACAAJ' target='_blank'>My Trip to the Science Museum<\\/a>\",\"<a href='https://books.google.com/books/about/Bitty_Baby_Has_a_Tea_Party.html?hl=&id=NKOungEACAAJ' target='_blank'>Bitty Baby Has a Tea Party<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=fqbPqynM4UUC' target='_blank'>The Day the Crayons Quit<\\/a>\",\"<a href='https://books.google.com/books/about/Harold_and_the_Purple_Crayon.html?hl=&id=fgtWtQAACAAJ' target='_blank'>Harold and the Purple Crayon<\\/a>\",\"<a href='https://books.google.com/books/about/Llama_Llama_Mess_Mess_Mess.html?hl=&id=sG2mDwAAQBAJ' target='_blank'>Llama Llama Mess Mess Mess<\\/a>\",\"<a href='https://books.google.com/books/about/Bitty_Baby_Shares_a_Gift.html?hl=&id=1FYeoAEACAAJ' target='_blank'>Bitty Baby Shares a Gift<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=I9sGEAAAQBAJ' target='_blank'>A Picture for Harold's Room<\\/a>\",\"<a href='https://books.google.com/books/about/Harold_s_Fairy_Tale.html?hl=&id=OMJnGwAACAAJ' target='_blank'>Harold's Fairy Tale<\\/a>\",\"<a href='https://books.google.com/books/about/If_Animals_Kissed_Good_Night.html?hl=&id=5yUEAwAAQBAJ' target='_blank'>If Animals Kissed Good Night<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=GAqlDwAAQBAJ' target='_blank'>Ruby Finds a Worry<\\/a>\",\"<a href='https://books.google.com/books/about/Harold_s_circus_an_astounding_colossal_p.html?hl=&id=eLa2zQEACAAJ' target='_blank'>Harold's circus: an astounding, colossal purple crayon event!.<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=12BDDwAAQBAJ' target='_blank'>Splat the Cat Gets a Job!<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=Du_yCAAAQBAJ' target='_blank'>Splat the Cat and the Quick Chicks<\\/a>\",\"<a href='https://books.google.com/books/about/Waiting_Is_Not_Easy_An_Elephant_and_Pigg.html?hl=&id=IC6zoAEACAAJ' target='_blank'>Waiting Is Not Easy! (An Elephant and Piggie Book)<\\/a>\",\"<a href='https://books.google.com/books/about/This_is_Not_My_Hat.html?hl=&id=ARjDR5yFbRUC' target='_blank'>This is Not My Hat<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=W9ug8ld7XFcC' target='_blank'>Monkey and Me<\\/a>\",\"<a href='https://books.google.com/books/about/Bitty_Baby_the_Brave.html?hl=&id=bJNzmQEACAAJ' target='_blank'>Bitty Baby the Brave<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=OXtczVGIKpwC' target='_blank'>Millie Fierce<\\/a>\",\"<a href='https://books.google.com/books/about/The_Berenstain_Bears_Valentine_Love_Bug.html?hl=&id=4r4MnwEACAAJ' target='_blank'>The Berenstain Bears' Valentine Love Bug<\\/a>\",\"<a href='https://books.google.com/books/about/Princess_Bitty_Baby.html?hl=&id=3XJ2mQEACAAJ' target='_blank'>Princess Bitty Baby<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=NSliBAAAQBAJ' target='_blank'>The Watermelon Seed<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=Y57xAgAAQBAJ' target='_blank'>Whistle for Willie<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=vSbbAAAAQBAJ' target='_blank'>Sparky!<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=-jM9DwAAQBAJ' target='_blank'>How Rocket Learned to Read: Read & Listen Edition<\\/a>\",\"<a href='https://books.google.com/books/about/I_Love_Dad_with_the_Very_Hungry_Caterpil.html?hl=&id=sePbDwAAQBAJ' target='_blank'>I Love Dad with the Very Hungry Caterpillar<\\/a>\",\"Raindrop, plop!\",\"<a href='https://play.google.com/store/books/details?id=jIgkDwAAQBAJ' target='_blank'>The Rabbit Listened<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=2Y2oDwAAQBAJ' target='_blank'>Five Minutes<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=A1FsDAAAQBAJ' target='_blank'>I Love You Because You're You (A StoryPlay Book)<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=Q4qbCgAAQBAJ' target='_blank'>The Reading Teacher's Book of Lists<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=oOBwBgAAQBAJ' target='_blank'>I Wish You More<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=tuovDwAAQBAJ' target='_blank'>Hello Lighthouse<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=6k6zDQAAQBAJ' target='_blank'>Wolf in the Snow<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=FiKNBwAAQBAJ' target='_blank'>Finding Winnie<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=Oj_xCwAAQBAJ' target='_blank'>There Is a Tribe of Kids<\\/a>\",\"<a href='https://books.google.com/books/about/Black_Dog.html?hl=&id=EfXvywmVTEgC' target='_blank'>Black Dog<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=Ur7pAgAAQBAJ' target='_blank'>The Adventures of the Dish and the Spoon<\\/a>\",\"<a href='https://books.google.com/books/about/Little_Mouse_s_Big_Book_of_Fears.html?hl=&id=SygaDQEACAAJ' target='_blank'>Little Mouse's Big Book of Fears<\\/a>\",\"<a href='https://books.google.com/books/about/Each_Peach_Pear_Plum.html?hl=&id=hX6zJAyQMzgC' target='_blank'>Each Peach Pear Plum<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=wobB2AMKr0UC' target='_blank'>The Wind Blew<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=rZFKDwAAQBAJ' target='_blank'>Thank You, Omu!<\\/a>\",\"<a href='https://books.google.com/books/about/Pumpkin_Soup.html?hl=&id=6SbhAAAAMAAJ' target='_blank'>Pumpkin Soup<\\/a>\",\"<a href='https://books.google.com/books/about/One_Gorilla_A_Counting_Book.html?hl=&id=Fig3rgEACAAJ' target='_blank'>One Gorilla: A Counting Book<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=S6r9DwAAQBAJ' target='_blank'>The Stuff of Stars<\\/a>\",\"<a href='https://books.google.com/books/about/Where_Do_Diggers_Sleep_at_Night.html?hl=&id=zs1vDwAAQBAJ' target='_blank'>Where Do Diggers Sleep at Night?<\\/a>\",\"<a href='https://books.google.com/books/about/Bunny_Roo_I_Love_You.html?hl=&id=BkM3DwAAQBAJ' target='_blank'>Bunny Roo, I Love You<\\/a>\",\"<a href='https://books.google.com/books/about/What_s_Your_Favorite_Bug.html?hl=&id=34R5DwAAQBAJ' target='_blank'>What's Your Favorite Bug?<\\/a>\",\"<a href='https://books.google.com/books/about/Use_Your_Words_Sophie.html?hl=&id=KfFvDwAAQBAJ' target='_blank'>Use Your Words, Sophie<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=F9ZhCAAAQBAJ' target='_blank'>The Hueys in What's The Opposite?<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=00gTAgAAQBAJ' target='_blank'>The Pout-Pout Fish<\\/a>\",\"<a href='https://books.google.com/books/about/Julian_Is_a_Mermaid.html?hl=&id=VzFrvQEACAAJ' target='_blank'>Julian Is a Mermaid<\\/a>\",\"Drawn together\",\"<a href='https://books.google.com/books/about/Inky_s_Amazing_Escape.html?hl=&id=Z_f1DwAAQBAJ' target='_blank'>Inky's Amazing Escape<\\/a>\",\"<a href='https://books.google.com/books/about/The_Word_Collector.html?hl=&id=amRHyQEACAAJ' target='_blank'>The Word Collector<\\/a>\",\"<a href='https://books.google.com/books/about/I_Can_Handle_It_2.html?hl=&id=ijGXzQEACAAJ' target='_blank'>I Can Handle It 2<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=F5MoDwAAQBAJ' target='_blank'>Snow Sisters!<\\/a>\",\"<a href='https://books.google.com/books/about/Up_Up_Up_Down.html?hl=&id=8I6RDwAAQBAJ' target='_blank'>Up, Up, Up, Down!<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=f42dDwAAQBAJ' target='_blank'>One Shoe Two Shoes<\\/a>\",\"<a href='https://books.google.com/books/about/Journey.html?hl=&id=BOSgRVqWPCsC' target='_blank'>Journey<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=5q2MrZimZo0C' target='_blank'>Wake Up, Sun!<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=F7ebAgAAQBAJ' target='_blank'>Hooray for Hat!<\\/a>\",\"<a href='https://books.google.com/books/about/Counting_Kisses.html?hl=&id=jMaGCgAAQBAJ' target='_blank'>Counting Kisses<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=n8yW9cVSP0sC' target='_blank'>The Curious Garden<\\/a>\",\"<a href='https://books.google.com/books/about/Another.html?hl=&id=ZM_ADwAAQBAJ' target='_blank'>Another<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=v8fyDwAAQBAJ' target='_blank'>Peekaboo Morning<\\/a>\",\"<a href='https://books.google.com/books/about/Sometimes_I_Like_to_Curl_Up_in_a_Ball.html?hl=&id=0mFzSxirgNEC' target='_blank'>Sometimes I Like to Curl Up in a Ball<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=jgBiBQAAQBAJ' target='_blank'>Up in the Garden and Down in the Dirt<\\/a>\",\"<a href='https://books.google.com/books/about/Bear_Snores_on.html?hl=&id=_wNIpKOwT9UC' target='_blank'>Bear Snores on<\\/a>\",\"<a href='https://books.google.com/books/about/Scaredy_Squirrel_at_the_Beach.html?hl=&id=5aYE9xrdjqMC' target='_blank'>Scaredy Squirrel at the Beach<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=iCDfCgAAQBAJ' target='_blank'>Old MacDonald Had a Truck<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=NbRnDwAAQBAJ' target='_blank'>Pete the Cat and the Itsy Bitsy Spider<\\/a>\",\"<a href='https://books.google.com/books/about/Don_t_Let_the_Pigeon_Drive_the_Bus.html?hl=&id=WANAuAEACAAJ' target='_blank'>Don't Let the Pigeon Drive the Bus!<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=cEiGDwAAQBAJ' target='_blank'>Square<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=F886BAAAQBAJ' target='_blank'>Once Upon an Alphabet<\\/a>\",\"<a href='https://books.google.com/books/about/Bear_s_Story.html?hl=&id=ucaGswEACAAJ' target='_blank'>Bear's Story<\\/a>\",\"<a href='https://books.google.com/books/about/Clouds.html?hl=&id=ESbVVOQVbNAC' target='_blank'>Clouds<\\/a>\",\"<a href='https://books.google.com/books/about/The_Big_Dipper.html?hl=&id=ekV6QwAACAAJ' target='_blank'>The Big Dipper<\\/a>\",\"<a href='https://books.google.com/books/about/Hello_Toes_Hello_Feet.html?hl=&id=MLOEAAAACAAJ' target='_blank'>Hello Toes! Hello Feet!<\\/a>\",\"<a href='https://books.google.com/books/about/Aliens_in_Underpants_Save_the_World.html?hl=&id=A0eb46P6N1UC' target='_blank'>Aliens in Underpants Save the World<\\/a>\",\"<a href='https://books.google.com/books/about/I_Want_to_Be_an_Astronaut.html?hl=&id=b0_eugEACAAJ' target='_blank'>I Want to Be an Astronaut<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=vvbaDwAAQBAJ' target='_blank'>Everyone Poops<\\/a>\",\"<a href='https://books.google.com/books/about/Monsters_Love_Colours.html?hl=&id=vhnbMgEACAAJ' target='_blank'>Monsters Love Colours<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=0w9GDQAAQBAJ' target='_blank'>I Want My Hat Back<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=pZUTkhlpP_4C' target='_blank'>Stuck<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=0F6fBQAAQBAJ' target='_blank'>My Bike<\\/a>\",\"<a href='https://books.google.com/books/about/Bear_Feels_Sick.html?hl=&id=834kNcgvxk4C' target='_blank'>Bear Feels Sick<\\/a>\",\"All the world\",\"<a href='https://play.google.com/store/books/details?id=QVUTAgAAQBAJ' target='_blank'>Niño Wrestles the World<\\/a>\",\"<a href='https://books.google.com/books/about/What_Sisters_Do_Best_What_Brothers_Do_Be.html?hl=&id=TsdcPgAACAAJ' target='_blank'>What Sisters Do Best/What Brothers Do Best<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=dn7RDwAAQBAJ' target='_blank'>Small in the City<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=Qblk6xogACsC' target='_blank'>Frog and Toad Are Friends<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=AbLxAwAAQBAJ' target='_blank'>Horton Hears a Who!<\\/a>\",\"<a href='https://books.google.com/books/about/Calm_with_the_Very_Hungry_Caterpillar.html?hl=&id=H9KMDwAAQBAJ' target='_blank'>Calm with the Very Hungry Caterpillar<\\/a>\",\"<a href='https://books.google.com/books/about/We_re_Going_on_a_Bear_Hunt.html?hl=&id=19chPwAACAAJ' target='_blank'>We're Going on a Bear Hunt<\\/a>\",\"<a href='https://books.google.com/books/about/A_Band_of_Babies.html?hl=&id=cgITvgAACAAJ' target='_blank'>A Band of Babies<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=YH7RDwAAQBAJ' target='_blank'>Hey, Water!<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=WdNGDwAAQBAJ' target='_blank'>The Enormous Crocodile<\\/a>\",\"<a href='https://books.google.com/books/about/Little_Quack_s_Hide_and_Seek.html?hl=&id=XFmACZ1u7AwC' target='_blank'>Little Quack's Hide and Seek<\\/a>\",\"<a href='https://books.google.com/books/about/A_Seed_Is_Sleepy.html?hl=&id=QWBuAAAAQBAJ' target='_blank'>A Seed Is Sleepy<\\/a>\",\"<a href='https://books.google.com/books/about/Lucy_and_Company.html?hl=&id=lwTaDAAAQBAJ' target='_blank'>Lucy and Company<\\/a>\",\"<a href='https://books.google.com/books/about/This_Is_How_We_Do_It.html?hl=&id=sa6HDQAAQBAJ' target='_blank'>This Is How We Do It<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=P6HXBAAAQBAJ' target='_blank'>Red<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=Xkt9CAAAQBAJ' target='_blank'>Freight Train<\\/a>\",\"<a href='https://books.google.com/books/about/Glad_Glad_Bear.html?hl=&id=qHfLDwAAQBAJ' target='_blank'>Glad, Glad Bear!<\\/a>\",\"<a href='https://books.google.com/books/about/Hair_Love.html?hl=&id=jjGgDwAAQBAJ' target='_blank'>Hair Love<\\/a>\",\"<a href='https://books.google.com/books/about/Prince_and_Knight.html?hl=&id=ohiyzQEACAAJ' target='_blank'>Prince and Knight<\\/a>\",\"<a href='https://books.google.com/books/about/Spend_It.html?hl=&id=EX-MuAEACAAJ' target='_blank'>Spend It!<\\/a>\",\"<a href='https://books.google.com/books/about/The_Not_So_Quiet_Library.html?hl=&id=kCNyDAAAQBAJ' target='_blank'>The Not So Quiet Library<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=tyuDDwAAQBAJ' target='_blank'>Who Wet My Pants?<\\/a>\",\"<a href='https://books.google.com/books/about/The_Gruffalo_s_Child.html?hl=&id=dks0swEACAAJ' target='_blank'>The Gruffalo's Child<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=TLsrDwAAQBAJ' target='_blank'>I am Actually a Penguin<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=HWcpBgAAQBAJ' target='_blank'>Zen Shorts<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=TPHB39OqtjYC' target='_blank'>Birdie's Big-Girl Dress<\\/a>\",\"<a href='https://books.google.com/books/about/Otto_and_Pio.html?hl=&id=K8n3uAEACAAJ' target='_blank'>Otto and Pio<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=TcNWDwAAQBAJ' target='_blank'>Mad, Mad Bear!<\\/a>\",\"<a href='https://books.google.com/books/about/Earn_It.html?hl=&id=NOAsDwAAQBAJ' target='_blank'>Earn It!<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=uUV-DwAAQBAJ' target='_blank'>Save It!<\\/a>\",\"<a href='https://books.google.com/books/about/Where_Is_the_Sun.html?hl=&id=rMK9DwAAQBAJ' target='_blank'>Where Is the Sun?<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=BDxOAwAAQBAJ' target='_blank'>I Got the Rhythm<\\/a>\",\"<a href='https://books.google.com/books/about/Goodnight_Numbers.html?hl=&id=vxVHDwAAQBAJ' target='_blank'>Goodnight, Numbers<\\/a>\",\"<a href='https://books.google.com/books/about/Princess_Tales_Around_the_World.html?hl=&id=IndwDQAAQBAJ' target='_blank'>Princess Tales Around the World<\\/a>\",\"<a href='https://books.google.com/books/about/Emily_s_Balloon.html?hl=&id=Kp09XkgsyY4C' target='_blank'>Emily's Balloon<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=uJ18BgAAQBAJ' target='_blank'>Hoot Owl, Master of Disguise<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=cKPEZz7QWBAC' target='_blank'>Little Pea<\\/a>\",\"<a href='https://books.google.com/books/about/I_Like_Bugs.html?hl=&id=F38aNgAACAAJ' target='_blank'>I Like Bugs<\\/a>\",\"<a href='https://books.google.com/books/about/If_I_Built_a_House.html?hl=&id=NvOiDwAAQBAJ' target='_blank'>If I Built a House<\\/a>\",\"<a href='https://books.google.com/books/about/Elephant_Piggie_Like_Reading_The_Itchy_B.html?hl=&id=AhXPswEACAAJ' target='_blank'>Elephant & Piggie Like Reading! - The Itchy Book!<\\/a>\",\"<a href='https://books.google.com/books/about/I_Will_Take_A_Nap_An_Elephant_and_Piggie.html?hl=&id=QcG1oQEACAAJ' target='_blank'>I Will Take A Nap! (An Elephant and Piggie Book)<\\/a>\",\"<a href='https://books.google.com/books/about/Ten_Kisses_for_Sophie.html?hl=&id=diTZCwAAQBAJ' target='_blank'>Ten Kisses for Sophie!<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=XZ2kBQAAQBAJ' target='_blank'>This Moose Belongs to Me<\\/a>\",\"<a href='https://books.google.com/books/about/Because.html?hl=&id=JIvYswEACAAJ' target='_blank'>Because<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=0R1rAQAAQBAJ' target='_blank'>The Hueys in None The Number<\\/a>\",\"<a href='https://books.google.com/books/about/Kindergators_Hands_Off_Harry.html?hl=&id=knKjSgAACAAJ' target='_blank'>Kindergators: Hands Off, Harry!<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=wSvcDgAAQBAJ' target='_blank'>Here We Are<\\/a>\",\"<a href='https://books.google.com/books/about/Another_Monster_at_the_End_of_This_Book.html?hl=&id=PcrZCwAAQBAJ' target='_blank'>Another Monster at the End of This Book<\\/a>\",\"<a href='https://books.google.com/books/about/Sleep_My_Bunny.html?hl=&id=ESDXuwEACAAJ' target='_blank'>Sleep, My Bunny<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=W3dODAAAQBAJ' target='_blank'>Chee-Kee: A Panda in Bearland<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=HFXkCgAAQBAJ' target='_blank'>Birdie's Happiest Halloween<\\/a>\",\"<a href='https://books.google.com/books/about/The_Scariest_Book_Ever.html?hl=&id=FN1rvgAACAAJ' target='_blank'>The Scariest Book Ever<\\/a>\",\"<a href='https://books.google.com/books/about/Unicorn_Is_Maybe_Not_So_Great_After_All.html?hl=&id=6nxetgEACAAJ' target='_blank'>Unicorn Is Maybe Not So Great After All<\\/a>\",\"<a href='https://books.google.com/books/about/Sam_Dave_Dig_a_Hole.html?hl=&id=TbZvDwAAQBAJ' target='_blank'>Sam & Dave Dig a Hole<\\/a>\",\"<a href='https://books.google.com/books/about/Don_t_Blink.html?hl=&id=bM_GDwAAQBAJ' target='_blank'>Don't Blink!<\\/a>\",\"<a href='https://books.google.com/books/about/If_I_Built_a_School.html?hl=&id=IPOiDwAAQBAJ' target='_blank'>If I Built a School<\\/a>\",\"<a href='https://books.google.com/books/about/Wait_Wait.html?hl=&id=z_3SMgEACAAJ' target='_blank'>Wait! Wait!<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=ij1qDwAAQBAJ' target='_blank'>Mouse Loves Love<\\/a>\",\"<a href='https://books.google.com/books/about/I_Want_to_Be_in_a_Scary_Story.html?hl=&id=9cjRDgAAQBAJ' target='_blank'>I Want to Be in a Scary Story<\\/a>\",\"<a href='https://books.google.com/books/about/What_the_Ladybird_Heard.html?hl=&id=GmvYzQEACAAJ' target='_blank'>What the Ladybird Heard<\\/a>\",\"<a href='https://books.google.com/books/about/The_Gruffalo_s_Child.html?hl=&id=dks0swEACAAJ' target='_blank'>The Gruffalo's Child<\\/a>\",\"<a href='https://books.google.com/books/about/We_Found_a_Hat.html?hl=&id=ixZmDAAAQBAJ' target='_blank'>We Found a Hat<\\/a>\",\"<a href='https://books.google.com/books/about/Animalphabet.html?hl=&id=QZmsyQEACAAJ' target='_blank'>Animalphabet<\\/a>\",\"<a href='https://books.google.com/books/about/Say_Hello_Sophie.html?hl=&id=70EdDgAAQBAJ' target='_blank'>Say Hello, Sophie!<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=eW1zBgAAQBAJ' target='_blank'>Friendshape<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=JmjIDwAAQBAJ' target='_blank'>Plant a Kiss<\\/a>\",\"<a href='https://books.google.com/books/about/Where_s_My_Mummy.html?hl=&id=_bThngEACAAJ' target='_blank'>Where's My Mummy?<\\/a>\",\"<a href='https://books.google.com/books/about/Ten_Timid_Ghosts.html?hl=&id=WrKNHAAACAAJ' target='_blank'>Ten Timid Ghosts<\\/a>\",\"Costume fun!\",\"<a href='https://books.google.com/books/about/We_re_Going_on_a_Ghost_Hunt.html?hl=&id=Tv05nwEACAAJ' target='_blank'>We're Going on a Ghost Hunt<\\/a>\",\"<a href='https://books.google.com/books/about/Little_Boo.html?hl=&id=YGApDAAAQBAJ' target='_blank'>Little Boo<\\/a>\",\"<a href='https://books.google.com/books/about/Room_on_the_Broom.html?hl=&id=5qb84HnZSI8C' target='_blank'>Room on the Broom<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=5QDnL98uYsIC' target='_blank'>Bad Kitty Meets the Baby<\\/a>\",\"<a href='https://books.google.com/books/about/Little_Critter_Just_Storybook_Favorites.html?hl=&id=BSYaxAEACAAJ' target='_blank'>Little Critter: Just Storybook Favorites<\\/a>\",\"<a href='https://books.google.com/books/about/Wonderfall.html?hl=&id=O972jgEACAAJ' target='_blank'>Wonderfall<\\/a>\",\"<a href='https://books.google.com/books/about/It_s_Pumpkin_Time.html?hl=&id=v9pgNwAACAAJ' target='_blank'>It's Pumpkin Time!<\\/a>\",\"<a href='https://books.google.com/books/about/Apple_Farmer_Annie.html?hl=&id=z09-tAEACAAJ' target='_blank'>Apple Farmer Annie<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=oyianl-amxYC' target='_blank'>Duck & Goose, Find a Pumpkin<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=hmyeDwAAQBAJ' target='_blank'>Bad Kitty Does Not Like Thanksgiving<\\/a>\",\"<a href='https://books.google.com/books/about/Bear_Says_Thanks.html?hl=&id=Tff1DwAAQBAJ' target='_blank'>Bear Says Thanks<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=IXiny_lbpt4C' target='_blank'>Those Darn Squirrels Fly South<\\/a>\",\"<a href='https://books.google.com/books/about/Red_Leaf_Yellow_Leaf.html?hl=&id=FFfBQjKnukQC' target='_blank'>Red Leaf, Yellow Leaf<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=b8JrDwAAQBAJ' target='_blank'>There Was An Old Astronaut Who Swallowed the Moon!<\\/a>\",\"<a href='https://books.google.com/books/about/This_Is_the_Turkey.html?hl=&id=uGVnjnoqWUEC' target='_blank'>This Is the Turkey<\\/a>\",\"<a href='https://books.google.com/books/about/Skeleton_Hiccups.html?hl=&id=Rt1VQwAACAAJ' target='_blank'>Skeleton Hiccups<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=Pz3PDwAAQBAJ' target='_blank'>Grumpy Monkey Up All Night<\\/a>\",\"<a href='https://books.google.com/books/about/The_Berenstain_Bears_Big_Family_Album.html?hl=&id=9JdszQEACAAJ' target='_blank'>The Berenstain Bears' Big Family Album<\\/a>\",\"<a href='https://books.google.com/books/about/Back_to_School_with_the_Berenstain_Bears.html?hl=&id=7PqVDwAAQBAJ' target='_blank'>Back to School with the Berenstain Bears<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=hkF5DwAAQBAJ' target='_blank'>Uni the Unicorn Uni's First Sleepover<\\/a>\",\"<a href='https://books.google.com/books/about/There_s_a_Monster_in_Your_Book.html?hl=&id=4eYcDgAAQBAJ' target='_blank'>There's a Monster in Your Book<\\/a>\",\"<a href='https://books.google.com/books/about/Hello_Fall.html?hl=&id=wHdQDwAAQBAJ' target='_blank'>Hello, Fall!<\\/a>\",\"<a href='https://books.google.com/books/about/Listen_to_My_Trumpet.html?hl=&id=f-9fzQEACAAJ' target='_blank'>Listen to My Trumpet!<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=K1EWBAAAQBAJ' target='_blank'>Marty Farty<\\/a>\",\"<a href='https://books.google.com/books/about/Harold_and_the_Purple_Crayon_Dinosaur_Da.html?hl=&id=jKDo5Q7hWfYC' target='_blank'>Harold and the Purple Crayon: Dinosaur Days<\\/a>\",\"<a href='https://books.google.com/books/about/Alligators_all_around_an_alphabet.html?hl=&id=efxZAAAAYAAJ' target='_blank'>Alligators all around; an alphabet<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=o1lGAwAAQBAJ' target='_blank'>The Pout-Pout Fish Goes to School<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=bA1GDwAAQBAJ' target='_blank'>Three Grumpy Trucks<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=hwdIDwAAQBAJ' target='_blank'>The Snowy Nap<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=Wq6NDwAAQBAJ' target='_blank'>Mr. Nogginbody Gets a Hammer<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=8kdUAwAAQBAJ' target='_blank'>Pinkalicious: Fairy House<\\/a>\",\"<a href='https://books.google.com/books/about/The_Berenstain_Bears_Night_Before_Christ.html?hl=&id=OC2BlwEACAAJ' target='_blank'>The Berenstain Bears' Night Before Christmas<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=VqptDwAAQBAJ' target='_blank'>Meet the Latkes<\\/a>\",\"<a href='https://books.google.com/books/about/Last_Stop_on_the_Reindeer_Express.html?hl=&id=iNW5swEACAAJ' target='_blank'>Last Stop on the Reindeer Express<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=HC1pDwAAQBAJ' target='_blank'>A Unicorn Named Sparkle's First Christmas<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=C6s7DAAAQBAJ' target='_blank'>It's Christmas, David!<\\/a>\",\"<a href='https://books.google.com/books/about/Bear_Stays_Up_for_Christmas.html?hl=&id=cbQhAgAAQBAJ' target='_blank'>Bear Stays Up for Christmas<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=X1OVVunv_KoC' target='_blank'>Snowmen At Christmas<\\/a>\",\"<a href='https://books.google.com/books/about/Llama_Llama_Holiday_Drama.html?hl=&id=vD9wDwAAQBAJ' target='_blank'>Llama Llama Holiday Drama<\\/a>\",\"<a href='https://books.google.com/books/about/Dream_Snow.html?hl=&id=6yQHkAEACAAJ' target='_blank'>Dream Snow<\\/a>\",\"<a href='https://books.google.com/books/about/Princess_Buttercup.html?hl=&id=EBjsmgEACAAJ' target='_blank'>Princess Buttercup<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=Y6ysDwAAQBAJ' target='_blank'>Pinkalicious and the Pinkadorable Pony<\\/a>\",\"<a href='https://books.google.com/books/about/Corduroy_s_Christmas_Surprise.html?hl=&id=MruoPgAACAAJ' target='_blank'>Corduroy's Christmas Surprise<\\/a>\",\"<a href='https://books.google.com/books/about/Biscuit_s_Christmas_Storybook_Collection.html?hl=&id=m0wNtAEACAAJ' target='_blank'>Biscuit's Christmas Storybook Collection (2nd Edition)<\\/a>\",\"<a href='https://books.google.com/books/about/The_Not_Very_Merry_Pout_Pout_Fish.html?hl=&id=ceU2DwAAQBAJ' target='_blank'>The Not Very Merry Pout-Pout Fish<\\/a>\",\"<a href='https://books.google.com/books/about/Pete_the_Cat_Saves_Christmas.html?hl=&id=1dhzAwAAQBAJ' target='_blank'>Pete the Cat Saves Christmas<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=NPVLDAAAQBAJ' target='_blank'>The Little Reindeer<\\/a>\",\"<a href='https://books.google.com/books/about/Olive_the_Other_Reindeer.html?hl=&id=Wl4zAWo31wMC' target='_blank'>Olive, the Other Reindeer<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=oH4tDwAAQBAJ' target='_blank'>The Naughtiest Reindeer Takes a Bow<\\/a>\",\"<a href='https://books.google.com/books/about/Walt_Disney_s_Babes_In_Toyland.html?hl=&id=gG6KJJSz1B4C' target='_blank'>Walt Disney's Babes In Toyland<\\/a>\",\"Rudolph the Red-Nosed Reindeer\",\"<a href='https://books.google.com/books/about/Pick_a_Pine_Tree.html?hl=&id=FTA7DwAAQBAJ' target='_blank'>Pick a Pine Tree<\\/a>\",\"<a href='https://books.google.com/books/about/The_Stars_Will_Still_Shine.html?hl=&id=dbw5jKCsvGcC' target='_blank'>The Stars Will Still Shine<\\/a>\",\"<a href='https://books.google.com/books/about/Squirrel_s_New_Year_s_Resolution.html?hl=&id=HHvMXVSrNu8C' target='_blank'>Squirrel's New Year's Resolution<\\/a>\",\"<a href='https://play.google.com/store/books/details?id=pN1-DwAAQBAJ' target='_blank'>Good Night, Little Blue Truck<\\/a>\",\"<a href='https://books.google.com/books/about/The_Mitten.html?hl=&id=DtgTAAAACAAJ' target='_blank'>The Mitten<\\/a>\",\"<a href='https://books.google.com/books/about/Red_Sled.html?hl=&id=7VP6DwAAQBAJ' target='_blank'>Red Sled<\\/a>\"],[\"Rebecca Ashdown\",\"Mercer Mayer\",\"Kirby Larson\",\"Drew Daywalt\",\"Crockett Johnson\",\"Anna Dewdney, Reed Duncan\",\"Kirby Larson\",\"Crockett Johnson\",\"Crockett Johnson\",\"Ann Whitford Paul\",\"Tom Percival\",\"Crockett Johnson\",\"Rob Scotton\",\"Rob Scotton\",\"Mo Willems\",\"Jon Klassen\",\"Emily Gravett\",\"Kirby Larson, Sue Cornelison\",\"Jane Manning\",\"Mike Berenstain\",\"Kirby Larson, Sue Cornelison\",\"Greg Pizzoli\",\"Ezra Jack Keats\",\"Jenny Offill\",\"Tad Hills\",\"Eric Carle\",\"Wendy Cheyette Lewison\",\"Cori Doerrfeld\",\"Audrey Vernick, Liz Garton Scanlon\",\"Liza Baker\",\"Jacqueline E. Kress, Edward B. Fry\",\"Amy Krouse Rosenthal\",\"Sophie Blackall\",\"Matthew Cordell\",\"Lindsay Mattick\",\"Lane Smith\",\"Levi Pinfold\",\"Mini Grey\",\"Emily Gravett\",\"Allan Ahlberg, Janet Ahlberg\",\"Pat Hutchins\",\"Oge Mora\",\"Helen Cooper\",\"Anthony Browne\",\"Marion Dane Bauer\",\"Brianna Caplan Sayres\",\"Melissa Marr\",\"Eric Carle\",\"Rosemary Wells\",\"Oliver Jeffers\",\"Deborah Diesen\",\"Jessica Love, Jessica Love Jessica\",\"Minh Le\",\"Sy Montgomery\",\"Peter Hamilton Reynolds\",\"Laurie Wright\",\"Kerri Kokias\",\"Kimberly Gee\",\"Caryl Hart\",\"Aaron Becker\",\"David L. Harrison\",\"Brian Won\",\"Karen Katz\",\"Peter Brown\",\"Christian Robinson\",\"Rachel Isadora\",\"Vicki Churchill\",\"Kate Messner\",\"Karma Wilson\",\"Melanie Watt\",\"Steve Goetz\",\"James Dean, Kimberly Dean\",\"Mo Willems\",\"Mac Barnett\",\"Oliver Jeffers\",\"Claire Freedman\",\"Anne Rockwell, Frane Lessac\",\"Franklyn Mansfield Branley\",\"Ann Whitford Paul\",\"Claire Freedman\",\"Byron Barton\",\"Taro Gomi\",\"Mike Austin\",\"Jon Klassen\",\"Oliver Jeffers\",\"Byron Barton\",\"Karma Wilson\",\"Marla Frazee\",\"Yuyi Morales\",\"Laura Numeroff\",\"Sydney Smith\",\"Arnold Lobel\",\"Dr. Seuss\",\"Eric Carle\",\"Michael Rosen\",\"Carole Gerber\",\"Antoinette Portis\",\"Roald Dahl\",\"Lauren Thompson\",\"Dianna Hutts Aston, Sylvia Long\",\"Marianne Dubuc\",\"Matt Lamothe\",\"Michael Hall\",\"Donald Crews\",\"Kimberly Gee\",\"Matthew A. Cherry\",\"Daniel Haack\",\"Cinders McLeod\",\"Zachariah OHora\",\"Bob Shea\",\"Julia Donaldson\",\"Sean Taylor\",\"Jon J Muth\",\"Sujean Rim\",\"Marianne Dubuc\",\"Kimberly Gee\",\"Cinders McLeod\",\"Cinders McLeod\",\"Eric Carle\",\"Connie Schofield-Morrison\",\"Danica McKellar\",\"Grace Maccarone\",\"Komako Sakai\",\"Sean Taylor\",\"Amy Krouse Rosenthal\",\"Margaret Wise Brown, G. Brian Karas\",\"Chris Van Dusen\",\"Mo Willems, LeUyen Pham\",\"Mo Willems\",\"Rosemary Wells\",\"Oliver Jeffers\",\"Mo Willems\",\"Oliver Jeffers\",\"Rosemary Wells\",\"Oliver Jeffers\",\"Jon Stone\",\"Rosemary Wells\",\"Sujean Rim\",\"Sujean Rim\",\"Bob Shea\",\"Bob Shea\",\"Mac Barnett\",\"Amy Krause Rosenthal\",\"Chris Van Dusen\",\"Hatsue Nakawaki\",\"Lauren Thompson\",\"Sean Taylor\",\"Julia Donaldson\",\"Julia Donaldson\",\"Jon Klassen\",\"Julia Donaldson\",\"Rosemary Wells\",\"Amy Krouse Rosenthal\",\"Amy Krouse Rosenthal\",\"Carolyn Crimi\",\"Jennifer O'Connell\",\"Wells, Rosemary\",\"Susan Pearson\",\"Stephen Wunderli\",\"Julia Donaldson\",\"Nick Bruel\",\"Mercer Mayer\",\"Michael Hall\",\"Zoe Hall\",\"Monica Wellington\",\"Tad Hills\",\"Nick Bruel\",\"Karma Wilson\",\"Adam Rubin\",\"Lois Ehlert\",\"Lucille Colandro\",\"Abby Levine\",\"Margery Cuyler\",\"Suzanne Lang\",\"Mike Berenstain\",\"Stan Berenstain, Jan Berenstain\",\"Amy Krouse Rosenthal\",\"Tom Fletcher\",\"Deborah Diesen\",\"Mo Willems\",\"Tamara S. Tribble\",\"Liza Baker\",\"Maurice Sendak\",\"Deborah Diesen\",\"Todd Tarpley\",\"Jan Brett\",\"David Shannon\",\"Victoria Kann\",\"Mike Berenstain\",\"Alan Silberberg\",\"Maudie Powell-Tuck\",\"Amy Young\",\"David Shannon\",\"Karma Wilson\",\"Caralyn Buehner\",\"Anna Dewdney\",\"Eric Carle\",\"Wendy Cheyette Lewison\",\"Victoria Kann\",\"Don Freeman\",\"Alyssa Satin Capucilli\",\"Deborah Diesen\",\"Eric Litwin, James Dean\",\"Nicola Killen\",\"Vivian Walsh, J.otto Seibold\",\"Nicki Greenberg\",\"Monique Peterson\",\"Alan Benjamin\",\"Patricia Toht\",\"Cynthia Rylant\",\"Pat Miller\",\"Alice Schertle\",\"Jan Brett\",\"Patricia Thomas\"],[2019,2017,2014,2013,2012,2019,2014,2020,1997,2014,2019,2004,2018,2016,2014,2012,2014,2013,2012,2014,2013,2014,1977,2014,2010,2018,null,2018,2019,2016,2015,2015,2018,2017,2015,2016,2012,2014,2016,2011,2012,2018,1999,2015,2020,2014,2017,2019,2015,2016,2008,2019,null,2020,2019,2019,2018,2019,2019,2013,2013,2014,2003,2013,2019,2002,2001,2015,2009,2008,2016,2019,2018,2019,2014,2018,2008,2009,2000,2012,1992,2020,2013,2016,2011,2015,2009,null,2013,2009,2019,2011,2013,2019,2003,2017,2020,2018,2009,2013,2016,2017,2015,2011,2020,2019,2020,2019,2016,2019,2005,2017,2015,2012,2019,2018,2017,2019,2019,2014,2018,2017,2006,2015,2010,1999,2019,2018,2015,2016,2012,2019,2014,2011,2017,2016,2019,2017,2016,2017,2019,2014,2020,2019,2013,2018,2017,2021,2005,2016,2020,2017,2015,2020,2008,2000,null,2012,2016,2001,2012,2020,2016,2008,2004,2011,2019,2020,2012,1991,2019,2000,2009,2020,2019,2019,2019,2017,2018,2012,2014,2002,1962,2014,2018,2018,2019,2014,2013,2018,2018,2018,2016,2013,2005,2018,2016,2012,2020,2009,2018,2017,2014,2017,1997,2017,2001,null,2017,2005,2010,2019,1998,2013],[\"2020-06-22\",\"2020-06-24\",\"2020-06-24\",\"2020-06-24\",\"2020-06-25\",\"2020-06-26\",\"2020-06-30\",\"2020-07-01\",\"2020-07-01\",\"2020-07-02\",\"2020-07-02\",\"2020-07-02\",\"2020-07-04\",\"2020-07-04\",\"2020-07-07\",\"2020-07-07\",\"2020-07-07\",\"2020-07-07\",\"2020-07-08\",\"2020-07-09\",\"2020-07-09\",\"2020-07-14\",\"2020-07-14\",\"2020-07-14\",\"2020-07-14\",\"2020-07-15\",\"2020-07-15\",\"2020-07-15\",\"2020-07-16\",\"2020-07-16\",\"2020-07-16\",\"2020-07-18\",\"2020-07-19\",\"2020-07-19\",\"2020-07-19\",\"2020-07-21\",\"2020-07-21\",\"2020-07-21\",\"2020-07-21\",\"2020-07-21\",\"2020-07-21\",\"2020-07-21\",\"2020-07-22\",\"2020-07-22\",\"2020-07-22\",\"2020-07-28\",\"2020-07-28\",\"2020-07-28\",\"2020-07-28\",\"2020-07-28\",\"2020-07-28\",\"2020-07-28\",\"2020-07-28\",\"2020-07-28\",\"2020-07-28\",\"2020-07-28\",\"2020-07-29\",\"2020-07-29\",\"2020-08-04\",\"2020-08-04\",\"2020-08-04\",\"2020-08-04\",\"2020-08-04\",\"2020-08-04\",\"2020-08-04\",\"2020-08-05\",\"2020-08-05\",\"2020-08-05\",\"2020-08-05\",\"2020-08-05\",\"2020-08-06\",\"2020-08-07\",\"2020-08-11\",\"2020-08-11\",\"2020-08-11\",\"2020-08-11\",\"2020-08-11\",\"2020-08-11\",\"2020-08-11\",\"2020-08-12\",\"2020-08-12\",\"2020-08-12\",\"2020-08-12\",\"2020-08-13\",\"2020-08-14\",\"2020-08-14\",\"2020-08-14\",\"2020-08-18\",\"2020-08-18\",\"2020-08-18\",\"2020-08-18\",\"2020-08-18\",\"2020-08-18\",\"2020-08-18\",\"2020-08-18\",\"2020-08-19\",\"2020-08-19\",\"2020-08-19\",\"2020-08-20\",\"2020-08-20\",\"2020-08-25\",\"2020-08-25\",\"2020-08-25\",\"2020-08-25\",\"2020-08-26\",\"2020-08-26\",\"2020-08-26\",\"2020-08-26\",\"2020-08-26\",\"2020-08-26\",\"2020-08-26\",\"2020-08-26\",\"2020-08-26\",\"2020-08-28\",\"2020-09-09\",\"2020-09-09\",\"2020-09-09\",\"2020-09-09\",\"2020-09-09\",\"2020-09-09\",\"2020-09-09\",\"2020-09-09\",\"2020-09-09\",\"2020-09-10\",\"2020-09-10\",\"2020-09-10\",\"2020-09-10\",\"2020-09-22\",\"2020-09-22\",\"2020-09-22\",\"2020-09-22\",\"2020-09-23\",\"2020-09-23\",\"2020-09-24\",\"2020-09-24\",\"2020-09-30\",\"2020-10-01\",\"2020-10-01\",\"2020-10-01\",\"2020-10-01\",\"2020-10-01\",\"2020-10-01\",\"2020-10-01\",\"2020-10-01\",\"2020-10-01\",\"2020-10-01\",\"2020-10-02\",\"2020-10-03\",\"2020-10-07\",\"2020-10-07\",\"2020-10-08\",\"2020-10-08\",\"2020-10-08\",\"2020-10-08\",\"2020-10-08\",\"2020-10-08\",\"2020-10-09\",\"2020-10-13\",\"2020-10-17\",\"2020-10-20\",\"2020-11-01\",\"2020-11-03\",\"2020-11-03\",\"2020-11-03\",\"2020-11-03\",\"2020-11-03\",\"2020-11-03\",\"2020-11-03\",\"2020-11-04\",\"2020-11-04\",\"2020-11-04\",\"2020-11-04\",\"2020-11-06\",\"2020-11-17\",\"2020-11-17\",\"2020-11-17\",\"2020-11-17\",\"2020-11-17\",\"2020-11-18\",\"2020-11-18\",\"2020-11-18\",\"2020-11-18\",\"2020-11-18\",\"2020-11-19\",\"2020-11-24\",\"2020-12-01\",\"2020-12-01\",\"2020-12-01\",\"2020-12-01\",\"2020-12-02\",\"2020-12-02\",\"2020-12-02\",\"2020-12-02\",\"2020-12-02\",\"2020-12-02\",\"2020-12-02\",\"2020-12-04\",\"2020-12-10\",\"2020-12-12\",\"2020-12-15\",\"2020-12-15\",\"2020-12-15\",\"2020-12-15\",\"2020-12-15\",\"2020-12-15\",\"2020-12-15\",\"2020-12-16\",\"2020-12-16\",\"2020-12-29\",\"2020-12-29\",\"2020-12-29\",\"2020-12-29\",\"2020-12-29\",\"2020-12-30\"]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th>ID<\\/th>\\n      <th>Preview<\\/th>\\n      <th>Title<\\/th>\\n      <th>Author(s)<\\/th>\\n      <th>Published<\\/th>\\n      <th>Notification<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-center\",\"targets\":[1,4,5]},{\"className\":\"dt-left\",\"targets\":[2,3]},{\"className\":\"dt-right\",\"targets\":0}],\"pageLength\":15,\"lengthMenu\":[15,30,45,60,75,90,105,120,135,150,165,180,195,210,225],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}\r\nTechnical reflection\r\nThis project was certainly a learning experience! I used the gmailr and httr packages for the first time, in addition to accessing my first API. Here are some of the challenges I faced:\r\nMy emails from the library did not always have consistent punctuation in reporting available books.\r\nBook titles are not consistently presented; e.g., Up up up down in my email from the library vs Up, Up, Up, Down! in the Google Books result.\r\nAuthor names can be formatted differently across books (books with multiple authors or authors who identify with a middle initial, and period, in their name).\r\nAuthorship is not always consistently defined. For example, I Can Read! Splat the Cat and the Quick Chicks was attributed to Laura Driscoll according to the library (who actually wrote the text), but Rob Scotton according to Google Books (who wrote the original Splat the Cat books that this was based on).\r\nThe API results varied in information presented; for example, not all results contained authors or preview images.\r\nPerforming the API search in two phases (author and title vs title only) gave eight additional correct results and five additional incorrect results. I’m not sure if that is worth it considering the manual effort to identify the incorrect results.\r\nThe books shown in my search are not necessarily the exact books that I read. For example, I did not read the 2021 edition of “What the Ladybird Heard” as shown in my final table, which would not have been available when I read it in October 2020.\r\nI encountered more issues with NULL, integer(0), and empty items than ever before (which is not the same as NA 🤣).\r\nAlternative solutions to these challenges are welcome! You can download books.rda (which contains message_body, books_1, and books_2) from my github repo.\r\nPersonal note\r\nLike many aspects of life, COVID-19 changed our relationship with the library. Previously, our family library experience consisted of leisurely browsing for a couple of books followed by a quick exit when the girls inevitably started playing hide and seek in the aisles. Instead, I now actively research children’s books to check out. Without this change, I may have not have encountered many books that we now treasure. Completion of this cataloging project with preview images allows us to better recall the books we read together, and decide together which books we want to read again in the future. I hope that nurturing a love for books and reading can help to alleviate the lapse in formal pre-k education my children experienced this year.\r\nAcknowledgements\r\nAnthony Pileggi (my husband) talked me through my first API and discussed possible solutions to some coding challenges. Anthony is a data scientist currently specializing in e-commerce for outdoor power equipment at Paul B. Moyer and Sons, and sometimes he makes fun R packages like this.\r\n\r\n\r\n",
    "preview": "posts/2021-01-11-from-gmailr-to-the-google-books-api/preview_books.png",
    "last_modified": "2021-01-13T22:31:21-05:00",
    "input_file": {},
    "preview_width": 705,
    "preview_height": 459
  },
  {
    "path": "posts/2020-12-23-leveraging-labelled-data-in-r/",
    "title": "Leveraging labelled data in R",
    "description": "Embracing SPSS, SAS, and Stata data sets with the haven, labelled, and sjlabelled packages",
    "author": [
      {
        "name": "Shannon Pileggi",
        "url": {}
      }
    ],
    "date": "2020-12-23",
    "categories": [],
    "contents": "\r\n\r\nContents\r\nTL; DR\r\nIntroduction\r\nYRBSS labelled data\r\nGetting started\r\nImporting labelled data\r\nCreating a data dictionary\r\nIdentifying labelled features\r\nViewing labelled features\r\nCommon operations\r\nExample\r\nOther packages and haven_labelled objects\r\nWorkflow for labelled data manipulation\r\nSummary\r\nAcknowledgments\r\n\r\nTL; DR\r\nThe haven, labelled, and sjlabelled packages can be used to effectively work with SPSS, SAS, and Stata data sets in R through implementation of the haven_labelled class, which stores variable and value labels. Here are my most used functions for getting started with labelled data:\r\nPurpose\r\nFunction\r\n1. Import SPSS labelled data\r\nhaven::read_sav()\r\n2. Create data dictionary\r\nlabelled::look_for(details = TRUE)\r\n3. Identify if variable is haven_labelled\r\nhaven::is.labelled()\r\n4. Convert haven_labelled variables to numeric\r\nbase::as.numeric()\r\n5. Convert haven_labelled variables to factors\r\nhaven::as_factor()\r\n6. Convert variable label to variable name\r\nsjlabelled::label_to_colnames()\r\nIntroduction\r\nLabelled data traditionally, though not exclusively, arises in survey data. SAS, SPSS, and Stata have established infrastructures for labelled data, which consists of metadata in the form of variable and value labels. This post is for R users who already have a SPSS (.sav), SAS (.sas7bdat), or Stata (.dta) data file and want to incorporate the labelled data features into their R workflow. With R’s haven, labelled, and sjlabelled packages, you can leverage the inherent data labelling structure in these data sets to work interactively with variable and value labels, making it easier to navigate data while also allowing the user to convert metadata to data. This post discusses general characteristics of labelled data and practical tips for data analysis with labelled data.\r\n\r\nI work exclusively with SPSS (.sav) data files, and so I have not evaluated this process on SAS (.sas7bdat) or Stata (.dta) data files. 🤞 everything works the same!\r\nYRBSS labelled data\r\nThe Youth Risk Behavior Surveillance System (YRBSS) is a publicly available data set from the Centers for Disease Control and Prevention (CDC) that “monitors health-related behaviors that contribute to the leading causes of death and disability among youth and adults.” On Aug 9, 2020, I downloaded YRBSS materials from the CDC website. This site has both the the 2017 national data (sadc_2017_national.dat) and the SPSS syntax to convert the .dat file to an SPSS labelled data file (2017_sadc_spss_input_program.sps). I do have an SPSS license, and I used the SPSS syntax to convert the .dat file to an SPSS labelled data file (sadc_2017_national.sav). As the .sav data file is not available on the CDC site, you can download the .sav data from my github repo.\r\nGetting started\r\nThis material was developed using:\r\nSoftware / package\r\nVersion\r\nR\r\n4.0.3\r\nRStudio\r\n1.3.1073\r\ntidyverse\r\n1.3.0\r\nhere\r\n0.4.8\r\nhaven\r\n2.3.1\r\nlabelled\r\n2.5.0\r\nsjlabelled\r\n1.1.7\r\n\r\nAs of Dec 23, 2020, the most current version of the labelled package is 2.7.0. I am using labelled 2.5.0 due to an issue I encountered with 2.7.0 and the look_for function. You can install older versions of a package. I’ll update this post when the issue is resolved.\r\n\r\n\r\nlibrary(tidyverse)  # general use ----\r\nlibrary(here)       # file paths  ----\r\nlibrary(haven)      # import .sav files ----  \r\nlibrary(labelled)   # tools for labelled data ----\r\nlibrary(sjlabelled) # more tools for labelled data ----\r\n\r\n\r\n\r\nImporting labelled data\r\nI use the haven package to import SPSS (.sav) data files.\r\n\r\n\r\n# import data ----\r\ndat_raw <- haven::read_sav(here::here( \"_posts\", \"2020-12-23-leveraging-labelled-data-in-r\", \"data\", \"sadc_2017_national.sav\"))\r\n\r\n\r\n\r\nVariables in a data set have a class, which consists of assignments like numeric, character, and factor, among others. When labelled features are present, the haven package assigns a class of haven_labelled. This is important to know as many packages you work with may not have methods for haven_labelled objects.\r\nWhen I first started working with SPSS data files, I also explored the foreign package, which preceeds haven. Using foreign takes a bit longer than haven, can result in truncation of long character variables, and produces a different labelled data structure compared to haven. I have a strong preference for the haven package.\r\nCreating a data dictionary\r\nA data dictionary contains metadata about your data. The labelled::look_for function can be used to create a data dictionary, extracted straight from your data. The usefulness of the data dictionary depends on the quality of your metadata.\r\n\r\n\r\n# create data dictionary ----\r\ndictionary <- labelled::look_for(dat_raw, details = TRUE)\r\n\r\n\r\n\r\nThe result is a data frame in my R environment with the number of observations equal to number of variables in the original data set. I can interactively explore the dictionary in R to quickly find variables or documentation of interest. For example, I can find all variables related to “weapons” with a search.\r\n\r\nIdentifying labelled features\r\nStandard data consists of variables (e.g., country) and values (e.g. US, UK, CA). When working with labelled data, variables and values each have two features. Variables consist of a name and a label; values consist of a code and a label. For example, here are the features of the q8 variable.\r\nFeature\r\nAssignment\r\nVariable name\r\nq8\r\nVariable label\r\nSeat belt use\r\nValue codes\r\n1, 2, 3, 4, 5\r\nValue labels\r\nNever, Rarely, Sometimes, Most of the time, Always\r\nYou can see this information in the data dictionary - here is a snippet of the dictionary for three variables. The value_labels field combines the value codes and value labels.\r\n\r\n\r\ndictionary %>% \r\n  dplyr::filter(variable %in% c(\"q8\", \"q11\", \"q12\")) %>% \r\n  dplyr::select(variable, label, value_labels) %>% \r\n  knitr::kable() \r\n\r\n\r\nvariable\r\nlabel\r\nvalue_labels\r\nq8\r\nSeat belt use\r\n[1] Never; [2] Rarely; [3] Sometimes; [4] Most of the time; [5] Always\r\nq11\r\nTexting and driving\r\n[1] Did not drive; [2] 0 days; [3] 1 or 2 days; [4] 3 to 5 days; [5] 6 to 9 days; [6] 10 to 19 days; [7] 20 to 29 days; [8] All 30 days\r\nq12\r\nWeapon carrying\r\n[1] 0 days; [2] 1 day; [3] 2 or 3 days; [4] 4 or 5 days; [5] 6 or more days\r\n\r\nTo dive a bit deeper, you can see the class of the q8 variable:\r\n\r\n\r\ndat_raw %>% \r\n  dplyr::pull(q8) %>% \r\n  class(.)\r\n\r\n\r\n[1] \"haven_labelled\" \"vctrs_vctr\"     \"double\"        \r\n\r\nand how the metadata of q8 is stored.\r\n\r\n\r\ndat_raw %>% \r\n  dplyr::select(q8) %>% \r\n  str(.)\r\n\r\n\r\ntibble [203,663 x 1] (S3: tbl_df/tbl/data.frame)\r\n $ q8: dbl+lbl [1:203663]  2, NA,  4,  4,  1,  1,  3,  5,  4,  4,  ...\r\n   ..@ label        : chr \"Seat belt use\"\r\n   ..@ format.spss  : chr \"F1.0\"\r\n   ..@ display_width: int 4\r\n   ..@ labels       : Named num [1:5] 1 2 3 4 5\r\n   .. ..- attr(*, \"names\")= chr [1:5] \"Never\" \"Rarely\" \"Sometimes\" \"Most of the time\" ...\r\n\r\nYou don’t need to get into the weeds of this to work effectively with labelled data, but knowing this can help troubleshoot errors.\r\nViewing labelled features\r\nBeyond the dictionary, labelled features can also be seen when working with your data interactively. The console simultaneously prints value codes and labels side by side, with the code first followed by the label in brackets.\r\n\r\n\r\ndat_raw %>% \r\n  dplyr::select(q8, q11, q12) \r\n\r\n\r\n# A tibble: 203,663 x 3\r\n                      q8       q11                 q12\r\n               <dbl+lbl> <dbl+lbl>           <dbl+lbl>\r\n 1  2 [Rarely]                  NA  4 [4 or 5 days]   \r\n 2 NA                           NA NA                 \r\n 3  4 [Most of the time]        NA  3 [2 or 3 days]   \r\n 4  4 [Most of the time]        NA  5 [6 or more days]\r\n 5  1 [Never]                   NA  5 [6 or more days]\r\n 6  1 [Never]                   NA  1 [0 days]        \r\n 7  3 [Sometimes]               NA  2 [1 day]         \r\n 8  5 [Always]                  NA  1 [0 days]        \r\n 9  4 [Most of the time]        NA  5 [6 or more days]\r\n10  4 [Most of the time]        NA NA                 \r\n# ... with 203,653 more rows\r\n\r\nSometimes the alignment throws me a bit when I am reading this as the value codes and labels are left aligned, which places the value codes associated with q12 closer to q11.\r\nWhen viewing the data frame in RStudio, the data frame displays the variable label under the variable name; however, only value codes (and not value labels) are displayed.\r\n\r\nCommon operations\r\nI primarily use three packages for working with labelled data: haven, labelled, and sjlabelled. These three packages do have some overlap in functionality, in addition to naming schemes that differ but achieve the same objective (e.g., haven::as_factor vs sjlabelled::as_label), or naming schemes that are the same but achieve different objectives (e.g., haven::as_factor vs sjlabelled::as_factor). 😬 To compound confusion, the concept of a label can refer to either variable or value labels. Frequently, plural function names refer to value labels, as in haven::zap_labels or labelled::remove_val_labels.\r\nHere are operations I commonly perform on labelled data:\r\nEvaluate if variable is of class haven_labelled.\r\nWhy? Troubleshooting, exploring, mutating.\r\nFunction(s): haven::is.labelled()\r\n\r\nConvert haven_labelled variable to numeric value codes.\r\nWhy? To treat the variable as continuous for analysis. For example, if a 1-7 rating scale imports as labelled and you want to compute a mean.\r\nFunction(s): base::as.numeric() (strips variable of all metadata), haven::zap_labels() and labelled::remove_val_labels (removes value labels, retains other metadata)\r\n\r\nConvert haven_labelled() variable to factor with value labels.\r\nWhy? To treat the variable as categorical for analysis.\r\nFunction(s): haven::as_factor(), labelled::to_factor(), sjlabelled::as_label(). As far as I can tell, these three functions have the same result. By default, the factor levels are ordered by value codes.\r\n\r\nConvert variable label to variable name.\r\nWhy? For more informative or readable variable names.\r\nFunction(s): sjlabelled::label_to_colnames()\r\n\r\nExample\r\nFor this example, I reduce the data set to 2017 records only and select three variables related to carrying weapons and safety, all of which are measured on the same scale.\r\n\r\n\r\n# retain info on weapons and safety for 2017 ----\r\ndat_2017 <- dat_raw %>% \r\n  dplyr::filter(year == 2017) %>% \r\n  dplyr::select(record, q12, q13, q15) \r\n\r\n\r\n\r\n\r\n\r\n# preview data ----\r\ndat_2017\r\n\r\n\r\n# A tibble: 14,765 x 4\r\n    record                q12        q13                q15\r\n     <dbl>          <dbl+lbl>  <dbl+lbl>          <dbl+lbl>\r\n 1 1509749 5 [6 or more days] 1 [0 days] 1 [0 days]        \r\n 2 1509750 1 [0 days]         1 [0 days] 1 [0 days]        \r\n 3 1509751 1 [0 days]         1 [0 days] 3 [2 or 3 days]   \r\n 4 1509752 1 [0 days]         1 [0 days] 1 [0 days]        \r\n 5 1509753 1 [0 days]         1 [0 days] 1 [0 days]        \r\n 6 1509754 1 [0 days]         1 [0 days] 2 [1 day]         \r\n 7 1509755 5 [6 or more days] 1 [0 days] 5 [6 or more days]\r\n 8 1509756 1 [0 days]         1 [0 days] 1 [0 days]        \r\n 9 1509757 1 [0 days]         1 [0 days] 1 [0 days]        \r\n10 1509758 1 [0 days]         1 [0 days] 1 [0 days]        \r\n# ... with 14,755 more rows\r\n\r\nThis code produces a bar plot showing the frequencies of the three variables from data as imported, displaying variable names and value codes.\r\n\r\n\r\n# bar plot 1 ----\r\ndat_2017 %>% \r\n   pivot_longer(\r\n    cols = -1,\r\n    names_to = \"variable\",\r\n    values_to = \"days\"\r\n  ) %>% \r\n  count(variable, days) %>% \r\n  # include factor(days) to correctly show value codes in ggplot ----\r\n  ggplot(aes(x = n, y = factor(days))) +\r\n  facet_wrap(. ~ variable) +\r\n  geom_col() \r\n\r\n\r\n\r\n\r\nFigure 1: Bar plot 1 displays variable names and value codes\r\n\r\n\r\n\r\nNow I add two lines of code to implement two changes - convert the variables to factors and convert the variable labels to variable names. This plot displays variable labels and value labels, producing a more informative figure.\r\n\r\n\r\n# bar plot 2 ----\r\ndat_2017 %>% \r\n  # --------------------------------------------------------------\r\n  # change 1: convert haven_labelled variables to factors ----\r\n  mutate_if(haven::is.labelled, haven::as_factor) %>% \r\n  # change 2: convert variable labels to variable names ----\r\n  sjlabelled::label_to_colnames() %>% \r\n  # --------------------------------------------------------------\r\n  pivot_longer(\r\n    cols = -1,\r\n    names_to = \"variable\",\r\n    values_to = \"days\"\r\n  ) %>% \r\n  count(variable, days) %>% \r\n  # unnecessary to include factor(days) here ----\r\n  ggplot(aes(x = n, y = days)) +\r\n  facet_wrap(. ~ variable) +\r\n  geom_col() \r\n\r\n\r\n\r\n\r\nFigure 2: Bar plot 2 displays variable labels and value labels\r\n\r\n\r\n\r\nOther packages and haven_labelled objects\r\nIt is probably safe to assume that most packages you work with don’t know how to handle the haven_labelled class - if the package does produce a result, it is likely making an educated guess which may not be in line with your needs.\r\nFor example, in using ggplot for Figure 1 above, I included the line y = factor(days); if instead I had y = days in Figure 1, ggplot yields the following message:\r\n\r\nDon’t know how to automatically pick scale for object of type haven_labelled/vctrs_vctr/double. Defaulting to continuous.\r\n\r\nTreating the days variable as continuous resulted in an uninformative plot (not shown), which was corrected by converting the variable to factor.\r\nWhat about other packages I use? In skimr 2.1.2 haven_labelled inputs result in value codes treated as character values, and in gtsummary 1.3.5 haven_labelled inputs are omitted from output as it is not an accepted class. In general, you will probably find a mix of messages, warnings, errors, omissions, or guessing when using haven_labelled variables with other packages. These issues can be resolved by converting the haven_labelled variables to numeric or factor, depending on the context.\r\n\r\nNote added Feb 20, 2021: Although gtsummary does not currently support value labels, it does support variable labels! See this tweet for a quick demo.\r\nWorkflow for labelled data manipulation\r\nWhen converting haven_labelled objects to factor or numeric, be intentional about where the conversion happens in your workflow. The Introduction to labelled vignette by Joseph Larmarange outlines two different approaches:\r\nFirst convert haven_labelled variables; second perform data manipulation utilizing variable labels (if factor).\r\nFirst perform data manipulation utilizing variable codes; second convert haven_labelled variables.\r\nFor me this question usually distills down to: for data manipulation, are the value codes or the value labels easier to work with? Sometimes the brevity of the value code helps (i.e., q12 == 1), whereas other times the context of the value label makes the code more readable (i.e., q12 == \"0 days\"). Note that the placement of the conversion can have downstream effects on your code.\r\nSummary\r\nThe haven, labelled, sjlabelled packages create new structures and work flows for labelled data that allow you to harness the power of R while still honoring the valuable metadata framework that exists in SPSS, SAS, and Stata data sets. The functions discussed in this post cover most of my daily needs with labelled data; if you want to do more, next steps might include handling specific types of coded missing data or creating labelled data within R.\r\nAcknowledgments\r\nThumbnail artwork was adapted from @allison_horst.\r\n\r\n\r\n\r\n",
    "preview": "posts/2020-12-23-leveraging-labelled-data-in-r/labelled_preview.png",
    "last_modified": "2021-02-20T13:13:35-05:00",
    "input_file": {},
    "preview_width": 671,
    "preview_height": 617
  },
  {
    "path": "posts/2020-10-25-your-first-r-package-in-1-hour/",
    "title": "Your first R package in 1 hour",
    "description": "Tools that make R package development easy",
    "author": [
      {
        "name": "Shannon Pileggi",
        "url": {}
      }
    ],
    "date": "2020-10-25",
    "categories": [],
    "contents": "\r\nTable of Contents\r\nTL; DR\r\nAbstract\r\nDisclaimer\r\nGetting started\r\nTool kit\r\nFirst package\r\nFirst check\r\nFirst function\r\nCreate\r\nExecute\r\nDocument\r\nCheck\r\nDependencies\r\n\r\nInstalling your package\r\nSummary\r\nAcknowledgements\r\nTL; DR\r\nThis blog post accompanies the R-Ladies Philly workshop on November 12, 2020. We demonstrate how leveraging the devtools and usethis packages in package development can automate folder structure and file creation, speeding up the development process.\r\n\r\nThis post was updated on Nov 21, 2020 with the YouTube workshop recording. Some Q&A from the workshop are here.\r\nAbstract\r\nThis workshop is for people looking to learn how to make their own R packages and learn how to use usethis and devtools for package development. The workshop will cover handy one time functions (i.e., usethis::create_package) as well as functions used continuously throughout package development (i.e., devtools::document). At the end of the hour you should have a working, well-documented package with a single function, as well as a better understanding of the files and file structure required for R packages.\r\nThis workshop is suitable for beginner to intermediate R users. Attendees should be familiar with functions, but will not be writing their own function in this workshop. Familiarity with pipe or tidyverse is helpful.\r\nDisclaimer\r\n\r\n\r\nArtwork adapted from @allison_horst.\r\nI have learned enough about package development to share with you what has worked well for me; however, I am still learning! Comments and suggestions are welcome.\r\nGetting started\r\nThis material was developed using:\r\nSoftware / package\r\nVersion\r\nR\r\n4.0.3\r\nRStudio\r\n1.3.1073\r\ndevtools\r\n2.3.2\r\nusethis\r\n1.6.3\r\ntidyverse\r\n1.3.0\r\nrlang\r\n0.4.8\r\nbroom\r\n0.7.1\r\nPlease install and update all software / packages prior to following along, as otherwise errors may arise.\r\nTool kit\r\nSingle usage functions only need to be used one time in the development process; multiple usage functions are executed as needed. This table only contains functions used in this workshop; there are many other handy functions in devtools and usethis for package development.\r\nUsage\r\nFunction\r\nPurpose\r\nSingle\r\nusethis::create_package(\"path/package\")\r\ninitialize package\r\n\r\nusethis::use_mit_license(\"Your name\")\r\nadd license\r\n\r\nusethis::use_pipe()\r\nadd pipe function as a dependency\r\nMultiple\r\ndevtools::check()\r\nbuild package locally and check\r\n\r\ndevtools::load_all()\r\nload functions in 📂 R/ into memory\r\n\r\nusethis::use_r(\"function\")\r\ncreate R script for function\r\n\r\nusethis::use_package(\"package\")\r\nadd package dependency\r\n\r\ndevtools::document()\r\nbuild and add documentation\r\nOther resources:\r\nPackage development cheat sheet\r\nR packages book by Hadley Wickham and Jenny Bryan\r\nHow to develop good R packages by Maëlle Salmon\r\nR Package Primer by Karl Broman\r\nFirst package\r\nOpen an R session and submit the following, modified to your desired location. Here, I am creating a package named ralph on my desktop. (This name is inspired by R-Ladies Philly.)\r\n\r\n\r\nusethis::create_package(\"C:/Users/Shannon.Pileggi/Desktop/ralph\")\r\n\r\n\r\nNow you have a package! The usethis::create_package function:\r\nCreates a new R project named ralph at your specified location.\r\nOpens the ralph project in a new RStudio session.\r\nCreates the minimal essential files and structure required for R packages.\r\n\r\nSee the package development cheat sheet for a picture overview of the full file structure.\r\nOptional:\r\nIf you are already authenticated, the usethis package has some handy functions to quickly connect your local package to a GitHub repository,\r\n\r\n\r\nusethis::use_git()     # step 1 ----\r\nusethis::use_github()  # step 2 ----\r\n\r\n\r\nGitHub is renaming the default branch from master to main. Currently, usethis::use_github() creates a repo with the default branch named master.\r\nFor more references on using git / GitHub, see Jenny Bryan’s Happy Git and GitHub for the useR or Ch 18 in R Packages by Hadley Wickham and Jenny Bryan.\r\nFirst check\r\nNow that we have a package, let’s check it. Submitting devtools::check() updates package documentation, builds the package, and submits over 50 checks for metadata, structure, R code, documentation, and more!\r\n\r\n\r\ndevtools::check()\r\n\r\nThis can take a while to run, depending on how big your package is. It is helpful to run frequently, especially if you are planning on submitting to CRAN. But even for internal packages, it is still good practice.\r\nOur first check results in a single warning - that our package needs a license in the DESCRIPTION file:\r\n\r\nTo fix this, add the license of your choice. A standard recommendation is the MIT license due to broad permissions.\r\n\r\n\r\nusethis::use_mit_license(\"Shannon Pileggi\")\r\n\r\nThis updates the description file, as well as creates two new license files in your project that you never have to touch.\r\n\r\n\r\nThe DESCRIPTION file automatically populates with some fields from your .Rprofile, which can be modified with usethis::edit_r_profile().\r\nYou can go back and complete the remaining description fields later. Re-submit\r\n\r\n\r\ndevtools::check()\r\n\r\nand our package is error, warning, and note free.\r\n\r\nFirst function\r\nCreate\r\nThe compute_corr function is a wrapper for cor.test that produces tidy output for Pearson’s correlation estimate (along with a p-value) to quantify the linear relationship between two quantitative variables.\r\n\r\n\r\ncompute_corr <- function(data, var1, var2){\r\n  \r\n    # compute correlation ----\r\n    cor.test(\r\n      x = data %>% dplyr::pull({{var1}}),\r\n      y = data %>% dplyr::pull({{var2}})\r\n    ) %>% \r\n    # tidy up results ----\r\n    broom::tidy() %>% \r\n    # retain and rename relevant bits ----\r\n    dplyr::select(\r\n      correlation = estimate, \r\n      pval = p.value\r\n    )\r\n  \r\n}\r\n\r\n\r\nThis function uses tidy evaluation by embracing ({{) unquoted variable names.\r\nLet’s add the compute_corr function to ralph.\r\n\r\n\r\nusethis::use_r(\"compute_corr\")\r\n\r\nThis creates a blank R script named compute_corr.R located in the R/ folder. It is convention that your function name and R script name are the same. Copy and paste the function to the blank R script, and then save.\r\n\r\nExecute\r\nTake your function for a test drive with devtools::load_all (“arguably the most important part of the devtools workflow”).\r\n\r\n\r\ndevtools::load_all()\r\n\r\nThis places your function in local memory so that you may tinker and confirm its execution. Let’s give it a try.\r\n\r\n\r\ncompute_corr(data = faithful, var1 = eruptions, var2 = waiting)\r\n\r\n# A tibble: 1 x 2\r\n  correlation      pval\r\n        <dbl>     <dbl>\r\n1       0.901 8.13e-100\r\n\r\n\r\nDepending on which packages are loaded in your R session, you may have a small hiccup here, which we discuss in the workshop.\r\nDocument\r\nNext document the compute_corr function using the Roxygen skeleton. First, place your cursor in the function definition, and then you can add the skeleton two ways:\r\nCode -> Insert Roxygen Skeleton, or\r\nCntrl + Alt + Shift + R\r\nYou should see this:\r\n\r\nwhere we now have an outline to fill in. Note that the three arguments in our function (data, var1, var2) were automatically detected. Update the documentation as follows:\r\n\r\n\r\n#' Computes a tidy correlation\r\n#'\r\n#' @param data input data set\r\n#' @param var1 name of variable 1 \r\n#' @param var2 name of variable 2 \r\n#'\r\n#' @return A tibble with the Pearson correlation and the p-value\r\n#' @export\r\n#'\r\n#' @examples\r\n#' compute_corr(data = faithful, var1 = eruptions, var2 = waiting)\r\n\r\nSave your function and submit:\r\n\r\n\r\ndevtools::document()\r\n\r\nThis did a lot of work for you!\r\n\r\nThe man folder (short for manual) now contains a file called compute_corr.Rd. This is the documentation for your function; you never edit this manually.\r\nThe NAMESPACE now specifies that the package will export the compute_corr function.\r\nPreview the documentation with:\r\n\r\n\r\n?compute_corr\r\n\r\n\r\nIf you want to modify your documentation, make the changes in the Roxygen skeleton in compute_corr.R, save, and then resubmit devtools::document().\r\nCheck\r\nNow submit\r\n\r\n\r\ndevtools::check()\r\n\r\nand you’ll see that we have some concerns.\r\n\r\nThis is because compute_corr depends on functions from other packages, such as:\r\nThe pipe function (%>%) from the magrittr package.\r\nThe tidy function from the broom package.\r\nThe select function from the dplyr package.\r\nThe pull function from the dplyr package.\r\n\r\nAre any other functions missing from this list?\r\nDependencies\r\nWe can fix these errors, warnings, and notes by specifying the dependencies in the compute_corr function.\r\n1. Package dependencies\r\nTo specify a package dependency, the name of the package needs to be listed in the DESCRIPTION file. This can be automatically done for you by submitting\r\n\r\n\r\nusethis::use_package(\"broom\")\r\nusethis::use_package(\"dplyr\")\r\n\r\n\r\n2. Functions within packages\r\nThere are three ways you can specify required functions within packages.\r\nUse the :: notation within your function, as in broom::tidy (recommended, used in this post).\r\nIn the Roxygen section of your function, use @importFrom pkg fun1 fun2 - if you prefer this over using ::.\r\nIn the Roxygen section of your function, @import pkg - imports all functions from a package; use sparingly/wisely as this makes your package bulkier.\r\nSpecial case\r\nThe pipe function (%>%) from the magrittr package is a special case. The easiest way to include the pipe is\r\n\r\n\r\nusethis::use_pipe()  # step 1 ----\r\ndevtools::document() # step 2 ----\r\n\r\nHere, step 1 creates utils-pipe.R in your R folder and adds magrittr to imports in the DESCRIPTION file; step 2 adds the pipe to your NAMESPACE file.\r\n\r\nNow let’s run the check again:\r\n\r\n\r\ndevtools::check()\r\n\r\nCan you diagnose the note(s) this time? What steps would you take to correct it? I’m saving this for discussion in the workshop.1\r\n\r\nInstalling your package\r\nOpen a new R session. Install your package from your local directory or GitHub, load your package, and execute your functions.\r\n\r\n\r\n# install package from local directory ----\r\ndevtools::install(\"C:/Users/Shannon.Pileggi/Desktop/ralph\")\r\n\r\n# or install package from GitHub ----\r\n# devtools::install_github(\"shannonpileggi/ralph\")\r\n\r\n\r\nDue to GitHub renaming the default branch from master to main, you may need to fiddle with the ref argument in devtools::install_github.\r\n\r\n\r\n# load package ----\r\nlibrary(ralph)\r\n\r\n\r\n\r\n# execute function ----\r\ncompute_corr(data = faithful, var1 = eruptions, var2 = waiting)\r\n\r\n# A tibble: 1 x 2\r\n  correlation      pval\r\n        <dbl>     <dbl>\r\n1       0.901 8.13e-100\r\n\r\nSummary\r\nI hope you feel empowered to start developing your own packages now! We went through many of these steps one time only; however, in the development process, some of these steps are iterative. Here is a recap of our steps, although your work flow may differ.\r\nStep\r\nHow\r\n1. Load development packages.\r\nlibrary(usethis), library(devtools)\r\n2. Create new package.\r\nusethis::create_package(\"path/package\")\r\n3. Optional: Connect to GitHub repo.\r\nusethis::use_git(), usethis::use_github()\r\n4. Check build.\r\ndevtools::check()\r\n5. Add license.\r\nusethis::use_mit_license(\"Your name\")\r\n6. Check build.\r\ndevtools::check()\r\n7. Create new function.\r\nusethis::use_r(\"function\")\r\n8. Test drive function.\r\ndevtools::load_all()\r\n9. Insert Roxygen skeleton.\r\nMenu -> Code -> Insert Roxygen Skeleton\r\n10. Document package.\r\ndevtools::document()\r\n11. Preview documentation.\r\n?function\r\n12. Check build.\r\ndevtools::check()\r\n13. Specify package dependencies.\r\nusethis::use_package(\"package\")\r\n14. Specify functions within packages.\r\npackage::function\r\n15. Document package.\r\ndevtools::document()\r\n16. Check build.\r\ndevtools::check()\r\n17. Install package.\r\ndevtools::install(\"path/package\"), or\r\n\r\ndevtools::install_github(\"user/repo\")\r\n\r\nAlthough not explicitly written in these steps, I also recommend restarting R frequently in the development process (Session -> Restart R or Ctrl + Shift + F10) in order to test your package in a clean environment.\r\nAcknowledgements\r\nThank you R-Ladies Philly for hosting this workshop! Chun Su kindly created the thumbnail image for this workshop, as well as provided feedback on this post and the workshop content (thank you for so generously sharing your time!). On R-Ladies slack, Mayra Valdés exchanged some ideas with me regarding different ways to write the compute_corr function and Jenny Bryan helped me better understand where {{ lives and how it works. I learned much of this content from attending the rstudio::conf2020 Building Tidy Tools workshop co-instructed by Charlotte Wickham and Hadley Wickham. Shout out to Hillary Parker for showing us all how to build packages from scratch in 2014.\r\nIn the compute_corr function we failed to specify that the cor.test function is from the stats package (which is loaded by default on start up). Update the compute_corr function with stats::cor.test, and then devtools::check() again. The notes regarding no visible binding… remain; solve with the .data pronoun. (1) Add rlang to your DESCRIPTION file with usethis::use_package(\"rlang\"). (2) Include #' @importFrom rlang .data in the Roxygen section of your function documentation. (3) In the compute_corr function, replace estimate with .data$estimate and p.value with .data$p.value. Here is the link to the error, warning, and note free ralph package on github.↩︎\r\n",
    "preview": "posts/2020-10-25-your-first-r-package-in-1-hour/workshop_thumnnail4.jpg",
    "last_modified": "2020-12-23T22:19:56-05:00",
    "input_file": {}
  },
  {
    "path": "posts/2020-09-22-exporting-editable-ggplot-graphics-to-powerpoint-with-officer-and-purrr/",
    "title": "Exporting editable ggplot graphics to PowerPoint with officer and purrr",
    "description": "What, why, how, when, and who",
    "author": [
      {
        "name": "Shannon Pileggi",
        "url": {}
      }
    ],
    "date": "2020-09-22",
    "categories": [],
    "contents": "\r\nTable of Contents\r\nTL; DR\r\nWhat is an editable PowerPoint graphic?\r\nWhy should I create it?\r\nHow do I create it?\r\nWhen should I do this more efficiently?\r\nWho should do the editing?\r\nLimitations\r\nSummary\r\nAppendix\r\nAcknowledgments\r\nTL; DR\r\nThe officer and rvg packages can be used to create PowerPoint slides with editable ggplot graphics. Skip to creating a single PowerPoint slide or to efficiently exporting multiple PowerPoint graphics with purrr.\r\nWhat is an editable PowerPoint graphic?\r\nAn editable PowerPoint graphic that is created within PowerPoint consists of two sets of editable components:\r\nVarious features of the graphic are editable, including items like size, color, and font (see Gif 1).\r\nThe data behind the graphic are editable (see Gif 2). This means that you can open the table linked to the chart and manually edit it in order to alter the data displayed in the graphic.\r\nAn editable PowerPoint graphic constructed in R through the officer + rvg functions described here produce vector graphics (i.e., shapes). This permits editing various features of the graphic (e.g., color, size), but not the data behind it (no linked table is created).\r\nWhy should I create it?\r\nIn my line of work, the primary deliverable is a PowerPoint slide deck. When creating an R graphic for a slide deck, I could export the graphic as an image (like a .png) to be inserted into PowerPoint, or I can export the graphic directly to an editable PowerPoint slide. Both of these options have pros and cons.\r\nFeature\r\nPowerPoint editable graphic\r\nImage (e.g., .png)\r\nEditability\r\n👍\r\n👎\r\nResizing\r\n👎\r\n👍\r\nData table\r\n👎\r\n👎\r\nThe editable PowerPoint graphic allows for direct editing in PowerPoint, but re-sizes poorly when done manually within PowerPoint. A .png image does not allow for direct editing within PowerPoint, but does nicely retain image ratios when re-sizing. Lastly, neither method produces a linked data table behind the graphic for editing.\r\nHow do I create it?\r\n\r\n\r\nlibrary(tidyverse)\r\nlibrary(here)\r\nlibrary(glue)\r\nlibrary(officer)\r\nlibrary(rvg)\r\nlibrary(viridis)\r\n\r\nFirst, let’s create a quick graphic for demonstration purposes using ggplot2::diamonds. We subset the data on specific values of color and clarity and produce a scatter plot showing the relationship between price and carat.\r\n\r\n\r\np <- diamonds %>% \r\n  filter(color == \"D\" & clarity == \"I1\") %>% \r\n  ggplot(aes(x = carat, y = price, color = cut)) +\r\n    geom_point() +\r\n    theme_minimal() +\r\n    ggtitle(\"Color: D; Clarity: I1\")\r\n\r\n\r\n\r\np\r\n\r\n\r\nIn order to export this graphic to an editable PowerPoint slide, first use the rvg package to convert the object to class dml (required to make graphic editable).\r\n\r\n\r\np_dml <- rvg::dml(ggobj = p)\r\n\r\nThen export the dml object to a PowerPoint slide with officer.\r\n\r\n\r\n# initialize PowerPoint slide ----\r\nofficer::read_pptx() %>%\r\n  # add slide ----\r\n  officer::add_slide() %>%\r\n  # specify object and location of object ----\r\n  officer::ph_with(p_dml, ph_location()) %>%\r\n  # export slide -----\r\n  base::print(\r\n    target = here::here(\r\n      \"_posts\",\r\n      \"2020-09-22-exporting-editable-ggplot-graphics-to-powerpoint-with-officer-and-purrr\",\r\n      \"slides\",\r\n      \"demo_one.pptx\"\r\n    )\r\n  )\r\n\r\nHere is a screen shot of the resulting PowerPoint slide, or you can download demo_one.pptx.\r\n\r\nWhen should I do this more efficiently?\r\nThere are 56 combinations of color and clarity in the diamonds data set; naturally, your colleague wants all 56 plots (at least for the appendix of the report 😂). So we definitely want an efficient way to do this!\r\nAutomate many plots\r\nThis work follows up on blog posts by Laurens Geffert, Len Kiefer, and Bruno Rodrigues, which were fantastic resources to help me get started. The officer package enacted changes in version 0.3.11(?) which necessitate updates to these methods (see Acknowledgements). In addition, Amber Thomas outlined a purrr work flow that resonates with me.\r\nI start with a table outlining the 56 combinations of color and clarity.\r\n\r\n\r\n# tibble of all possible combinations ----\r\ndiamonds_grid <- diamonds %>% \r\n  count(color, clarity) %>% \r\n  # for mapping, we need input values to be character ----\r\n  mutate_all(as.character)\r\n\r\n\r\n\r\n# view values of grid ----\r\ndiamonds_grid\r\n\r\n# A tibble: 56 x 3\r\n   color clarity n    \r\n   <chr> <chr>   <chr>\r\n 1 D     I1      42   \r\n 2 D     SI2     1370 \r\n 3 D     SI1     2083 \r\n 4 D     VS2     1697 \r\n 5 D     VS1     705  \r\n 6 D     VVS2    553  \r\n 7 D     VVS1    252  \r\n 8 D     IF      73   \r\n 9 E     I1      102  \r\n10 E     SI2     1713 \r\n# ... with 46 more rows\r\n\r\nThen I create a function that produces the plot for any given combination of color and clarity. As ggplot produces plots for the available data, there are some additional updates to this function to maintain consistency across all plots. We use a named color vector to create consistency in plotting colors across all plots, in addition to enforcing consistency in the x and y plotting ranges.\r\n\r\n\r\n# named vector for the colors assigned to cut ----\r\n# values are the colors assigned ----\r\ncolor_cut <- viridis::viridis(5) %>% \r\n  # assign levels of cut as names to colors ----\r\n  rlang::set_names(levels(diamonds[[\"cut\"]]))\r\n\r\n\r\n\r\n# view named color vector ----\r\ncolor_cut\r\n\r\n       Fair        Good   Very Good     Premium       Ideal \r\n\"#440154FF\" \"#3B528BFF\" \"#21908CFF\" \"#5DC863FF\" \"#FDE725FF\" \r\n\r\n\r\n\r\n# function to produce scatter plot of carat and price for given values of color and clarity ----\r\nplot_diamonds <- function(this_color, this_clarity){\r\n  diamonds %>% \r\n    filter(color == this_color & clarity == this_clarity) %>% \r\n    ggplot(aes(x = carat, y = price, color = cut)) +\r\n      geom_point() +\r\n      theme_minimal() +\r\n      # maintain consistent plot ranges ----\r\n      xlim(range(diamonds[[\"carat\"]])) +\r\n      ylim(range(diamonds[[\"price\"]])) +\r\n      # maintain consistent colors for cut ----\r\n      # show all values of cut in legend, regardless if appear in this plot ----\r\n      scale_color_manual(values = color_cut, drop = F) +\r\n      # title indicates which combination is plotted ----\r\n      ggtitle(glue::glue(\"Color: {this_color}; Clarity: {this_clarity}\")) \r\n\r\n}\r\n\r\nNext I utilize the plot_diamonds function with purrr to create a list with 56 ggplot objects representing all combinations of color and clarity.\r\n\r\n\r\ndiamonds_gg <- purrr::map2(\r\n  # first argument to plot_diamonds function ----\r\n  diamonds_grid[[\"color\"]],\r\n  # second argument to plot_diamonds function ----\r\n  diamonds_grid[[\"clarity\"]],\r\n  # function to map ----\r\n  plot_diamonds\r\n)\r\n\r\nExport many plots\r\nTo export these, I use two helper functions. The first function, create_dml, converts the ggplot objects to dml objects.\r\n\r\n\r\ncreate_dml <- function(plot){\r\n  rvg::dml(ggobj = plot)\r\n}\r\n\r\nApply this function to the list of ggplot objects to create a list of dml objects with the same dimension.\r\n\r\n\r\ndiamonds_dml <- purrr::map(diamonds_gg, create_dml)\r\n\r\nThe second function automates exporting all slides to PowerPoint, with some additional options to specify the position and size (inches) of the graphic. The default size (9in x 4.95in) produces a graphic that fills a standard sized slide.\r\n\r\n\r\n# function to export plot to PowerPoint ----\r\ncreate_pptx <- function(plot, path, left = 0.5, top = 1, width = 9, height = 4.95){\r\n  \r\n    # if file does not yet exist, create new PowerPoint ----\r\n    if (!file.exists(path)) {\r\n        out <- officer::read_pptx()\r\n    }\r\n    # if file exist, append slides to exisiting file ----\r\n    else {\r\n        out <- officer::read_pptx(path)\r\n    }\r\n  \r\n    out %>% \r\n      officer::add_slide() %>% \r\n      officer::ph_with(plot, location = officer::ph_location(\r\n        width = width, height = height, left = left, top = top)) %>% \r\n      base::print(target = path)\r\n}\r\n\r\nNote that this function opens and closes PowerPoint for each slide created, so more slides will take longer to export. This particular set of graphics took ~6 minutes to export due to the number of slides and the number of points on some slides 😬 (which is longer than usual for my typical applications).\r\n\r\n\r\npurrr::map(\r\n  # dml plots to export ----\r\n  diamonds_dml, \r\n  # exporting function ----\r\n  create_pptx, \r\n  # additional fixed arguments in create_pptx ----\r\n  path = here::here(\r\n    \"_posts\", \r\n    \"2020-09-22-exporting-editable-ggplot-graphics-to-powerpoint-with-officer-and-purrr\",\r\n    \"slides\", \r\n    \"demo_many.pptx\"\r\n    )\r\n  )\r\n\r\nHere is a screen shot of the resulting PowerPoint slide, or you can download demo_many.pptx.\r\n\r\nWho should do the editing?\r\nNow that you have editable PowerPoint slides, you have two parties capable of editing the graphics: (1) the R developer, and (2) the collaborator.\r\nThe R developer should do further slide editing when:\r\nedits are universal (i.e., reduce size of all plots to 6in x 3in).\r\nedits are data driven (i.e., represent all points where carat exceeds a value of 3 as a star)\r\nThe collaborator should do further slide editing when:\r\nedits are bespoke (i.e. Bob wants to see slide 25 in bold for the marketing team)\r\nedits are beyond the budget (i.e., super custom axis adornment)\r\nLimitations\r\nWhile the graphics exported to PowerPoint from R are editable, they do have limitations compared to graphics created within PowerPoint.\r\nAs previously mentioned, there is no linked data table behind the graphics, which can be unnerving for a colleague who wants to quality check the figure (I often export labeled and unlabeled versions of figures for this).\r\nThe points are not naturally grouped features as they would be for graphics created within PowerPoint. This means that if your colleagues wants to change the shade of yellow for the ideal cut diamonds they would have to click on each and every single yellow point in all slides (see Gif 3 for preview of what the slide looks like when you click around).\r\nSummary\r\nEditable PowerPoint ggplot graphics created through officer + rvg + purrr can be a great way to provide your colleague with fantastic graphics while still allowing them to refine the graphics with their own finishing touches. Do expect a lot of iteration on the graphic to get it as close as possible to their needs before you hit that final send on the PowerPoint deck.\r\nAppendix\r\nGif 1\r\nDemonstration of editable features in graphic created within PowerPoint. Notice that the points are automatically grouped together. Go back to What is an editable PowerPoint graphic?.\r\n\r\nGif 2\r\nDemonstration of editable data table behind graphic created within PowerPoint. Go back to What is an editable PowerPoint graphic?.\r\n\r\nGif 3\r\nDemonstration of editing title and single point color in graphic exported to PowerPoint by rvg + officer (notice points are not grouped). Go back to Limitations.\r\n\r\nAcknowledgments\r\nThe create_pptx function was modified from Bruno Rodrigues. My colleague Tom Nowlan figured out the function updates for officer::ph_with (formerly officer::ph_with_vg) to export figures to a specific size and location. Thumbnail artwork was adapted from @allison_horst.\r\n\r\n\r\n",
    "preview": "posts/2020-09-22-exporting-editable-ggplot-graphics-to-powerpoint-with-officer-and-purrr/data_cowboy_officer.png",
    "last_modified": "2020-12-23T22:19:56-05:00",
    "input_file": {},
    "preview_width": 678,
    "preview_height": 382
  },
  {
    "path": "posts/2020-09-07-introducing-the-rstudio-ide-and-r-markdown/",
    "title": "Introducing RStudio and R Markdown",
    "description": "Gettin' giffy wit it.",
    "author": [
      {
        "name": "Shannon Pileggi",
        "url": {}
      }
    ],
    "date": "2020-09-07",
    "categories": [],
    "contents": "\r\nTable of Contents\r\nTL; DR\r\nBackground\r\nCustomizing the interface\r\nAdjusting panels\r\nRe-arrange panels\r\nRecover lost panels\r\nFont size/resolution\r\nPersonalization\r\nMargin column\r\n\r\nR Markdown\r\nOpening a new R Markdown\r\nKnitting an R Markdown\r\nPreview an R Markdown\r\nPersonalizing R Markdown\r\nInserting/splitting code chunks\r\nChunk anatomy\r\nChunk names\r\nChunk execution\r\nChunk options\r\n\r\nR Markdown Troubleshooting\r\nYAML error\r\nChunk error\r\nChunk error for duplicate chunk name\r\nLayout error\r\nR code error\r\n\r\nThe end\r\nAcknowledgments\r\nTL; DR\r\nRStudio has some wonderful features! Here are some tips and tricks for new learneRs to get started with regards to customizing your interface, getting started with R Markdown, and a bit of troubleshooting.\r\nBackground\r\nGif’s were captured in May 2019, likely with RStudio version 1.2.1335-1. Keyboard shortcuts are for Windows users, Mac users may differ. For Windows users, I also recommend changing your default settings to show file extensions.\r\nAnd if you are not familiar with it, please allow me introduce you to Will Smith’s 1998 hit “Gettin’ Jiggy Wit It.” 🎵Na na na na na na na nana 🎵\r\nCustomizing the interface\r\nAdjusting panels\r\n\r\nRe-arrange panels\r\nTools -> Global Options -> Panel Layout\r\n\r\nRecover lost panels\r\n\r\nFont size/resolution\r\nView -> Zoom in / Zoom out / Actual size\r\n\r\nPersonalization\r\nTools -> Global Options -> Appearance\r\n\r\nMargin column\r\nTools -> Global Options -> Code -> Display -> Show margin -> Margin column 80\r\nConsider placing a margin column at 80 characters as a reminder for code formatting. Keeping code within 80 characters can make it easier to read when switching displays or sharing code.\r\n\r\nR Markdown\r\nOpening a new R Markdown\r\nFile -> New file -> R Markdown    or    -> R Markdown\r\n\r\nKnitting an R Markdown\r\n\r\nPreview an R Markdown\r\n\r\nPersonalizing R Markdown\r\n\r\nInserting/splitting code chunks\r\n    or    Ctrl + Alt + I\r\n\r\nChunk anatomy\r\n\r\nChunk names\r\nChunk names allow you to quickly navigate code, automatically name figures, and troubleshoot errors. Chunk names must be unique! If no name is provided, a default numbered chunk name will be assigned.\r\n\r\nChunk execution\r\n    or    Ctrl + Enter\r\n\r\nChunk options\r\n\r\nR Markdown Troubleshooting\r\nYAML error\r\n\r\nChunk error\r\n\r\nChunk error for duplicate chunk name\r\n\r\nLayout error\r\nLet your markdown breathe! If something doesn’t look right, try adding white space.\r\n\r\nR code error\r\n\r\nThe end\r\n\r\n\r\nAcknowledgments\r\nThumbnail artwork adapted from @allison_horst.\r\nThe phrase IDE was removed from the title and body of this post on Sep. 8, 2020 per @TrashBirdEcol’s suggestion.\r\n\r\n\r\n",
    "preview": "posts/2020-09-07-introducing-the-rstudio-ide-and-r-markdown/introducing_resize2.png",
    "last_modified": "2020-12-23T22:19:56-05:00",
    "input_file": {},
    "preview_width": 473,
    "preview_height": 371
  },
  {
    "path": "posts/2020-08-30-a-job-interview-presentation-inspired-by-the-r-community/",
    "title": "A job interview presentation inspired by the R community",
    "description": "How #tidytuesday and twitter helped me secure a job offer",
    "author": [
      {
        "name": "Shannon Pileggi",
        "url": {}
      }
    ],
    "date": "2020-08-30",
    "categories": [],
    "contents": "\r\nTable of Contents\r\nTL; DR\r\nBack up\r\nFormulation\r\nFortuitous tweets\r\nWhat I did\r\nResults\r\nAcknowledgements\r\n\r\nTL; DR\r\nI utilized resources from #tidytuesday, twitter, and blog posts to create a job interview presentation that provided insights on my prospective employer while showcasing my analytics capabilities.\r\nBack up\r\nWhen I was told that my interview at Adelphi Research would involve a presentation, I was pretty happy. A presentation allows the candidate to highlight their strengths, and, after being a college professor for six years, I was confident in my public speaking. The specific presentation instructions were:\r\n\r\nThis can be any 20 minute presentation you’d like to share with the team; our recommendation is that it focuses on Market Research, is something innovative, and something that you’re particularly proud of!\r\n\r\nIt was also briefly mentioned in the phone screening that the analytics group with whom I was interviewing was just beginning to develop shiny applications.\r\nFormulation\r\nThen I faced the dilemma of what to actually present. I wanted to shine as a candidate, but my previous academic experience was tangential to this industry. I took their instructions to heart and decided to create something of which I was truly proud. I developed a project with three goals in mind:\r\nLearn about my prospective employer.\r\nCultivate my nascent tidyverse skills.\r\nInvest in new analytic methods and coding techniques that could serve future me.\r\nFrom there, I had to figure out what I would actually present.\r\nFortuitous tweets\r\nThis was winter 2018, which also happened to be the inaugural year of #tidytuesday. Prompted by David Robinson’s screencast analyzing medium articles with tidytext, I was inspired to apply the same principles of text analysis to my prospective employer’s twitter account.\r\n\r\n\r\nIn this week's #tidytuesday screencast, I use tidytext to analyze what titles get claps on Medium posts. Practical guides on tensorflow/keras are the hottest, words like “marketing”, “trends” and “industry” don't get you far https://t.co/oNhZm40mpW #rstats pic.twitter.com/cxYO2MIIqz\r\n\r\n— David Robinson (@drob) December 4, 2018\r\n\r\nAs I started to create my presentation, I was also concerned with the actual format / deliverable for the presentation. I knew I wanted to create something in R, but I was not quite sure which direction to go. I tweeted an #rstats plea for advice and was inspired by Emily Riederer’s suggestion to use a flexdashboard for the presentation.\r\n\r\n\r\nIf you’re having trouble with xaringan, storyboards in flexdashboqrd can also make pretty nice presentations depending on the type of content / message you are trying to convey https://t.co/IC3moe01v0\r\n\r\n— Emily Riederer (@EmilyRiederer) December 12, 2018\r\n\r\nWhat I did\r\nAfter many hours at the computer, several re-watches of David Robinson’s screencast, and a lot of research on R functions and analytic methods, I created a presentation about my prospective employer based on trends in their twitter account between 2009 (account start date) and 2018 (interview date). Here are the packages that I used, alongside their purpose with links to code on github:\r\nrtweet: retrieve tweets from @AdelphiResearch.\r\ndplyr, forcats, lubridate, stringr, and purrr: create new variables with regards to tweet descriptors and hashtag themes; summarize trends in top hashtags over time\r\nggplot2: exploratory visualization of tweet frequency, trends in likes and re-tweets per tweet, and trends in hashtag themes over time\r\ntidytext: transform tweet words to analyzable tokens; prepare words for modeling\r\nwidyr, igraph, ggraph: network analysis of common hashtag themes and tweet text\r\nglmnet: lasso model to assess word associations with likes and retweets\r\nshiny: develop shiny apps to search tweets and explore the network analyses\r\nflexdashboard: assemble it all in a presentation\r\nYes, it was a lot! Especially because the tidyverse, pulling tweets, text analysis, network analysis, lasso models, flexdashboards, and shiny apps were all very new to me.\r\nResults\r\nI hosted my presentation and the two shiny applications on shinyapps.io, and I made my code publicly available on github.\r\nLink \r\nPreview \r\nInterview presentation\r\n\r\nShiny app for tweet look up\r\n\r\nShiny app for network analysis\r\n\r\nCode on github\r\n\r\nIn the end, I got the job! Along the way, I gleaned insights about the values and industry of my prospective employer, empowering me throughout the interview process. Additionally, my interviewers enjoyed the external data-driven view of their company’s tweets (despite, or perhaps because of, the fact that none of them were actually on twitter).\r\nI embraced the interview as an opportunity to create my own side project to foster new skills that would serve me for other potential interviews, personal projects, or work projects. Yes, I probably could have secured a job offer with less effort, but I would have been less confident and I would have missed out on so many data and programming approaches that are now ingrained in my thought processes. And enabled by the #rstats twitter presence, the incredible packages that I used, and the numerous blog posts that I referenced, I had fun. Cheers, R! 🥂\r\nAcknowledgements\r\nThumbnail artwork by @allison_horst. Thanks to Megan McClintock (my sister) for feedback and suggestions.\r\n\r\n\r\n",
    "preview": "posts/2020-08-30-a-job-interview-presentation-inspired-by-the-r-community/welcome_to_rstats_twitter.png",
    "last_modified": "2020-12-23T22:19:55-05:00",
    "input_file": {},
    "preview_width": 2009,
    "preview_height": 1942
  },
  {
    "path": "posts/2018-12-11-stringr-4-ways/",
    "title": "Stringr 4 ways",
    "description": "Four approaches to feature engineering with regular expressions in R",
    "author": [
      {
        "name": "Shannon Pileggi",
        "url": {}
      }
    ],
    "date": "2018-12-11",
    "categories": [],
    "contents": "\r\nUpdate May 22, 2019: Thanks to @hglanz for noting that I could have used pull instead of the . as a placeholder.\r\n\r\n\r\nlibrary(tidyverse) # general use\r\nlibrary(titanic)   # to get titanic data set\r\n\r\nOverview\r\nThe Name variable in the titanic data set has all unique values. To get started, let’s visually inspect a few values.\r\n\r\n\r\ntitanic_train %>% \r\n  select(Name) %>% \r\n  head(10)\r\n\r\n                                                  Name\r\n1                              Braund, Mr. Owen Harris\r\n2  Cumings, Mrs. John Bradley (Florence Briggs Thayer)\r\n3                               Heikkinen, Miss. Laina\r\n4         Futrelle, Mrs. Jacques Heath (Lily May Peel)\r\n5                             Allen, Mr. William Henry\r\n6                                     Moran, Mr. James\r\n7                              McCarthy, Mr. Timothy J\r\n8                       Palsson, Master. Gosta Leonard\r\n9    Johnson, Mrs. Oscar W (Elisabeth Vilhelmina Berg)\r\n10                 Nasser, Mrs. Nicholas (Adele Achem)\r\n\r\nIn this brief print out, each passenger’s title is consistently located between , and .. Luckily, this holds true for all observations! With this consistency, we can somewhat easily extract a title from Name. Depending on your field, this operation may be referred to something along the lines of data preparation or feature engineering.\r\nTL; DR\r\nApproach\r\nFunction(s)\r\nRegular expression(s)\r\n1\r\nstr_locate + str_sub\r\n\",\" + \"\\\\.\"\r\n2\r\nstr_match\r\n\"(.*)(, )(.*)(\\\\.)(.*)\"\r\n3\r\nstr_extract + str_sub\r\n\"([A-z]+)\\\\.\"\r\n4\r\nstr_replace_all\r\n\"(.*, )|(\\\\..*)\"\r\nRead on for explanations!\r\nOverview of regular expressions\r\nRegular expressions can be used to parse character strings, which you can think of as a key to unlock string patterns. The trick is identify the right regular expression + function combination. Let’s demo four ways to tackle the challenge utilizing functions from the stringr package; each method specifies a different string pattern to match.\r\n\r\n\r\nlibrary(stringr)\r\n\r\nExtracting title from name\r\nFirst approach\r\nICYMI, the double bracket in titanic_train[[\"Name\"]] is used to extract a named variable vector from a data frame, which has some benefits over the more commonly used dollar sign (i.e., titanic_train$Name). Now onward.\r\nThe str_locate function produces the starting and ending position of a specified pattern. If we consider the comma to be a pattern, we can figure out where it is located in each name. Here, the starting and ending value is the same because the comma is only one character.\r\n\r\n\r\ntitanic_train[[\"Name\"]] %>% \r\n  str_locate(\",\") %>%\r\n  head()\r\n\r\n     start end\r\n[1,]     7   7\r\n[2,]     8   8\r\n[3,]    10  10\r\n[4,]     9   9\r\n[5,]     6   6\r\n[6,]     6   6\r\n\r\nKnowing this, we can identify the positions of the comma and the period and then extract the text in between. Some notes here:\r\nBecause str_locate function returns a matrix, we use . as a placeholder in .[,1] to access the first column of values.\r\nBecause . is a special character in regular expressions, we use the double backslash in \"\\\\.\" to escape it.\r\n\r\n\r\ncomma_pos <- titanic_train[[\"Name\"]] %>% \r\n  str_locate(\",\") %>% \r\n  .[,1]\r\n\r\nperiod_pos <- titanic_train[[\"Name\"]] %>% \r\n  str_locate(\"\\\\.\") %>% \r\n  .[,1]\r\n\r\nNow we can use str_sub to extract substrings from the character vector based on their physical position. To exclude the punctuation and white space, we can add two to the comma position and subtract one from the period position to get the title only.\r\n\r\n\r\ntitanic_train[[\"Name\"]] %>% \r\n  str_sub(comma_pos + 2, period_pos - 1) %>% \r\n  head()\r\n\r\n[1] \"Mr\"   \"Mrs\"  \"Miss\" \"Mrs\"  \"Mr\"   \"Mr\"  \r\n\r\nSuper!\r\nSecond approach\r\nThe str_match function creates a character matrix for each group matched in the specified pattern. With the correct regular expression, str_match returns the complete match in addition to each matched group. Here’s a quick example:\r\n\r\n\r\n# ----------5 groups-->>>----1---2---3----4---5----                      \r\nstr_match(\"XXX, YYY. ZZZ\", \"(.*)(, )(.*)(\\\\.)(.*)\")\r\n\r\n     [,1]            [,2]  [,3] [,4]  [,5] [,6]  \r\n[1,] \"XXX, YYY. ZZZ\" \"XXX\" \", \" \"YYY\" \".\"  \" ZZZ\"\r\n\r\nLet’s break down this regular expression pattern.\r\nThe parentheses () indicate a grouping\r\nThe 2nd grouping (, ) only has one modification from the pattern used in the first example - here we include a space after the comma.\r\nThe 4th grouping (\\\\.) remains unchanged from the first example.\r\nin the 1st, 3rd, and 5th grouping (.*)\r\nThe period . means any character\r\nThe asterisk * means matches at least 0 times\r\n\r\nTo execute this, we’ll grab the 4th column to catch our title.\r\n\r\n\r\ntitanic_train[[\"Name\"]] %>% \r\n  str_match(\"(.*)(, )(.*)(\\\\.)(.*)\") %>%\r\n  .[,4] %>% \r\n  head()\r\n\r\n[1] \"Mr\"   \"Mrs\"  \"Miss\" \"Mrs\"  \"Mr\"   \"Mr\"  \r\n\r\nAll right, we got it again!\r\nThird approach\r\nLastly, let’s use the str_extract function to extract matching patterns. This seems like what we wanted to do all along!\r\n\r\n\r\ntitanic_train[[\"Name\"]] %>% \r\n  str_extract(\"([A-z]+)\\\\.\") %>%\r\n  head()\r\n\r\n[1] \"Mr.\"   \"Mrs.\"  \"Miss.\" \"Mrs.\"  \"Mr.\"   \"Mr.\"  \r\n\r\nLet’s break down this regular expression:\r\nHere, the bracket []specifies a list of permitted characters.\r\nInside the bracket, we specify strings that consist of both upper and lower case letters with A-z.\r\nThe + outside the bracket signifies “match at least one time”, i.e., grab all the letters.\r\nFinally, ending in \\\\. indicates that our pattern should end in period.\r\nPutting it all together, this pattern translates to “grab all upper case and lower case letters immediately preceeding a period.”\r\nThis pattern is a bit more sophisticated to compose than the previous ones, but it gets right to the point! This last effort does end in a period, whereas the others do not. If we wanted to remove the period for consistency, we could use str_sub with the end argument to specify the position of the last character.\r\n\r\n\r\ntitanic_train[[\"Name\"]] %>% \r\n  str_extract(\"([A-z]+)\\\\.\") %>%\r\n  str_sub(end = -2) %>%\r\n  head()\r\n\r\n[1] \"Mr\"   \"Mrs\"  \"Miss\" \"Mrs\"  \"Mr\"   \"Mr\"  \r\n\r\nFourth approach\r\nAs a last approach, we can use str_replace_all to replace all matched patterns with null character values. Here, we specify the pattern and then the replacement string.\r\n\r\n\r\ntitanic_train[[\"Name\"]] %>% \r\n  str_replace_all(\"(.*, )|(\\\\..*)\", \"\") %>%\r\n  head()\r\n\r\n[1] \"Mr\"   \"Mrs\"  \"Miss\" \"Mrs\"  \"Mr\"   \"Mr\"  \r\n\r\nIn this regular expression,\r\nThere are two groupings separated by a vertical pipe | which means “or”.\r\nThe two groupings should look familar:\r\nThe first grouping looks for all characters preceeding a comma space.\r\nThe second grouping looks for all characters following a period.\r\n\r\nPutting it together, if grouping 1 or grouping 2 is satisifed then those character values are replaced with null character values.\r\nRe-classifying entries\r\nNow that we figured out how to extract the title, I’ll utilize the last method and assign title as a variable to the titanic_train data set using the mutate function.\r\n\r\n\r\ntitanic_train <- titanic_train %>%\r\n  mutate(title = str_replace_all(titanic_train[[\"Name\"]], \"(.*, )|(\\\\..*)\", \"\"))\r\n\r\nNow let’s use count to get a frequency table of the titles, with the sort = TRUE option to arrange the results in descending order.\r\n\r\n\r\ntitanic_train %>%\r\n  count(title, sort = TRUE)\r\n\r\n          title   n\r\n1            Mr 517\r\n2          Miss 182\r\n3           Mrs 125\r\n4        Master  40\r\n5            Dr   7\r\n6           Rev   6\r\n7           Col   2\r\n8         Major   2\r\n9          Mlle   2\r\n10         Capt   1\r\n11          Don   1\r\n12     Jonkheer   1\r\n13         Lady   1\r\n14          Mme   1\r\n15           Ms   1\r\n16          Sir   1\r\n17 the Countess   1\r\n\r\nWe can see that there are several infrequent titles occuring only one or two times, and so we should re-classify them. If you want to squeeze the most juice out of your data, try to figure out the historical context and meaning of those titles to create a better classification for them. For now, let’s take the easy way out by just re-classifying them to an other group.\r\nFortunately, the forcats package has an awesome function that let’s us do this quickly: fct_lump. We’re using mutate again to re-classified title. The fct_lump function combines the least frequent values together in an other group, and the n = 6 option specifies to keep the 6 most common values (so the 7th value is other).\r\n\r\n\r\ntitanic_train %>%\r\n  mutate(title = fct_lump(title, n = 6)) %>%\r\n  count(title, sort = TRUE)\r\n\r\n   title   n\r\n1     Mr 517\r\n2   Miss 182\r\n3    Mrs 125\r\n4 Master  40\r\n5  Other  14\r\n6     Dr   7\r\n7    Rev   6\r\n\r\nIf you wanted to explicitly re-code the infrequent titles to something more meaningful than other, look into fct_recode.\r\nSuper, now title is ready to use for analysis!\r\n\r\n\r\n",
    "preview": "posts/2018-12-11-stringr-4-ways/table2.png",
    "last_modified": "2020-12-23T22:19:55-05:00",
    "input_file": {},
    "preview_width": 1010,
    "preview_height": 319
  },
  {
    "path": "posts/2018-11-05-welcome-to-piping-hot-data/",
    "title": "Welcome to Piping Hot Data",
    "description": "What's in a name?",
    "author": [
      {
        "name": "Shannon Pileggi",
        "url": "www.pipinghotdata.com"
      }
    ],
    "date": "2018-11-05",
    "categories": [],
    "contents": "\r\nSo do I have piping hot data or am I piping hot data? Let’s break it down.\r\nPiping Hot Data\r\nWow, my data is piping hot! This connotes exciting, newly released data! I can’t promise that I’ll fulfill this expectation. Let’s just say that I’ll talk about data occasionally, and on special occassions it might even be piping hot.\r\nPiping Hot Data\r\nHere, I am piping my elusive hot data. This is what I was really going for - an ode to the pipe in R:\r\n\r\n%>%\r\n\r\nThe pipe operator simplifies long operations by linking multiple functions simultaneously. Although the coding construct of the pipe has been floating around since the 1970’s, the floodgates didn’t open for R until 2014. I don’t know the exact date, but I do remember the first time I saw those three characters and the sea of emotions that rained down. Confusion. Curiousity. Excitement.\r\nIn just 4 short years, the pipe and its friends in the tidyverse have revolutionized how we code in R, to the point that you may feel illiterate at conferences if you don’t have some baseline understanding - at first. Because the beauty of the pipe is that it streamlines readability of R code, such that even if you have never done it, you can still get the gist of what is going on. So much so that believers are proselytizing “Teach the tidyverse to beginners”!\r\nLet’s lay the pipelines with a quick example using the classic iris data set. To get started, load the tidyverse library and get an overview of the data.\r\n\r\n\r\nlibrary(tidyverse)\r\nglimpse(iris)\r\n\r\nRows: 150\r\nColumns: 5\r\n$ Sepal.Length <dbl> 5.1, 4.9, 4.7, 4.6, 5.0, 5.4, 4.6, 5.0, 4.4,...\r\n$ Sepal.Width  <dbl> 3.5, 3.0, 3.2, 3.1, 3.6, 3.9, 3.4, 3.4, 2.9,...\r\n$ Petal.Length <dbl> 1.4, 1.4, 1.3, 1.5, 1.4, 1.7, 1.4, 1.5, 1.4,...\r\n$ Petal.Width  <dbl> 0.2, 0.2, 0.2, 0.2, 0.2, 0.4, 0.3, 0.2, 0.2,...\r\n$ Species      <fct> setosa, setosa, setosa, setosa, setosa, seto...\r\n\r\nOur simple objective is to compute the mean Sepal.Length for each Species in the data set and then arrange the results in descending order. There are many ways to accomplish this without the tidyverse, but for the sake of side-by-side comparisons I’ll demo this using tidyverse functions first without and then with piping.\r\n\r\n\r\narrange(\r\n  summarise(\r\n    group_by(iris, Species), \r\n    mean = mean(Sepal.Length)\r\n  ), \r\n  desc(mean)\r\n)\r\n\r\n# A tibble: 3 x 2\r\n  Species     mean\r\n  <fct>      <dbl>\r\n1 virginica   6.59\r\n2 versicolor  5.94\r\n3 setosa      5.01\r\n\r\nWithout using pipes, we have to read our code inside to out to understand the operations executed. Our iris data set is buried in the middle of the code, and then the operations performed of group_by, summarise, and arrange spring outward from there (reading up from iris). Now let’s try the same manipulations utilizing piping.\r\n\r\n\r\niris %>% \r\n  group_by(Species) %>% \r\n  summarise(mean = mean(Sepal.Length)) %>%\r\n  arrange(desc(mean))\r\n\r\n# A tibble: 3 x 2\r\n  Species     mean\r\n  <fct>      <dbl>\r\n1 virginica   6.59\r\n2 versicolor  5.94\r\n3 setosa      5.01\r\n\r\nVoilá! It’s clear from the left side of the pipe that all manipulations are done on the iris data set, and it’s clear from the right side of the pipe that the series of operations performed are group_by, summarise, and arrange. Wow, I like the way data flow through those pipes!\r\nWhile the name of this blog gives an nod to the powerful pipe, the pipe isn’t going to permeate every solution to programming challenges. So here is what to expect from Piping Hot Data:\r\nDemo data science tools and methods.\r\nDiscover new data and R packages.\r\nDeliberate data and technical topics.\r\nI hope you enjoy!\r\nAcknowledgements\r\nThumbnail artwork by @allison_horst.\r\n\r\n\r\n",
    "preview": "posts/2018-11-05-welcome-to-piping-hot-data/tidyverse_celestial.png",
    "last_modified": "2020-12-23T22:19:55-05:00",
    "input_file": {},
    "preview_width": 2048,
    "preview_height": 2048
  }
]
