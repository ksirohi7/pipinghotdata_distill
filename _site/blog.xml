<?xml version="1.0" encoding="UTF-8"?>
<rss xmlns:atom="http://www.w3.org/2005/Atom" xmlns:media="http://search.yahoo.com/mrss/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:distill="https://distill.pub/journal/" version="2.0">
  <channel>
    <title>PIPING HOT DATA</title>
    <link>https://www.pipinghotdata.com</link>
    <atom:link href="https://www.pipinghotdata.com/blog.xml" rel="self" type="application/rss+xml"/>
    <description>The personsal website of Shannon Pileggi
</description>
    <generator>Distill</generator>
    <lastBuildDate>Mon, 01 Nov 2021 00:00:00 +0000</lastBuildDate>
    <item>
      <title>Getting started with unit testing in R</title>
      <dc:creator>Shannon Pileggi</dc:creator>
      <link>https://www.pipinghotdata.com/posts/2021-11-01-unit-testing</link>
      <description>


&lt;h1 id="tldr"&gt;TL;DR&lt;/h1&gt;
&lt;p&gt;This blog post accompanies the R-Ladies Philly workshop on Nov 11, 2021 (&lt;a href="https://youtu.be/4bPekjzIYiU" target="_blank_"&gt;recording on YouTube&lt;/a&gt;), where we live coded use of the &lt;code&gt;usethis&lt;/code&gt;, &lt;code&gt;devtools&lt;/code&gt;, &lt;code&gt;testthat&lt;/code&gt;, and &lt;code&gt;covr&lt;/code&gt; packages to automate R package testing. This post complements the recording through highlighting key points, rather than listing all actions.&lt;/p&gt;
&lt;h1 id="abstract"&gt;Abstract&lt;/h1&gt;
&lt;p&gt;In this workshop, Shannon Pileggi and Gordon Shotwell discuss how to get started with unit testing in R, which is formal automated testing of functions within packages. We demonstrate handy functions in &lt;code&gt;usethis&lt;/code&gt; and &lt;code&gt;devtools&lt;/code&gt;, strategies for writing tests, debugging techniques, and broad concepts in function writing that facilitate a smoother testing process.&lt;/p&gt;
&lt;p&gt;This workshop picks up exactly where we left our little &lt;code&gt;ralph&lt;/code&gt; (aka &lt;strong&gt;R&lt;/strong&gt;-&lt;strong&gt;L&lt;/strong&gt;adies &lt;strong&gt;Ph&lt;/strong&gt;illy) package one year ago with &lt;a href="https://www.pipinghotdata.com/posts/2020-10-25-your-first-r-package-in-1-hour/" target="_blank"&gt;‚ÄúYour first R package in 1 hour: Tools that make R package development easy‚Äù&lt;/a&gt;. Participants will get the most out of this workshop if they review those materials in advance, or if they are already familiar with building R packages with &lt;code&gt;devtools&lt;/code&gt; and &lt;code&gt;usethis&lt;/code&gt;.&lt;/p&gt;
&lt;h1 id="packages"&gt;Packages&lt;/h1&gt;
&lt;p&gt;This material was developed using:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class="header"&gt;
&lt;th&gt;Software / package&lt;/th&gt;
&lt;th&gt;Version&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class="odd"&gt;
&lt;td&gt;R&lt;/td&gt;
&lt;td&gt;4.1.1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td&gt;RStudio&lt;/td&gt;
&lt;td&gt;351 ‚ÄúGhost Orchid‚Äù&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td&gt;&lt;code&gt;usethis&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;2.1.2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td&gt;&lt;code&gt;devtools&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;2.4.2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td&gt;&lt;code&gt;testthat&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;3.1.0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td&gt;&lt;code&gt;covr&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;3.5.1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td&gt;&lt;code&gt;broom&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;0.7.9&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td&gt;&lt;code&gt;glue&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;1.4.2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td&gt;&lt;code&gt;magrittr&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;2.0.1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td&gt;&lt;code&gt;purrr&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;0.3.4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td&gt;&lt;code&gt;rlang&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;0.4.12&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h1 id="tool-kit"&gt;Tool kit&lt;/h1&gt;
&lt;p&gt;This table contains the general process functions used in this workshop. Single usage functions only need to be used one time in the development process; multiple usage functions are executed as needed.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class="header"&gt;
&lt;th&gt;Usage&lt;/th&gt;
&lt;th&gt;Function&lt;/th&gt;
&lt;th&gt;Purpose&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class="odd"&gt;
&lt;td&gt;Single&lt;/td&gt;
&lt;td&gt;&lt;code&gt;usethis::use_testthat()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;initialize testing infrastructure&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td&gt;Multiple&lt;/td&gt;
&lt;td&gt;&lt;code&gt;usethis::use_test()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;create a new test file&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;devtools::test()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;execute and evaluate all tests in package&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;covr::report()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;reports test coverage&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;browser()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;debugging: interrupt and inspect function execution&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;devtools::check()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;build package locally and check&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;devtools::load_all()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;load functions in üìÅ &lt;code&gt;R/&lt;/code&gt; into memory&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;usethis::use_r("function")&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;create R script for function&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="odd"&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;usethis::use_package("package")&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;add package dependency&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="even"&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;devtools::document()&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;build and add documentation&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Other resources:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;R package developement &lt;a href="https://rklopotek.blog.uksw.edu.pl/files/2017/09/package-development.pdf" target="_blank"&gt;cheat sheet&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href="https://r-pkgs.org/tests.html" target="_blank"&gt;Ch. 12 Testing&lt;/a&gt; in R packages by Hadley Wickham and Jenny Bryan&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href="https://adv-r.hadley.nz/conditions.html#signalling-conditions" target="_blank"&gt;Ch. 8.2 Signalling conditions&lt;/a&gt; in Advanced R by Hadley Wickham&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href="https://testthat.r-lib.org/" target="_blank"&gt;testthat&lt;/a&gt; package documentation&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;{usethis} &lt;a href="https://usethis.r-lib.org/reference/ui.html" target="_blank"&gt;user interface functions&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href="https://covr.r-lib.org/" target="_blank"&gt;covr&lt;/a&gt; package documentation&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href="https://github.com/hadley/tidy-tools" target="_blank"&gt;Building tidy tools workshop&lt;/a&gt; at &lt;code&gt;rstudio::conf(2019)&lt;/code&gt; by Hadley Wickham and Charlotte Wickham&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Debugging&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;RStudio blog post by Jonathan McPherson &lt;a href="https://support.rstudio.com/hc/en-us/articles/205612627-Debugging-with-the-RStudio-IDE" target="_blank"&gt;Debugging with the RStudio IDE&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href="https://adv-r.hadley.nz/debugging.html" target="_blank"&gt;Ch 22 Debugging&lt;/a&gt; in Advanced R by Hadley Wickham&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Indrajeet Patil‚Äôs curated list of &lt;a href="https://indrajeetpatil.github.io/awesome-r-pkgtools/" target="_blank"&gt;awesome tools to assist R package development&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id="why-unit-test"&gt;Why unit test&lt;/h1&gt;
&lt;p&gt;If you write R functions, then you already test your code. You write a function, see if it works, and iterate on the function until you achieve your desired result. In the package development work flow, it looks something like this:&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img src="https://www.pipinghotdata.com/posts/2021-11-01-unit-testingimg/tidy-tools-workflow-no-unit-testing.PNG" alt="Circle with three blocks: Modify code, reload code (`load_all()`), and explore in console." width="43584" /&gt;
&lt;p class="caption"&gt;
(#fig:original-process)Workflow cycle of function development without automated testing, from 2019 Building Tidy Tools workshop.
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;This process is where most of us likely start, and possibly even stay for a while. But it can be tedious, time consuming, and error-prone to manually check all possible combinations of function inputs and arguments.&lt;/p&gt;
&lt;p&gt;Instead, we can &lt;em&gt;automate&lt;/em&gt; tests with &lt;code&gt;testthat&lt;/code&gt; in a new workflow.&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img src="https://www.pipinghotdata.com/posts/2021-11-01-unit-testingimg/tidy-tools-workflow-testing-1.PNG" alt="Circle with three blocks: Modify code, reload code (`load_all()`), and run automated tests (`test()`)." width="43296" /&gt;
&lt;p class="caption"&gt;
(#fig:test-process-1)Workflow cycle of function development when getting started with automated testing, from 2019 Building Tidy Tools workshop.
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;And once you trust and get comfortable with the tests you have set up, you can speed up the development process even more by removing the reload code step.&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img src="https://www.pipinghotdata.com/posts/2021-11-01-unit-testingimg/tidy-tools-workflow-testing-2.PNG" alt="Circle with two blocks: Modify code and run automated tests (`test()`)." width="43584" /&gt;
&lt;p class="caption"&gt;
(#fig:test-process-2)Workflow cycle of function development when comfortable with automated testing, from 2019 Building Tidy Tools workshop.
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Like anything in programming, there is an up-front time investment in learning this framework and process, but with potentially significant downstream time savings.&lt;/p&gt;
&lt;h1 id="getting-started"&gt;Getting started&lt;/h1&gt;
&lt;p&gt;This post picks up exactly where we left the &lt;code&gt;ralph&lt;/code&gt; package in &lt;a href="https://www.pipinghotdata.com/posts/2020-10-25-your-first-r-package-in-1-hour/#tl-dr" target="_blank_"&gt;Your first R package in 1 hour&lt;/a&gt; in November 2020. In order to keep that as a stand-alone resource, I created a second repo called &lt;code&gt;ralphGetsTested&lt;/code&gt; for this workshop, which was a copy of &lt;code&gt;ralph&lt;/code&gt; as we left it.&lt;/p&gt;
&lt;ol style="list-style-type: decimal"&gt;
&lt;li&gt;If you want to follow along with the unit testing steps and practice yourself, fork and clone the &lt;a href="https://github.com/shannonpileggi/ralph" target="_blank_"&gt;&lt;code&gt;ralph&lt;/code&gt;&lt;/a&gt; repo.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;code&gt;usethis::create_from_github("shannonpileggi/ralph")&lt;/code&gt;&lt;/p&gt;
&lt;ol start="2" style="list-style-type: decimal"&gt;
&lt;li&gt;If you want to see the repository as it stood at the conclusion of the unit testing workshop, fork and clone &lt;a href="https://github.com/shannonpileggi/ralphGetsTested" target="_blank_"&gt;&lt;code&gt;ralphGetsTested&lt;/code&gt;&lt;/a&gt; repo.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;code&gt;usethis::create_from_github("shannonpileggi/ralphGetsTested")&lt;/code&gt;&lt;/p&gt;
&lt;h1 id="keyboard-shortcuts"&gt;Keyboard shortcuts&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;Ctrl + S&lt;/code&gt; for save file&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;Ctrl + Shift + L&lt;/code&gt; for &lt;code&gt;devtools::load_all()&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;Ctrl + Shift + F10&lt;/code&gt; to restart R&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;Ctrl + Shift + T&lt;/code&gt; for &lt;code&gt;devtools::test()&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id="status-of-ralph"&gt;Status of &lt;code&gt;ralph&lt;/code&gt;&lt;/h1&gt;
&lt;p&gt;The little &lt;code&gt;ralph&lt;/code&gt; package has a single, untested function that computes a correlation and returns tidy results.&lt;/p&gt;
&lt;pre class="r"&gt;&lt;code&gt;compute_corr &amp;lt;- function(data, var1, var2){

  # compute correlation ----
  stats::cor.test(
    x = data %&amp;gt;% dplyr::pull({{var1}}),
    y = data %&amp;gt;% dplyr::pull({{var2}})
  ) %&amp;gt;%
  # tidy up results ----
  broom::tidy() %&amp;gt;%
  # retain and rename relevant bits ----
  dplyr::select(
    correlation = .data$estimate,
    pval = .data$p.value
  )

}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Here is an example execution:&lt;/p&gt;
&lt;pre class="r"&gt;&lt;code&gt;compute_corr(data = faithful, var1 = eruptions, var2 = waiting)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;# A tibble: 1 x 2
  correlation      pval
        &amp;lt;dbl&amp;gt;     &amp;lt;dbl&amp;gt;
1       0.901 8.13e-100&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id="part-1-testing-compute_corr"&gt;Part 1: testing &lt;code&gt;compute_corr()&lt;/code&gt;&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;What can we test in &lt;code&gt;compute_corr()&lt;/code&gt;?&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;How much of the function code is covered by tests?&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;How can you test safe user inputs?&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="test-set-up"&gt;(16:30) Test set up&lt;/h2&gt;
&lt;p&gt;To get your package ready for automated testing, submit&lt;/p&gt;
&lt;pre class="r"&gt;&lt;code&gt;usethis::use_testthat()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;From &lt;a href="https://r-pkgs.org/tests.html" target="_blank"&gt;R Packages Ch 12 Testing&lt;/a&gt;, this does three things:&lt;/p&gt;
&lt;ol style="list-style-type: decimal"&gt;
&lt;li&gt;&lt;p&gt;Create a &lt;code&gt;tests/testthat&lt;/code&gt; directory.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Add &lt;code&gt;testthat&lt;/code&gt; to the &lt;code&gt;Suggests&lt;/code&gt; field in the &lt;code&gt;DESCRIPTION&lt;/code&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Create a file &lt;code&gt;tests/testthat.R&lt;/code&gt; that runs all your tests when you execute &lt;code&gt;devtools::check()&lt;/code&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="figure"&gt;
&lt;img src="https://www.pipinghotdata.com/posts/2021-11-01-unit-testingimg/use_testthat.PNG" alt="DESCRIPTION adds `testthat &amp;gt;= 3.0.0 to `Suggests`, console states actions listed above." width="40992" /&gt;
&lt;p class="caption"&gt;
(#fig:use-testthat)(17:54): &lt;code&gt;DESCRIPTION&lt;/code&gt; and console output after submitting &lt;code&gt;usethis::use_testthat()&lt;/code&gt;.
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Note that the edition of &lt;code&gt;testthat&lt;/code&gt; is specified to 3. It is my understanding that this version/edition departs significantly from previous versions, both in function scopes and execution.&lt;/p&gt;
&lt;aside&gt;
Dan Sjoberg shared that when he updated &lt;code&gt;{gtsummary}&lt;/code&gt; from &lt;code&gt;testthat&lt;/code&gt; 2 to 3 with the help of a &lt;a href="https://github.com/ddsjoberg/gtsummary/pull/756" target="_blank"&gt;friendly PR&lt;/a&gt;, the &lt;code&gt;R CMD check&lt;/code&gt; dropped from 40 to 14 minutes. üôå
&lt;/aside&gt;
&lt;h2 id="first-test"&gt;(25:10) First test&lt;/h2&gt;
&lt;p&gt;To create our first test file, submit&lt;/p&gt;
&lt;pre class="r"&gt;&lt;code&gt;usethis::use_test(&amp;quot;compute_corr&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;. Here, we name this file the same as our function name. This creates a new file under &lt;code&gt;tests&lt;/code&gt; -&amp;gt; &lt;code&gt;testthat&lt;/code&gt; named &lt;code&gt;test-compute_corr.R&lt;/code&gt;, and the file pre-populates with an example test that we can replace.&lt;/p&gt;
&lt;p&gt;For our first test, we create an object that contains the expected results of an example function execution, and then we assess the correctness of the output using the &lt;code&gt;testthat::expect_&lt;/code&gt; functions.&lt;/p&gt;
&lt;p&gt;We name the overall test chunk &lt;code&gt;assess_compute_corr&lt;/code&gt; - you can name this whatever would be useful for you to read in a testing log. In this test, we evaluate if the function returns the correct &lt;code&gt;class&lt;/code&gt; of object, in this case, a &lt;code&gt;data.frame&lt;/code&gt;.&lt;/p&gt;
&lt;pre class="r"&gt;&lt;code&gt;test_that(&amp;quot;assess_compute_corr&amp;quot;, {
  expected &amp;lt;- compute_corr(data = faithful, var1 = eruptions, var2 = waiting)
  expect_s3_class(expected, &amp;quot;data.frame&amp;quot;)
})&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now there are two ways to execute the test.&lt;/p&gt;
&lt;ol style="list-style-type: decimal"&gt;
&lt;li&gt;&lt;p&gt;The &lt;code&gt;Run Tests&lt;/code&gt; button ( &lt;img src="https://www.pipinghotdata.com/posts/2021-11-01-unit-testingimg/run-test-gui.PNG" style="width:12.0%" alt="Run tests button in RStudio" /&gt; )on the top right hand side of the testing script executes the tests in this script only (not all tests in the package), and excutes this in a fresh R environment.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Submitting &lt;code&gt;devtools::test()&lt;/code&gt; (or &lt;code&gt;Ctrl + Shift + T&lt;/code&gt;) executes all tests in the package in your global environment.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Here, we submit our first test with the &lt;code&gt;Run Tests&lt;/code&gt; button, and it passes! üéâ&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img src="https://www.pipinghotdata.com/posts/2021-11-01-unit-testingimg/test-expect-class.png" alt="`test-compute_corr.R` shows 1 expectation in `test_that(...)`; `Build` pane on top right hand side shows [FAIL 0 | WARN 0 | SKIP 0 | Pass 1]." width="92160" /&gt;
&lt;p class="caption"&gt;
(#fig:test-expect-class)(29:23) Passing result after submitting the first test with the &lt;code&gt;Run Tests&lt;/code&gt; button.
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Submitting &lt;code&gt;devtools::check()&lt;/code&gt; will also execute all tests in the package, and you will see an error in the log if the test fails.&lt;/p&gt;
&lt;h2 id="test-coverage"&gt;(36:08) Test coverage&lt;/h2&gt;
&lt;p&gt;Now we have added a total of three tests, and we examine our test coverage with&lt;/p&gt;
&lt;pre class="r"&gt;&lt;code&gt;covr::report()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This function requires the package to not be loaded, so restart R (&lt;code&gt;Ctrl + Shift + F10&lt;/code&gt;) prior to execution.&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img src="https://www.pipinghotdata.com/posts/2021-11-01-unit-testingimg/covr-report.png" alt="`test-compute_corr.R` shows 3 expectations in `test_that(...)`; `Build` pane on top right hand side shows [FAIL 0 | WARN 0 | SKIP 0 | Pass 3]; `Viewer` panel on bottom right hand side shows 100% test coverage." width="92160" /&gt;
&lt;p class="caption"&gt;
(#fig:covr-report)(37:05) &lt;code&gt;covr::report()&lt;/code&gt; creates output in viewer showing the percent of code covered by the tests.
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;The percent coverage evaluates the percent of code that was ever executed during through the &lt;code&gt;test_that()&lt;/code&gt; functions. In the viewer panel, click on &lt;code&gt;Files&lt;/code&gt; and then &lt;code&gt;R/compute_corr.R&lt;/code&gt;. The &lt;strong&gt;1&lt;/strong&gt;_x_ on the left hand side counts how many times that line of code has been executed when you ran your test suite.&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img src="https://www.pipinghotdata.com/posts/2021-11-01-unit-testingimg/covr-report-1x.png" alt="In Viewer panel, executed lines of code are highlighted in pale green and marked on left hand side with 1x." width="92160" /&gt;
&lt;p class="caption"&gt;
(#fig:covr-report-1x)(37:19) &lt;code&gt;covr::report()&lt;/code&gt; shows which lines of code were executed, and how many times, as a result of your tests.
&lt;/p&gt;
&lt;/div&gt;
&lt;h2 id="debugging"&gt;(41:27) Debugging&lt;/h2&gt;
&lt;p&gt;At this point, our tests consist of the following:&lt;/p&gt;
&lt;pre class="r"&gt;&lt;code&gt;test_that(&amp;quot;assess_compute_corr&amp;quot;, {
  expected &amp;lt;- compute_corr(data = faithful, var1 = eruptions, var2 = waiting)
  expect_s3_class(expected, &amp;quot;data.frame&amp;quot;)
  expect_equal(dim(expected), c(1,2))
  expect_named(expected, c(&amp;quot;correlation&amp;quot;, &amp;quot;pval&amp;quot;))
  expect_equal(expected[[&amp;quot;correlation&amp;quot;]], 0.901)
})&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;and we executed our tests with &lt;code&gt;Ctrl + Shift + T&lt;/code&gt;.&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img src="https://www.pipinghotdata.com/posts/2021-11-01-unit-testingimg/debugging-1.png" alt="In Viewer panel, we see `names(actual)` is a character vector (`cor`) `names(expected)` is absent." width="92160" /&gt;
&lt;p class="caption"&gt;
(#fig:debugging-1)(42:18) Our first test failure.
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;We first demonstrate some debugging in the console, where we reveal that the &lt;code&gt;correlation&lt;/code&gt; column of the &lt;code&gt;expected&lt;/code&gt; tibble has a &lt;code&gt;"names"&lt;/code&gt; attribute of &lt;code&gt;"corr"&lt;/code&gt;.&lt;/p&gt;
&lt;pre class="r"&gt;&lt;code&gt;str(expected)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;tibble [1 x 2] (S3: tbl_df/tbl/data.frame)
 $ correlation: Named num 0.901
  ..- attr(*, &amp;quot;names&amp;quot;)= chr &amp;quot;cor&amp;quot;
 $ pval       : num 8.13e-100&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Next, we demonstrate an alternative way of arriving at this through use of the &lt;code&gt;browser()&lt;/code&gt; function. To do so,&lt;/p&gt;
&lt;ol style="list-style-type: decimal"&gt;
&lt;li&gt;&lt;p&gt;Insert &lt;code&gt;browser()&lt;/code&gt; into the source of your function.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Load your functions with &lt;code&gt;devtools::load_all()&lt;/code&gt; (Ctrl + Shift + L).&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Execute the function.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="figure"&gt;
&lt;img src="https://www.pipinghotdata.com/posts/2021-11-01-unit-testingimg/browser-1.png" alt="In compute_corr.R source script, we see `browser()` is highlighted in yellow. In console, instead of `&amp;gt;`, we see `Browse[1]&amp;gt;`. We also see a new environment window." width="92160" /&gt;
&lt;p class="caption"&gt;
(#fig:browser-1)(46:31) Now we have entered browser mode.
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Here, this allows you to step into your function with arguments exactly as called. The function is run in a fresh environment, and we can execute the function line be line to see what is happening. In addition, we can see objects as they are evaluated in the environment.&lt;/p&gt;
&lt;p&gt;To resolve the issue:&lt;/p&gt;
&lt;ol style="list-style-type: decimal"&gt;
&lt;li&gt;&lt;p&gt;Stop browser mode with the red &lt;code&gt;Stop&lt;/code&gt; square on the console,&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Modify the source of the function as shown.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;pre class="r"&gt;&lt;code&gt;compute_corr &amp;lt;- function(data, var1, var2){

  # compute correlation ----
  results &amp;lt;- stats::cor.test(
    x = data %&amp;gt;% dplyr::pull({{var1}}),
    y = data %&amp;gt;% dplyr::pull({{var2}})
  ) %&amp;gt;%
  # tidy up results ----
  broom::tidy() %&amp;gt;%
  # retain and rename relevant bits ----
  dplyr::select(
    correlation = .data$estimate,
    pval = .data$p.value
  )

  attr(results$correlation, &amp;quot;names&amp;quot;) &amp;lt;- NULL

  return(results)

}&lt;/code&gt;&lt;/pre&gt;
&lt;ol start="3" style="list-style-type: decimal"&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;devtools::load_all()&lt;/code&gt; (&lt;code&gt;Ctrl + Shift + L&lt;/code&gt;)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;If needed, step into &lt;code&gt;browser()&lt;/code&gt; mode again to confirm or further troubleshoot.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Now, after updating the &lt;code&gt;compute_corr()&lt;/code&gt; function remove the &lt;code&gt;names&lt;/code&gt; attribute, we still have failed test! üò±&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img src="https://www.pipinghotdata.com/posts/2021-11-01-unit-testingimg/debugging-2.png" alt="In the `Build` pane we see a failing test with the note `actual: 0.9008` and `expected: 0.9010`." width="92160" /&gt;
&lt;p class="caption"&gt;
(#fig:debugging-2)(58:02) Now we have a new failure message. Note the &lt;code&gt;debug at&lt;/code&gt; lines in the &lt;code&gt;Build&lt;/code&gt; pane indicate that I forgot to remove the &lt;code&gt;browser()&lt;/code&gt; line from the source function after our workshop break.
&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;We can correct this by adding the &lt;code&gt;tolerance&lt;/code&gt; argument to the &lt;code&gt;expect_equal()&lt;/code&gt; function.&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img src="https://www.pipinghotdata.com/posts/2021-11-01-unit-testingimg/debugging-3.png" alt="In the `Build` pane we see [FAIL 0 | WARN 0 | SKIP 0 | Pass 4]" width="92160" /&gt;
&lt;p class="caption"&gt;
(#fig:debugging-3)(1:00:14) 4 passing tests!
&lt;/p&gt;
&lt;/div&gt;
&lt;h1 id="question-answer"&gt;Question &amp;amp; Answer&lt;/h1&gt;
&lt;p&gt;This discussion is paraphrased from the workshop recording. It was commented throughout that there is not a right answer to most of this.&lt;/p&gt;
&lt;ol style="list-style-type: decimal"&gt;
&lt;li&gt;&lt;code&gt;(19:50)&lt;/code&gt; When do you write tests?&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;If the function writing is a process of discovery, and you are not sure what the function will do, write the test after the function is in a stable state. In other cases, when you know precisely how you want the function to behave, writing the test before you write the function could be a useful approach (test driven development).&lt;/p&gt;
&lt;ol start="2" style="list-style-type: decimal"&gt;
&lt;li&gt;&lt;code&gt;(22:19)&lt;/code&gt; When I start writing tests, I get sucked into a rabbit hole of tests. How can I have a better process for writing tests?&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Have solid tests for things that you really care about as a developer. Most of the time, it is good to write more tests than less. Get a couple of tests down, and as you discover bugs, make sure there is a test for every bug that you fix.&lt;/p&gt;
&lt;ol start="3" style="list-style-type: decimal"&gt;
&lt;li&gt;&lt;code&gt;(23:53)&lt;/code&gt; Is it fair to say that you should consider problems that tripped you up when building the function as good test candidates?&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Yeah, for sure! If you make the mistake as you are writing the function, you are likely to make the mistake again in six months, so a test will keep you honest on those problems.&lt;/p&gt;
&lt;ol start="4" style="list-style-type: decimal"&gt;
&lt;li&gt;&lt;code&gt;(32:50)&lt;/code&gt; Can we write test that statements with more descriptive errors?&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Think of &lt;code&gt;test_that()&lt;/code&gt; as a paragraph break to keep related expectations together (Gordon), and give the test a brief but evocative name - you do you (from the &lt;code&gt;test_that()&lt;/code&gt; help file). There are also &lt;code&gt;expect_error()&lt;/code&gt; and &lt;code&gt;expect_warning()&lt;/code&gt; functions.&lt;/p&gt;
&lt;ol start="5" style="list-style-type: decimal"&gt;
&lt;li&gt;&lt;code&gt;(37:00)&lt;/code&gt; How is the percent coverage from &lt;code&gt;covr::report()&lt;/code&gt; calculated?&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;This evaluates which lines of code have been executed for that test. It is not necessarily evaluating if the function is tested well, but rather has this line of code ever been run by your test suite.&lt;/p&gt;
&lt;ol start="6" style="list-style-type: decimal"&gt;
&lt;li&gt;&lt;code&gt;(38:10)&lt;/code&gt; You mentioned earlier that when you fix a bug, that is a good time to write a test. Do you have an example of doing this?&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Yes! I develop and maintain packages for internal R users, and a common application of this for me is when a user calls the function in a reasonable way and gets a really unfriendly error message. I resolve this through writing a better error message for the function and then include that as a test with &lt;code&gt;expect_error()&lt;/code&gt;.&lt;/p&gt;
&lt;ol start="7" style="list-style-type: decimal"&gt;
&lt;li&gt;&lt;code&gt;(39:27)&lt;/code&gt; How is running tests different than trying out different data types and sets on your function and debugging?&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;It is not different at all! What I have learned from being around other&lt;br /&gt;
talented programmers is that they don‚Äôt have amazing brains that they can hold all these different variables in. They are able to write good software by exporting the normal checks that everyone does when writing functions into a formal set of expectations that you can get a computer to run. Testing is about getting that stuff out of your brain so that a computer can execute it.&lt;/p&gt;
&lt;ol start="8" style="list-style-type: decimal"&gt;
&lt;li&gt;&lt;code&gt;(53:50)&lt;/code&gt; Do you have advice on how to choose the data to feed into the expected object?&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;You can choose data from base R to minimize package dependencies, write small in-line data, or use your own specific data that that you add to your package. Also consider data that get to the extreme corners of your function (e.g., missing data, weird values). ‚ÄúThrow lizards at your function!‚Äù&lt;/p&gt;
&lt;ol start="9" style="list-style-type: decimal"&gt;
&lt;li&gt;&lt;code&gt;(55:57)&lt;/code&gt; Do you commonly see test that used against a script instead of a function?&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;You can use &lt;code&gt;expect_equal()&lt;/code&gt; in scripts, but there are packages like &lt;code&gt;{assertr}&lt;/code&gt; which might be more appropriate for R scripts.&lt;/p&gt;
&lt;h1 id="personal-reflection"&gt;Personal reflection&lt;/h1&gt;
&lt;h1 id="acknowledgements"&gt;Acknowledgements&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;Thank Gordon&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id="notes"&gt;Notes&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;devtools::check()&lt;/code&gt; confirm error free&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;devtools::load_all()&lt;/code&gt; command shift L&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;?compute_corr&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;compute_corr(data = faithful, var1 = eruptions, var2 = waiting)&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;review function&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;usethis::use_testthat()&lt;/code&gt; to create overall testing infrastructure - ONE TIME&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;usethis::use_test("compute_corr")&lt;/code&gt; to create a new test file&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;WHAT TO NAME THIS FILE? - same as function name&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;WHAT TO NAME TESTS IN THIS FILE?&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;It can be whatever also the name can have spaces. It‚Äôs just something that tells you what failed when the test fails&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;So there‚Äôs no right name, it‚Äôs just something that reminds future you where the failing test is&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;tests define correctness for your code - what do i care that is right?&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;higher risk would do more tests&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;to run tests &lt;code&gt;devtools::test()&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;run tests button runs test in fresh environment; devtools test in global environment&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;browser() in function for troubleshooting&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;covr::report&lt;/code&gt; percent of code covered&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;restart R, then run&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;THIS ISNT WORKING&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;covr::report&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;put &lt;code&gt;browser()&lt;/code&gt; in function for debugging - NOT IN A PIPE&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;to test variables in input data set, create a message/warning &amp;amp; test for that message/warning&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Restart R -&amp;gt; cntrl + shift + F10&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id="testing-code"&gt;Testing code&lt;/h1&gt;
&lt;p&gt;To enter one at a time.&lt;/p&gt;
&lt;pre class="r"&gt;&lt;code&gt;test_that(&amp;quot;length&amp;quot;, {
  expected &amp;lt;- compute_corr(data = faithful, var1 = eruptions, var2 = waiting)
  expect_s3_class(expected, &amp;quot;data.frame&amp;quot;)
  expect_equal(dim(expected), c(1,2))
  expect_named(expected, c(&amp;quot;correlation&amp;quot;, &amp;quot;pval&amp;quot;))
  # can run without tolerance
  expect_equal(expected[[&amp;quot;correlation&amp;quot;]], 0.901, tolerance = 0.001)
})&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Correction to add to &lt;code&gt;compute_corr&lt;/code&gt; for &lt;code&gt;expect_equal&lt;/code&gt; to pass:&lt;/p&gt;
&lt;pre class="r"&gt;&lt;code&gt;# remove attribute name from results
attr(results$correlation, &amp;quot;names&amp;quot;) &amp;lt;- NULL&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id="distinguishing-messagewarningerror"&gt;Distinguishing message/warning/error:&lt;/h1&gt;
&lt;p&gt;&lt;a href="https://adv-r.hadley.nz/conditions.html#signalling-conditions" class="uri"&gt;https://adv-r.hadley.nz/conditions.html#signalling-conditions&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Error to add to &lt;code&gt;compute_corr&lt;/code&gt; to evaluate inputs:&lt;/p&gt;
&lt;p&gt;Errors are the most severe; they indicate that there is no way for a function to continue and execution must stop.&lt;/p&gt;
&lt;p&gt;Warnings fall somewhat in between errors and message, and typically indicate that something has gone wrong but the function has been able to at least partially recover.&lt;/p&gt;
&lt;p&gt;Messages are the mildest; they are way of informing users that some action has been performed on their behalf.&lt;/p&gt;
&lt;pre class="r"&gt;&lt;code&gt;stop(&amp;quot;This is what an error looks like&amp;quot;)
#&amp;gt; Error in eval(expr, envir, enclos): This is what an error looks like

warning(&amp;quot;This is what a warning looks like&amp;quot;)
#&amp;gt; Warning: This is what a warning looks like

message(&amp;quot;This is what a message looks like&amp;quot;)
#&amp;gt; This is what a message looks like&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id="checking-variable-names"&gt;checking variable names&lt;/h1&gt;
&lt;p&gt;Add to function body:&lt;/p&gt;
&lt;pre class="r"&gt;&lt;code&gt;  # convert variable names to character strings
  var1_chr &amp;lt;- rlang::as_label(rlang::ensym(var1))
  var2_chr &amp;lt;- rlang::as_label(rlang::ensym(var2))

  # alert user if variable not in data set ----
  if (!(var1_chr %in% names(data))){
    #stop(glue::glue(&amp;quot;{var1_chr} not in data set.&amp;quot;))
    usethis::ui_stop(&amp;quot;{var1_chr} is not in the data set.&amp;quot;)
  }

  # alert user if variable not in data set ----
  if (!(var2_chr %in% names(data))){
    #stop(glue::glue(&amp;quot;{var2_chr} not in data set.&amp;quot;))
    usethis::ui_stop(&amp;quot;{var2_chr} is not in the data set.&amp;quot;)
  }&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Add to test&lt;/p&gt;
&lt;pre class="r"&gt;&lt;code&gt;test_that(&amp;quot;length&amp;quot;, {
  # evaluate correctness of output produced ----
  expected &amp;lt;- compute_corr(data = faithful, var1 = eruptions, var2 = waiting)
  expect_s3_class(expected, &amp;quot;data.frame&amp;quot;)
  expect_equal(dim(expected), c(1,2))
  expect_named(expected, c(&amp;quot;correlation&amp;quot;, &amp;quot;pval&amp;quot;))
  expect_equal(expected[[&amp;quot;correlation&amp;quot;]], 0.901, tolerance = 0.001)
  # catching errors ----
  expect_error(compute_corr(data = faithful, var1 = erruptions, var2 = waiting))
})&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;devtools::test()&lt;/code&gt; passes&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;devtools::check()&lt;/code&gt; has a warning&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;usethis::use_package("usethis")&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;devtools::check()&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id="challenge-function"&gt;Challenge function&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Can we break this up to make it easier to test?&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;What type of object should the function output?&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;What type of object does this function expect, can we put up guardrails so the user doesn‚Äôt send the wrong thing? How do we test those guardrails?&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="original"&gt;original&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;usethis::use_r("awesome_rladies")&lt;/code&gt;&lt;/p&gt;
&lt;pre class="r"&gt;&lt;code&gt;awesome_rladies &amp;lt;- function(v) {
  
  sapply(v, function(x) {
    if (x == 1) {
      verb &amp;lt;- &amp;quot;is&amp;quot;
      noun &amp;lt;- &amp;quot;RLady&amp;quot;
    }
    
    if (x &amp;gt; 1) {
      verb &amp;lt;- &amp;quot;are&amp;quot;
      noun &amp;lt;- &amp;quot;RLadies&amp;quot;
    }
    
    as.character(glue::glue(&amp;quot;There {verb} {x} awesome {noun}!&amp;quot;))
  })
}&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id="broken-up"&gt;broken up&lt;/h2&gt;
&lt;pre class="r"&gt;&lt;code&gt;write_rladies &amp;lt;- function(x){
  if (x == 1) {
    verb &amp;lt;- &amp;quot;is&amp;quot;
    noun &amp;lt;- &amp;quot;RLady&amp;quot;
  } 
  
  if(x &amp;gt; 1) {
    verb &amp;lt;- &amp;quot;are&amp;quot;
    noun &amp;lt;- &amp;quot;RLadies&amp;quot;
  }
  
  as.character(glue::glue(&amp;quot;There {verb} {x} awesome {noun}!&amp;quot;))
}




compose_rladies &amp;lt;- function(x){
  #sapply(x, write_rladies)
  purrr::map_chr(x, write_rladies)
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;usethis::use_test()&lt;/code&gt; to create a second test file, right?&lt;/p&gt;
&lt;h2 id="tests"&gt;tests&lt;/h2&gt;
&lt;pre class="r"&gt;&lt;code&gt;usethis::use_test(&amp;quot;awesome_rladies&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;what to name test?&lt;/p&gt;
&lt;pre class="r"&gt;&lt;code&gt;test_that(&amp;quot;assess-awesome_rladies&amp;quot;, {
  # evaluate output produced ----
  expected &amp;lt;- write_rladies(1)
  expect_type(expected, &amp;quot;character&amp;quot;)
})&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;add to function&lt;/p&gt;
&lt;pre class="r"&gt;&lt;code&gt;write_rladies &amp;lt;- function(x){
  
 if ( !(is.numeric(x) &amp;amp; (x &amp;gt;= 1)) ){
    usethis::ui_stop(&amp;quot;Input must be numeric and greater than or equal to 1.&amp;quot;)
  }

  
  if (x == 1) {
    verb &amp;lt;- &amp;quot;is&amp;quot;
    noun &amp;lt;- &amp;quot;RLady&amp;quot;
  } 
  
  if(x &amp;gt; 1) {
    verb &amp;lt;- &amp;quot;are&amp;quot;
    noun &amp;lt;- &amp;quot;RLadies&amp;quot;
  }
  
  glue::glue(&amp;quot;There {verb} {x} awesome {noun}!&amp;quot;)
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;add to test, need to work through this more&lt;/p&gt;
&lt;pre class="r"&gt;&lt;code&gt;test_that(&amp;quot;correct&amp;quot;, {
  # evaluate output produced ----
  expected_1 &amp;lt;- write_rladies(1)
  expected_2 &amp;lt;- write_rladies(2)
  expect_type(expected_1, &amp;quot;character&amp;quot;)
  expect_equal(expected_1, &amp;quot;There is 1 awesome RLady!&amp;quot;)
  expect_equal(expected_2, &amp;quot;There are 2 awesome RLadies!&amp;quot;)
  # ----
  expected_multiple &amp;lt;- compose_rladies(1:2)
  expect_length(expected_multiple, 2)
  # catching errors ----
  expect_error(compose_rladies(&amp;quot;a&amp;quot;))
  expect_error(compose_rladies(0))
})&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id="testthat-3e"&gt;testthat 3e&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a href="https://testthat.r-lib.org/articles/third-edition.html"&gt;https://testthat.r-lib.org/articles/third-edition.html&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;the checking is a bit different from regular testthat (uses waldo package), and the tests run in parallel (so much faster)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;use first edition if nothing is specified; add this to your DESCRIPTION file&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;Roxygen: list(markdown = TRUE)
RoxygenNote: 7.1.2
Config/testthat/edition: 3
Config/testthat/parallel: true&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;gtsummary check went from 40 min to 14 min&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="r distill-force-highlighting-css"&gt;&lt;code&gt;&lt;/code&gt;&lt;/pre&gt;</description>
      <distill:md5>8edaa5480be9b16020103993bae8513d</distill:md5>
      <guid>https://www.pipinghotdata.com/posts/2021-11-01-unit-testing</guid>
      <pubDate>Mon, 01 Nov 2021 00:00:00 +0000</pubDate>
    </item>
    <item>
      <title>Estimating correlations adjusted for group membership</title>
      <dc:creator>Shannon Pileggi</dc:creator>
      <link>https://www.pipinghotdata.com/posts/2021-10-11-estimating-correlations-adjusted-for-group-membership</link>
      <description>A linear mixed model approach with applied examples in a Palmer penguins Simpson's paradox and TidyTuesday Spotify songs</description>
      <guid>https://www.pipinghotdata.com/posts/2021-10-11-estimating-correlations-adjusted-for-group-membership</guid>
      <pubDate>Mon, 11 Oct 2021 00:00:00 +0000</pubDate>
      <media:content url="https://www.pipinghotdata.com/posts/2021-10-11-estimating-correlations-adjusted-for-group-membership/img/thumbnail.PNG" medium="image" type="image/png" width="960" height="540"/>
    </item>
    <item>
      <title>Curating for @WeAreRLadies on Twitter</title>
      <dc:creator>Shannon Pileggi</dc:creator>
      <link>https://www.pipinghotdata.com/posts/2021-09-23-curating-for-wearerladies-on-twitter</link>
      <description>From creating content to cultivating connections.</description>
      <guid>https://www.pipinghotdata.com/posts/2021-09-23-curating-for-wearerladies-on-twitter</guid>
      <pubDate>Thu, 23 Sep 2021 00:00:00 +0000</pubDate>
      <media:content url="https://www.pipinghotdata.com/posts/2021-09-23-curating-for-wearerladies-on-twitter/img/arno-smit-iI72r3gSwWY-unsplash.jpg" medium="image" type="image/jpeg"/>
    </item>
    <item>
      <title>A tidyverse pivot approach to data preparation in R</title>
      <dc:creator>Shannon Pileggi</dc:creator>
      <link>https://www.pipinghotdata.com/posts/2021-08-27-a-tidyverse-pivot-approach-to-data-preparation-in-r</link>
      <description>Going from wide to long with #TidyTuesday beach volleyball</description>
      <guid>https://www.pipinghotdata.com/posts/2021-08-27-a-tidyverse-pivot-approach-to-data-preparation-in-r</guid>
      <pubDate>Fri, 27 Aug 2021 00:00:00 +0000</pubDate>
      <media:content url="https://www.pipinghotdata.com/posts/2021-08-27-a-tidyverse-pivot-approach-to-data-preparation-in-r/gatherspread_modified.jpg" medium="image" type="image/jpeg"/>
    </item>
    <item>
      <title>Polished summary tables in R with gtsummary</title>
      <dc:creator>Shannon Pileggi</dc:creator>
      <link>https://www.pipinghotdata.com/posts/2021-07-14-polished-summary-tables-in-r-with-gtsummary</link>
      <description>Also plays well with labelled data</description>
      <guid>https://www.pipinghotdata.com/posts/2021-07-14-polished-summary-tables-in-r-with-gtsummary</guid>
      <pubDate>Wed, 14 Jul 2021 00:00:00 +0000</pubDate>
      <media:content url="https://www.pipinghotdata.com/posts/2021-07-14-polished-summary-tables-in-r-with-gtsummary/r-gtsummary.png" medium="image" type="image/png" width="2540" height="1932"/>
    </item>
    <item>
      <title>Custom interactive sunbursts with ggplot in R</title>
      <dc:creator>Shannon Pileggi</dc:creator>
      <link>https://www.pipinghotdata.com/posts/2021-06-01-custom-interactive-sunbursts-with-ggplot-in-r</link>
      <description>geom_rect() + geom_coord() + {ggiraph}</description>
      <guid>https://www.pipinghotdata.com/posts/2021-06-01-custom-interactive-sunbursts-with-ggplot-in-r</guid>
      <pubDate>Tue, 01 Jun 2021 00:00:00 +0000</pubDate>
      <media:content url="https://www.pipinghotdata.com/posts/2021-06-01-custom-interactive-sunbursts-with-ggplot-in-r/sunburst_preview.PNG" medium="image" type="image/png" width="528" height="475"/>
    </item>
    <item>
      <title>Deploy previews with Netlifly</title>
      <dc:creator>Shannon Pileggi</dc:creator>
      <link>https://www.pipinghotdata.com/posts/2021-04-01-deploy-previews-with-netlifly</link>
      <description>Collaborative {distill} website workflows</description>
      <guid>https://www.pipinghotdata.com/posts/2021-04-01-deploy-previews-with-netlifly</guid>
      <pubDate>Thu, 01 Apr 2021 00:00:00 +0000</pubDate>
      <media:content url="https://www.pipinghotdata.com/posts/2021-04-01-deploy-previews-with-netlifly/img/netlifly-checks.png" medium="image" type="image/png" width="1358" height="704"/>
    </item>
    <item>
      <title>R-Ladies styled code gifs with xaringan and flipbookr</title>
      <dc:creator>Shannon Pileggi</dc:creator>
      <link>https://www.pipinghotdata.com/posts/2021-03-08-r-ladies-styled-code-gifs-with-xaringan-and-flipbookr</link>
      <description>The code behind my @WeAreRLadies curating week</description>
      <guid>https://www.pipinghotdata.com/posts/2021-03-08-r-ladies-styled-code-gifs-with-xaringan-and-flipbookr</guid>
      <pubDate>Mon, 08 Mar 2021 00:00:00 +0000</pubDate>
      <media:content url="https://www.pipinghotdata.com/posts/2021-03-08-r-ladies-styled-code-gifs-with-xaringan-and-flipbookr/walrus-adjusted.png" medium="image" type="image/png" width="1536" height="861"/>
    </item>
    <item>
      <title>GGanimating a geographic introduction</title>
      <dc:creator>Shannon Pileggi</dc:creator>
      <link>https://www.pipinghotdata.com/posts/2021-02-15-gganimating-a-geographic-introduction</link>
      <description>A gif for social media</description>
      <guid>https://www.pipinghotdata.com/posts/2021-02-15-gganimating-a-geographic-introduction</guid>
      <pubDate>Mon, 15 Feb 2021 00:00:00 +0000</pubDate>
      <media:content url="https://www.pipinghotdata.com/posts/2021-02-15-gganimating-a-geographic-introduction/homes_preview.png" medium="image" type="image/png" width="919" height="461"/>
    </item>
    <item>
      <title>From gmailr to the Google Books API</title>
      <dc:creator>Shannon Pileggi</dc:creator>
      <link>https://www.pipinghotdata.com/posts/2021-01-11-from-gmailr-to-the-google-books-api</link>
      <description>A parenting project to catalog my childrens' 2020 library history</description>
      <guid>https://www.pipinghotdata.com/posts/2021-01-11-from-gmailr-to-the-google-books-api</guid>
      <pubDate>Mon, 11 Jan 2021 00:00:00 +0000</pubDate>
      <media:content url="https://www.pipinghotdata.com/posts/2021-01-11-from-gmailr-to-the-google-books-api/preview_books.png" medium="image" type="image/png" width="705" height="459"/>
    </item>
    <item>
      <title>Leveraging labelled data in R</title>
      <dc:creator>Shannon Pileggi</dc:creator>
      <link>https://www.pipinghotdata.com/posts/2020-12-23-leveraging-labelled-data-in-r</link>
      <description>Embracing SPSS, SAS, and Stata data sets with the haven, labelled, and sjlabelled packages</description>
      <guid>https://www.pipinghotdata.com/posts/2020-12-23-leveraging-labelled-data-in-r</guid>
      <pubDate>Wed, 23 Dec 2020 00:00:00 +0000</pubDate>
      <media:content url="https://www.pipinghotdata.com/posts/2020-12-23-leveraging-labelled-data-in-r/labelled_preview.png" medium="image" type="image/png" width="671" height="617"/>
    </item>
    <item>
      <title>Your first R package in 1 hour</title>
      <dc:creator>Shannon Pileggi</dc:creator>
      <link>https://www.pipinghotdata.com/posts/2020-10-25-your-first-r-package-in-1-hour</link>
      <description>Tools that make R package development easy</description>
      <guid>https://www.pipinghotdata.com/posts/2020-10-25-your-first-r-package-in-1-hour</guid>
      <pubDate>Sun, 25 Oct 2020 00:00:00 +0000</pubDate>
      <media:content url="https://www.pipinghotdata.com/posts/2020-10-25-your-first-r-package-in-1-hour/workshop_thumnnail4.jpg" medium="image" type="image/jpeg"/>
    </item>
    <item>
      <title>Exporting editable ggplot graphics to PowerPoint with officer and purrr</title>
      <dc:creator>Shannon Pileggi</dc:creator>
      <link>https://www.pipinghotdata.com/posts/2020-09-22-exporting-editable-ggplot-graphics-to-powerpoint-with-officer-and-purrr</link>
      <description>What, why, how, when, and who</description>
      <guid>https://www.pipinghotdata.com/posts/2020-09-22-exporting-editable-ggplot-graphics-to-powerpoint-with-officer-and-purrr</guid>
      <pubDate>Tue, 22 Sep 2020 00:00:00 +0000</pubDate>
      <media:content url="https://www.pipinghotdata.com/posts/2020-09-22-exporting-editable-ggplot-graphics-to-powerpoint-with-officer-and-purrr/data_cowboy_officer.png" medium="image" type="image/png" width="678" height="382"/>
    </item>
    <item>
      <title>Introducing RStudio and R Markdown</title>
      <dc:creator>Shannon Pileggi</dc:creator>
      <link>https://www.pipinghotdata.com/posts/2020-09-07-introducing-the-rstudio-ide-and-r-markdown</link>
      <description>Gettin' giffy wit it.</description>
      <guid>https://www.pipinghotdata.com/posts/2020-09-07-introducing-the-rstudio-ide-and-r-markdown</guid>
      <pubDate>Mon, 07 Sep 2020 00:00:00 +0000</pubDate>
      <media:content url="https://www.pipinghotdata.com/posts/2020-09-07-introducing-the-rstudio-ide-and-r-markdown/introducing_resize2.png" medium="image" type="image/png" width="473" height="371"/>
    </item>
    <item>
      <title>A job interview presentation inspired by the R community</title>
      <dc:creator>Shannon Pileggi</dc:creator>
      <link>https://www.pipinghotdata.com/posts/2020-08-30-a-job-interview-presentation-inspired-by-the-r-community</link>
      <description>How #tidytuesday and twitter helped me secure a job offer</description>
      <guid>https://www.pipinghotdata.com/posts/2020-08-30-a-job-interview-presentation-inspired-by-the-r-community</guid>
      <pubDate>Sun, 30 Aug 2020 00:00:00 +0000</pubDate>
      <media:content url="https://www.pipinghotdata.com/posts/2020-08-30-a-job-interview-presentation-inspired-by-the-r-community/welcome_to_rstats_twitter.png" medium="image" type="image/png" width="2009" height="1942"/>
    </item>
    <item>
      <title>Stringr 4 ways</title>
      <dc:creator>Shannon Pileggi</dc:creator>
      <link>https://www.pipinghotdata.com/posts/2018-12-11-stringr-4-ways</link>
      <description>Four approaches to feature engineering with regular expressions in R</description>
      <guid>https://www.pipinghotdata.com/posts/2018-12-11-stringr-4-ways</guid>
      <pubDate>Tue, 11 Dec 2018 00:00:00 +0000</pubDate>
      <media:content url="https://www.pipinghotdata.com/posts/2018-12-11-stringr-4-ways/table2.png" medium="image" type="image/png" width="1010" height="319"/>
    </item>
    <item>
      <title>Welcome to Piping Hot Data</title>
      <dc:creator>Shannon Pileggi</dc:creator>
      <link>https://www.pipinghotdata.com/posts/2018-11-05-welcome-to-piping-hot-data</link>
      <description>What's in a name?</description>
      <guid>https://www.pipinghotdata.com/posts/2018-11-05-welcome-to-piping-hot-data</guid>
      <pubDate>Mon, 05 Nov 2018 00:00:00 +0000</pubDate>
      <media:content url="https://www.pipinghotdata.com/posts/2018-11-05-welcome-to-piping-hot-data/tidyverse_celestial.png" medium="image" type="image/png" width="2048" height="2048"/>
    </item>
  </channel>
</rss>
