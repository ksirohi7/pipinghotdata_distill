---
title: "Personal R Administration on Windows"
description: |
  A short description of the post.
author:
  - name: Shannon Pileggi
    url: {}
date: 2022-03-23
output:
  distill::distill_article:
    self_contained: false
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, eval = FALSE)
library(tidyverse)
```


```{r, echo = FALSE, eval = TRUE}
paths <- readxl::read_excel("C:/Users/pileggis/Documents/gh-personal/pipinghotdata_distill/_posts/2022-03-23-personal-r-administration-on-windows/locations.xlsx") %>% 
  mutate(Code = replace_na(Code, ""))
```

# Questions


1. In the table, what descriptions would you assign to the `Home` rows?

2. On Windows OS, is `fs::path_home()` relevant at all to R administration?

3. Do ppl ever manually change/redirect `fs::path_home()` or `fs::path_home_r()`? 
Or are those just always left as default?


# TL;DR



```{r, echo = FALSE, eval = TRUE}
paths %>% 
  gt::gt(
    groupname_col = "Type"
  ) 
```

# Windows

## Recommended settings

When getting started with a Windows computer, I recommend changing default settings
such that:

1. Display the full path in the title bar

2. Show hidden files, folders, and drives

3. <Uncheck/Do not> Hide extension for known file types

```{r, eval = TRUE, echo = FALSE}
tweetrmd::include_tweet("https://twitter.com/PipingHotData/status/1450494168900509697")
```


## Administrator rights

Much of how you work in Windows depends on your level of rights. Fortunately,
I was granted administrator privileges on my work laptop, which
allows me to install software and save configuration files where I want to. 

If you do not have administrator privileges, knowing this can still help you
work with IT to complete your set upor find alternate viable locations.

# Homes 

I explored how R defines my home directories. On Mac OS, the "home" and the 
"R home" are the same thing, but on Windows OS they differ.

## R Home

```{r}
Sys.getenv("HOME")
```

`"C:/Users/pileggis/OneDrive - Memorial Sloan Kettering Cancer Center/Documents"`

```{r}
Sys.getenv("R_User")
```

`"C:/Users/pileggis/OneDrive - Memorial Sloan Kettering Cancer Center/Documents"`

```{r}
fs::path_home_r()
```

`C:/Users/pileggis/OneDrive - Memorial Sloan Kettering Cancer Center/Documents`

## Home


```{r}
fs::path_home()
```

`C:/Users/pileggis`


# Software

## R

From the `R.home()` help file: 

> The R home directory is the top-level directory of the R installation being run.


```{r}
R.home()
```

`"C:/PROGRA~1/R/R-41~1.2"`

> The R home directory is often referred to as R_HOME, and is the value of an environment variable of that name in an R session.

```{r}
Sys.getenv("R_HOME")
```

`"C:/PROGRA~1/R/R-41~1.2"`

## R packages

`.libPaths()` shows you were your R packages are being installed.

```{r}
.libPaths()
```

`"C:/Program Files/R/R-4.1.2/library"`


My R packages were initially being installed to the default location at `fs::path_home_r()`; I modified this location to my `C` drive. R for the Rest of Us has a nice video tutorial on [How to Set Your Default Package Install Location in R](https://rfortherestofus.com/2021/09/how-to-set-your-default-package-install-location-in-r/){target="_blank"} using the [`.Renviron`](#renviron) configuration file.

# Rtools 

Rtools is a collection of tools required to [build source packages](https://rstats.wtf/set-up-an-r-dev-environment.html#set-up-an-r-dev-environment){target="_blank"} on Windows. My installation is located at:

`"C:\rtools40"`

You can confirm if your installation worked properly if

```{r}
devtools::find_rtools()
```

returns `TRUE`. You can further confirm readiness with 

```{r}
devtools::has_devel()
```

which returns `Your system is ready to build packages!`


# Git

As recommended in [Happy Git with R](https://happygitwithr.com/){target="_blank"}, git is installed at

`C:\Program Files\Git`



# Configurations

## `.Renviron` {#renviron}

The `.Renviron` file contains environment variables, and is not R code. 

To edit this file, submit:

```{r}
usethis::edit_r_environ()
```

The user-level `.Renviron` file lives in the base of the user's home directory. For me, that means  

`C:\Users\pileggis\OneDrive - Memorial Sloan Kettering Cancer Center\Documents\.Renviron`


My file has has been modified to establish default library locations for 
R package installations.

`R_LIBS_USER = "R_LIBS_USER = "C:/Program Files/R/library/%v"`

As explained in What They Forgot To Teach You About R [Ch 8.4 How to transfer your library when updating R](https://rstats.wtf/maintaining-r.html#how-to-transfer-your-library-when-updating-r), the `%v` wildcard automatically adjusts the installation folder when you update to a new R version.

# .Rprofile

As stated in What They Forgot to Teach You about R [Ch 7.2 .Rprofile](https://rstats.wtf/r-startup.html#rprofile){target="_blank"}

> The `.Rprofile` file contains R code to be run when R starts up. It is run after the `.Renviron` file is sourced.

Again, you can edit this file with 

```{r}
usethis::edit_r_profile()
```
 
and mine lives at
 
`C:\Users\pileggis\OneDrive - Memorial Sloan Kettering Cancer Center\Documents\.Rprofile`.

My `.Rprofile` has been modified two ways:

1. Establish a default location for R projects created via `usethis::create_from_github()` or `usethis::use_course()`.

2. To enable create RStudio shortcuts with the [shrtcts](https://pkg.garrickadenbuie.com/shrtcts/index.html){target="_blank"} package.

```{r}
# ------------------------------------------------------------------------------
#  1/ Establish a default location for R projects created via 
# `usethis::create_from_github()` or `usethis::use_course()`
options(usethis.destdir = "C:/Users/pileggis/Documents/gh-personal")

# ------------------------------------------------------------------------------
# 2/ enable create RStudio shortcuts with the shrtcts package
if (interactive() && requireNamespace("shrtcts", quietly = TRUE)) {
  shrtcts::add_rstudio_shortcuts(set_keyboard_shortcuts = TRUE)
}
```



## .gitconfig 

You can quickly open your `.gitconfig` file for editing with 


```{r}
usethis::edit_git_config()
```

My `.gitconfig` file lives at:

`"C:\Users\pileggis\.gitconfig"`

and has been modified to allow me to switch between work and personal github
identities when working on R projects, which is described in more detail in 
[GitHub ssh and config with multiple accounts](https://www.gerkelab.com/blog/2021/04/multiple-github-accounts/){target="_blank"}
by Travis Gerke.

# Acknowledgements


```{r, echo = FALSE, eval = TRUE}
knitr::knit_exit()
```



From Omar Chua.
provisioning is different on Flex laptops vs Domain accounts
Flex laptops are Azure AD based
So it looks like Admin Rights are enable or disable using a cloud group for the azure devices (flex laptops)
you will not see indication from your actual account
as the provisioning is done through the flex device

