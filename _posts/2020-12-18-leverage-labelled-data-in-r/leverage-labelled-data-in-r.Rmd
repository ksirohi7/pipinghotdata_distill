---
title: "Leveraging labelled data in R"
description: |
  When you want to work with SAS and SPSS data sets in R
base_url: https://www.pipinghotdata.com/
twitter:
  site: "@PipingHotData"
  creator: "@PipingHotData"
date: 12-18-2020
author:
  - name: Shannon Pileggi
output:
  distill::distill_article:
    toc: true
    toc_depth: 3
    self_contained: false
draft: true
creative_commons: CC BY
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# TL; DR

metadata in the form of variable labels and value labels is awesome!  it wasn't entirely native to R, but with haven/labelled/sjlabelled packages you can leverage it effectively, with some challenges of course. this post is for you if have a .sav or .sas file with labels that you want to import into R. 

# YRBSS labelled data

Labelled data traditionally, though not exclusively, arises in survey data. Both SAS and SPSS have an established infrastructures for labelled data. The Youth Risk Behavior Surveillance System (YRBSS) is a publicly available data set from the CDC that "monitors health-related behaviors that contribute to the leading causes of death and disability among youth and adults."  I downloaded the 2017 national data from [here](https://www.cdc.gov/healthyyouth/data/yrbs/data.htm) on Aug 9, 2020 (`sadc_2017_national.dat`). I then used the SPSS syntax (same link) to convert the `.dat` file to an SPSS labelled data file (`sadc_2017_national.spss`). 

# Packages 

```{r}
library(tidyverse)
library(here)
library(haven)
library(labelled)
```

# Importing labelled data

```{r}
# import data ----
dat_raw <- haven::read_spss(here::here( "_posts", "2020-12-18-leverage-labelled-data-in-r", "data", "sadc_2017_national.sav"))
```




# Defining labelled data


```{r}
dat_raw %>% 
  dplyr::select(q12) %>% 
  str(.)
```

# Tools for labelled data

```{r}
dictionary <- dat_raw %>% labelled::look_for(details = TRUE)
```

